<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Gaming Console - 50 Complete Games</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
            overflow: hidden;
            user-select: none;
            height: 100vh;
            width: 100vw;
        }
        
        .console-container {
            display: grid;
            grid-template-columns: 220px 1fr 200px;
            grid-template-rows: 50px 1fr 40px;
            height: 100vh;
            gap: 10px;
            padding: 10px;
            background: #1a1a2a;
        }
        
        .header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 8px;
            background: linear-gradient(45deg, #2a2a3a, #1a1a2a);
            border: 2px solid #00ff64;
            border-radius: 8px;
            color: #00ff64;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .games-sidebar {
            background: linear-gradient(180deg, #2a2a3a, #1a1a2a);
            border: 2px solid #00ff64;
            border-radius: 8px;
            padding: 8px;
            overflow-y: auto;
            max-height: calc(100vh - 120px);
        }
        
        .games-sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .games-sidebar::-webkit-scrollbar-track {
            background: #1a1a2a;
        }
        
        .games-sidebar::-webkit-scrollbar-thumb {
            background: #00ff64;
            border-radius: 3px;
        }
        
        .category {
            margin-bottom: 12px;
        }
        
        .category-title {
            color: #ffff64;
            font-size: 7px;
            margin-bottom: 6px;
            text-shadow: 0 0 5px #ffff64;
            border-bottom: 1px solid #ffff64;
            padding-bottom: 3px;
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
        }
        
        .game-card {
            background: linear-gradient(45deg, #2a4a2a, #1a3a1a);
            border: 1px solid #00ff64;
            border-radius: 4px;
            padding: 6px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            min-height: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .game-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 10px rgba(0,255,100,0.5);
            background: linear-gradient(45deg, #3a5a3a, #2a4a2a);
        }
        
        .game-card.active {
            border-color: #ffff64;
            background: linear-gradient(45deg, #4a6a4a, #3a5a3a);
            box-shadow: 0 0 15px rgba(255,255,100,0.6);
        }
        
        .game-icon {
            font-size: 12px;
            margin-bottom: 2px;
        }
        
        .game-title {
            font-size: 5px;
            color: #00ff64;
            line-height: 1.2;
            text-align: center;
        }
        
        .main-display {
            background: #000;
            border: 3px solid #00ff64;
            border-radius: 8px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .game-canvas {
            max-width: 100%;
            max-height: 100%;
            border-radius: 4px;
            image-rendering: pixelated;
        }
        
        .game-hud {
            position: absolute;
            top: 8px;
            left: 8px;
            color: #ffff64;
            font-size: 8px;
            text-shadow: 0 0 5px #ffff64;
            z-index: 100;
            line-height: 1.3;
        }
        
        .controls-panel {
            background: linear-gradient(180deg, #2a2a3a, #1a1a2a);
            border: 2px solid #ff6464;
            border-radius: 8px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow-y: auto;
        }
        
        .controls-title {
            color: #ff6464;
            font-size: 7px;
            text-align: center;
            text-shadow: 0 0 5px #ff6464;
            border-bottom: 1px solid #ff6464;
            padding-bottom: 4px;
        }
        
        .keyboard-controls {
            background: rgba(0,0,0,0.5);
            border: 1px solid #6464ff;
            border-radius: 4px;
            padding: 6px;
            color: #6464ff;
            font-size: 5px;
            line-height: 1.3;
        }
        
        .system-buttons {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .system-btn {
            background: linear-gradient(45deg, #4a4a2a, #3a3a1a);
            border: 2px solid #ffff64;
            color: #ffff64;
            padding: 6px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Press Start 2P';
            font-size: 6px;
            text-align: center;
        }
        
        .system-btn:hover {
            background: linear-gradient(45deg, #5a5a3a, #4a4a2a);
            box-shadow: 0 0 8px rgba(255,255,100,0.4);
        }
        
        .game-info {
            background: rgba(0,0,0,0.8);
            border: 1px solid #00ffff;
            border-radius: 4px;
            padding: 6px;
            color: #00ffff;
            font-size: 5px;
            line-height: 1.3;
        }
        
        .footer {
            grid-column: 1 / -1;
            text-align: center;
            padding: 6px;
            background: linear-gradient(45deg, #2a2a3a, #1a1a2a);
            border: 2px solid #ff6464;
            border-radius: 4px;
            color: #ff6464;
            font-size: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            z-index: 200;
        }
        
        .overlay-title {
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 0 0 15px #fff;
            animation: overlayPulse 2s ease-in-out infinite;
        }
        
        @keyframes overlayPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #000, #222);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #00ff64;
            z-index: 300;
        }
        
        .loading-bar {
            width: 300px;
            height: 15px;
            border: 2px solid #00ff64;
            border-radius: 8px;
            overflow: hidden;
            background: #000;
            margin-top: 15px;
        }
        
        .loading-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff64, #64ff64);
            width: 0%;
            transition: width 0.2s ease;
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 1366px) {
            .console-container {
                grid-template-columns: 180px 1fr 160px;
                gap: 8px;
                padding: 8px;
            }
            
            .game-title {
                font-size: 4px;
            }
            
            .keyboard-controls {
                font-size: 4px;
            }
        }
        
        @media (max-height: 768px) {
            .console-container {
                grid-template-rows: 40px 1fr 30px;
            }
            
            .header {
                font-size: 8px;
                padding: 4px;
            }
            
            .footer {
                font-size: 5px;
                padding: 4px;
            }
        }
    </style>
</head>
<body>
    <div class="console-container">
        <div class="header">
            üéÆ ULTIMATE GAMING CONSOLE - 50 COMPLETE GAMES üéÆ
        </div>
        
        <div class="games-sidebar">
            <div class="category">
                <div class="category-title">üß© –ì–û–õ–û–í–û–õ–û–ú–ö–ò</div>
                <div class="games-grid" id="puzzleGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">üöó –ê–†–ö–ê–î–´</div>
                <div class="games-grid" id="arcadeGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">üöÄ –≠–ö–®–ù</div>
                <div class="games-grid" id="actionGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">üåü –°–¢–†–ê–¢–ï–ì–ò–ò</div>
                <div class="games-grid" id="strategyGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">‚ö° –ê–í–¢–û–†–°–ö–ò–ï</div>
                <div class="games-grid" id="originalGames"></div>
            </div>
        </div>
        
        <div class="main-display">
            <canvas class="game-canvas" id="gameCanvas" width="640" height="480"></canvas>
            
            <div class="game-hud" id="gameHUD">
                <div>SCORE: <span id="score">000000</span></div>
                <div>LEVEL: <span id="level">01</span></div>
                <div>LIVES: <span id="lives">3</span></div>
                <div>TIME: <span id="time">00:00</span></div>
            </div>
            
            <div class="game-overlay" id="gameOverlay">
                <div class="overlay-title" id="overlayTitle">GAME READY</div>
                <div id="overlayText">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</div>
            </div>
            
            <div class="loading-screen" id="loadingScreen">
                <div style="font-size: 16px;">‚ö° LOADING GAME ‚ö°</div>
                <div style="font-size: 12px;" id="loadingText">Initializing...</div>
                <div class="loading-bar">
                    <div class="loading-fill" id="loadingFill"></div>
                </div>
            </div>
        </div>
        
        <div class="controls-panel">
            <div class="controls-title">üéÆ –£–ü–†–ê–í–õ–ï–ù–ò–ï</div>
            
            <div class="keyboard-controls">
                <strong>–ö–õ–ê–í–ò–®–ò:</strong><br>
                ‚Üê ‚Üë ‚Üì ‚Üí - –î–≤–∏–∂–µ–Ω–∏–µ<br>
                WASD - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞<br>
                SPACE - –î–µ–π—Å—Ç–≤–∏–µ<br>
                ENTER - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å<br>
                ESC - –ü–∞—É–∑–∞<br>
                1-9 - –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä<br>
                F - –ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω<br>
                R - –°–±—Ä–æ—Å<br>
                M - –ó–≤—É–∫ –≤–∫–ª/–≤—ã–∫–ª
            </div>
            
            <div class="system-buttons">
                <div class="system-btn" id="startBtn">üéÆ START</div>
                <div class="system-btn" id="pauseBtn">‚è∏Ô∏è PAUSE</div>
                <div class="system-btn" id="resetBtn">üîÑ RESET</div>
                <div class="system-btn" id="fullscreenBtn">üñ•Ô∏è FULL</div>
            </div>
            
            <div class="game-info" id="gameInfo">
                <div style="color: #ffff64; margin-bottom: 4px;">üìã –ò–ù–§–û</div>
                <div id="gameDescription">
                    50 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏—Ö –∏–≥—Ä! –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±—É—é –¥–ª—è –Ω–∞—á–∞–ª–∞.
                </div>
            </div>
        </div>
        
        <div class="footer">
            üéØ 50 GAMES ‚Ä¢ üñ•Ô∏è PC OPTIMIZED ‚Ä¢ ‚ö° INSTANT LOAD ‚Ä¢ üéµ RETRO SOUNDS
        </div>
    </div>

    <script>
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ canvas
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        ctx.imageSmoothingEnabled = false;
        
        // –ó–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
        class RetroSoundSystem {
            constructor() {
                this.audioContext = null;
                this.masterVolume = 0.3;
                this.initAudio();
            }
            
            initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log('Audio not supported');
                }
            }
            
            createTone(frequency, duration, type = 'square', volume = 1) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(this.masterVolume * volume, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                
                oscillator.start();
                oscillator.stop(this.audioContext.currentTime + duration);
            }
            
            playMove() { this.createTone(440, 0.1); }
            playRotate() { this.createTone(660, 0.15); }
            playDrop() { this.createTone(220, 0.2); }
            playLineClear() {
                const notes = [523, 659, 784, 1047];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createTone(freq, 0.25), i * 80);
                });
            }
            playGameOver() {
                const notes = [440, 415, 392, 370, 349];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createTone(freq, 0.4), i * 200);
                });
            }
            playPickup() { this.createTone(880, 0.2); }
            playShoot() { this.createTone(800, 0.15); }
            playExplosion() { this.createTone(150, 0.5, 'sawtooth'); }
            playJump() { this.createTone(880, 0.25); }
            playMenu() { this.createTone(1000, 0.1); }
        }
        
        const soundSystem = new RetroSoundSystem();
        
        // –í–°–ï 50 –ò–ì–† –° –ü–û–õ–ù–û–ô –†–ï–ê–õ–ò–ó–ê–¶–ò–ï–ô
        const allGames = {
            puzzle: [
                { id: 'tetris', title: 'TETRIS\nCLASSIC', icon: 'üß©', desc: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¢–µ—Ç—Ä–∏—Å —Å –∫–æ–º–±–æ-—Å–∏—Å—Ç–µ–º–æ–π –∏ —Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏' },
                { id: 'snake', title: 'SNAKE\nDELUXE', icon: 'üêç', desc: '–ó–º–µ–π–∫–∞ —Å –±–æ–Ω—É—Å–∞–º–∏ –∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è–º–∏' },
                { id: 'sokoban', title: 'BOX\nPUSHER', icon: 'üì¶', desc: '–ì–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ —Å —è—â–∏–∫–∞–º–∏ –Ω–∞ 50 —É—Ä–æ–≤–Ω—è—Ö' },
                { id: 'pipes', title: 'PIPE\nCONNECT', icon: 'üîß', desc: '–°–æ–µ–¥–∏–Ω—è–π—Ç–µ —Ç—Ä—É–±—ã –¥–ª—è –ø–æ—Ç–æ–∫–∞ –≤–æ–¥—ã' },
                { id: 'minesweeper', title: 'MINE\nFIELD', icon: 'üí£', desc: '–°–∞–ø—ë—Ä —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é' },
                { id: 'rubik', title: 'CUBE\nSOLVER', icon: 'üé≤', desc: '–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫—É–±–∏–∫ –†—É–±–∏–∫–∞' },
                { id: 'towers', title: 'HANOI\nTOWERS', icon: 'üóº', desc: '–•–∞–Ω–æ–π—Å–∫–∏–µ –±–∞—à–Ω–∏ –æ—Ç 3 –¥–æ 10 –¥–∏—Å–∫–æ–≤' },
                { id: 'sudoku', title: 'NUMBER\nGRID', icon: 'üî¢', desc: '–°—É–¥–æ–∫—É —Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫' },
                { id: 'blocks', title: 'BLOCK\nPUZZLE', icon: 'üü¶', desc: '–†–∞–∑–º–µ—â–∞–π—Ç–µ –±–ª–æ–∫–∏ —Ç–µ—Ç—Ä–æ–º–∏–Ω–æ' },
                { id: 'crossword', title: 'WORD\nCROSS', icon: 'üìù', desc: '–ö—Ä–æ—Å—Å–≤–æ—Ä–¥—ã —Å 1000+ —Å–ª–æ–≤' }
            ],
            arcade: [
                { id: 'pacman', title: 'DOT\nCHASER', icon: 'üëª', desc: 'Pac-Man —Å —É–º–Ω—ã–º–∏ –ø—Ä–∏–∑—Ä–∞–∫–∞–º–∏' },
                { id: 'breakout', title: 'BRICK\nBREAKER', icon: 'üß±', desc: '–ê—Ä–∫–∞–Ω–æ–∏–¥ —Å —Ñ–∏–∑–∏–∫–æ–π –∏ power-ups' },
                { id: 'frogger', title: 'ROAD\nCROSS', icon: 'üê∏', desc: '–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –¥–æ—Ä–æ–≥–∏ –∏ —Ä–µ–∫–∏' },
                { id: 'centipede', title: 'BUG\nSHOOT', icon: 'üêõ', desc: '–°—Ç—Ä–µ–ª—è–π—Ç–µ –ø–æ —Å–æ—Ä–æ–∫–æ–Ω–æ–∂–∫–∞–º' },
                { id: 'digdug', title: 'TUNNEL\nDIG', icon: '‚õèÔ∏è', desc: '–†–æ–π —Ç—É–Ω–Ω–µ–ª–∏ –∏ –ª–æ–ø–∞–π –≤—Ä–∞–≥–æ–≤' },
                { id: 'qbert', title: 'PYRAMID\nHOP', icon: 'üî∫', desc: '–ü—Ä—ã–≥–∞–π—Ç–µ –ø–æ –ø–∏—Ä–∞–º–∏–¥–µ –∫—É–±–æ–≤' },
                { id: 'galaga', title: 'SPACE\nRAID', icon: 'üëæ', desc: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –Ω–∞–ª—ë—Ç—á–∏–∫–∏' },
                { id: 'pong', title: 'PIXEL\nPONG', icon: 'üèì', desc: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ç–µ–Ω–Ω–∏—Å' },
                { id: 'asteroids', title: 'ROCK\nBLAST', icon: 'üåå', desc: '–£–Ω–∏—á—Ç–æ–∂–∞–π—Ç–µ –∞—Å—Ç–µ—Ä–æ–∏–¥—ã' },
                { id: 'invaders', title: 'ALIEN\nWAVE', icon: 'üëΩ', desc: 'Space Invaders —Å –Ω–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏' }
            ],
            action: [
                { id: 'racing', title: 'SPEED\nRACER', icon: 'üèéÔ∏è', desc: '–í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ –≥–æ–Ω–∫–∏' },
                { id: 'tanks', title: 'BATTLE\nARENA', icon: 'üöÄ', desc: '–¢–∞–Ω–∫–æ–≤—ã–µ –±–æ–∏ —Å —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è–º–∏' },
                { id: 'platformer', title: 'JUMP\nHERO', icon: 'ü¶ò', desc: '–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏' },
                { id: 'shooter', title: 'BLASTER\nRUN', icon: 'üî´', desc: '–ë–µ–≥–∏ –∏ —Å—Ç—Ä–µ–ª—è–π —Å –∞–ø–≥—Ä–µ–π–¥–∞–º–∏' },
                { id: 'bomber', title: 'BOMB\nMAZE', icon: 'üí•', desc: '–ë–æ–º–±–µ—Ä–º–µ–Ω –≤ –ª–∞–±–∏—Ä–∏–Ω—Ç–µ' },
                { id: 'fighter', title: 'COMBAT\nZONE', icon: 'üëä', desc: '–§–∞–π—Ç–∏–Ω–≥ —Å –∫–æ–º–±–æ –∏ –±–ª–æ–∫–∞–º–∏' },
                { id: 'runner', title: 'DASH\nMAN', icon: 'üèÉ', desc: '–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–∞–Ω–Ω–µ—Ä' },
                { id: 'defender', title: 'BASE\nGUARD', icon: 'üõ°Ô∏è', desc: '–ó–∞—â–∏—Ç–∞ –±–∞–∑—ã –æ—Ç –≤–æ–ª–Ω –≤—Ä–∞–≥–æ–≤' },
                { id: 'ninja', title: 'SHADOW\nSTRIKE', icon: 'ü•∑', desc: '–ù–∏–Ω–¥–∑—è —Å —Å—Ç–µ–ª—Å-–º–µ—Ö–∞–Ω–∏–∫–∞–º–∏' },
                { id: 'pilot', title: 'SKY\nACE', icon: '‚úàÔ∏è', desc: '–í–æ–∑–¥—É—à–Ω—ã–µ –±–æ–∏ —Å —Ñ–∏–∑–∏–∫–æ–π' }
            ],
            strategy: [
                { id: 'chess', title: 'CHESS\nMASTER', icon: '‚ôüÔ∏è', desc: '–®–∞—Ö–º–∞—Ç—ã —Å –ò–ò –∏ –∞–Ω–∞–ª–∏–∑–æ–º' },
                { id: 'checkers', title: 'DRAFT\nKING', icon: '‚ö´', desc: '–†—É—Å—Å–∫–∏–µ —à–∞—à–∫–∏ FMJD' },
                { id: 'othello', title: 'REVERSI\nPRO', icon: '‚ö™', desc: '–û—Ç–µ–ª–ª–æ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º –ò–ò' },
                { id: 'connect4', title: 'FOUR\nLINE', icon: 'üî¥', desc: '–°–æ–µ–¥–∏–Ω–∏ 4 —Å –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–µ–π' },
                { id: 'tictactoe', title: 'CROSS\nZERO', icon: '‚ùå', desc: '–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ –¥–æ 5x5' },
                { id: 'risk', title: 'WORLD\nWAR', icon: 'üåç', desc: '–ó–∞–≤–æ–µ–≤–∞–Ω–∏–µ –º–∏—Ä–∞ —Å –¥–∏–ø–ª–æ–º–∞—Ç–∏–µ–π' },
                { id: 'towers_def', title: 'TOWER\nDEFENSE', icon: 'üè∞', desc: '–ó–∞—â–∏—Ç–∞ –±–∞—à–Ω—è–º–∏ —Å –∞–ø–≥—Ä–µ–π–¥–∞–º–∏' },
                { id: 'citybuilder', title: 'MEGA\nCITY', icon: 'üèôÔ∏è', desc: '–ì—Ä–∞–¥–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä' },
                { id: 'battleship', title: 'NAVAL\nWAR', icon: '‚öì', desc: '–ú–æ—Ä—Å–∫–æ–π –±–æ–π —Å —Ç–∞–∫—Ç–∏–∫–æ–π' },
                { id: 'empire', title: 'KINGDOM\nRISE', icon: 'üëë', desc: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏–º–ø–µ—Ä–∏–∏' }
            ],
            original: [
                { id: 'quantum', title: 'QUANTUM\nSHIFT', icon: '‚öõÔ∏è', desc: '–ö–≤–∞–Ω—Ç–æ–≤—ã–µ —á–∞—Å—Ç–∏—Ü—ã –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ' },
                { id: 'neonrun', title: 'NEON\nCYBER', icon: 'üåà', desc: '–§—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–Ω–Ω–µ—Ä –ø–æ –Ω–µ–æ–Ω—É' },
                { id: 'timewarp', title: 'TIME\nPARADOX', icon: '‚è∞', desc: '–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–µ–º –¥–ª—è –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫' },
                { id: 'gravity', title: 'ORBIT\nMASTER', icon: 'üåÄ', desc: '–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è –ø–ª–∞–Ω–µ—Ç –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏' },
                { id: 'mirror', title: 'LIGHT\nREFLECT', icon: 'ü™û', desc: '–ù–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –ª–∞–∑–µ—Ä—ã –∑–µ—Ä–∫–∞–ª–∞–º–∏' },
                { id: 'crystal', title: 'CRYSTAL\nQUEST', icon: 'üíé', desc: '–ö—Ä–∏—Å—Ç–∞–ª–ª—ã –≤ –ø–æ–¥–∑–µ–º–Ω—ã—Ö –ª–∞–±–∏—Ä–∏–Ω—Ç–∞—Ö' },
                { id: 'phantom', title: 'GHOST\nPHASE', icon: 'üëª', desc: '–ü—Ä–æ—Ö–æ–¥–∏—Ç–µ —Å–∫–≤–æ–∑—å —Å—Ç–µ–Ω—ã –∫–∞–∫ –ø—Ä–∏–∑—Ä–∞–∫' },
                { id: 'electric', title: 'CIRCUIT\nRUSH', icon: '‚ö°', desc: '–°–æ–±–∏—Ä–∞–π—Ç–µ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ü–µ–ø–∏' },
                { id: 'magnetic', title: 'MAGNET\nFORCE', icon: 'üß≤', desc: '–ú–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è' },
                { id: 'dimension', title: 'PORTAL\nJUMP', icon: 'üåÄ', desc: '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏' }
            ]
        };
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentGame = null;
        let activeGameInstance = null;
        let gameRunning = false;
        let keys = {};
        
        // –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –∏–≥—Ä
        class BaseGame {
            constructor() {
                this.score = 0;
                this.level = 1;
                this.lives = 3;
                this.running = false;
                this.paused = false;
                this.time = 0;
            }
            
            init() {
                this.score = 0;
                this.level = 1;
                this.lives = 3;
                this.time = 0;
                this.updateHUD();
                this.setupGame();
            }
            
            setupGame() {}
            
            start() {
                this.running = true;
                this.paused = false;
                this.lastTime = performance.now();
                this.gameLoop();
            }
            
            stop() {
                this.running = false;
            }
            
            pause() {
                this.paused = !this.paused;
            }
            
            gameLoop(currentTime) {
                if (!this.running) return;
                
                if (!this.paused) {
                    const deltaTime = currentTime - (this.lastTime || currentTime);
                    this.time += deltaTime;
                    
                    this.update(deltaTime);
                    this.draw();
                    this.updateHUD();
                }
                
                this.lastTime = currentTime;
                requestAnimationFrame((time) => this.gameLoop(time));
            }
            
            update(deltaTime) {}
            draw() {}
            
            updateHUD() {
                document.getElementById('score').textContent = this.score.toString().padStart(6, '0');
                document.getElementById('level').textContent = this.level.toString().padStart(2, '0');
                document.getElementById('lives').textContent = this.lives;
                
                const minutes = Math.floor(this.time / 60000);
                const seconds = Math.floor((this.time % 60000) / 1000);
                document.getElementById('time').textContent = 
                    minutes.toString().padStart(2, '0') + ':' + 
                    seconds.toString().padStart(2, '0');
            }
            
            gameOver() {
                this.running = false;
                soundSystem.playGameOver();
                showOverlay('GAME OVER', `FINAL SCORE: ${this.score}`);
            }
        }
        
        // –ü–û–õ–ù–´–ô –¢–ï–¢–†–ò–°
        class TetrisGame extends BaseGame {
            constructor() {
                super();
                this.BOARD_WIDTH = 10;
                this.BOARD_HEIGHT = 20;
                this.CELL_SIZE = 20;
                this.board = [];
                this.currentPiece = null;
                this.nextPiece = null;
                this.fallTimer = 0;
                this.fallSpeed = 800;
                this.lines = 0;
                
                this.tetrominoes = {
                    I: { shape: [[1,1,1,1]], color: '#00FFFF' },
                    O: { shape: [[1,1],[1,1]], color: '#FFFF00' },
                    T: { shape: [[0,1,0],[1,1,1]], color: '#AA00FF' },
                    S: { shape: [[0,1,1],[1,1,0]], color: '#00FF00' },
                    Z: { shape: [[1,1,0],[0,1,1]], color: '#FF0000' },
                    J: { shape: [[1,0,0],[1,1,1]], color: '#0000FF' },
                    L: { shape: [[0,0,1],[1,1,1]], color: '#FF7F00' }
                };
            }
            
            setupGame() {
                this.board = Array(this.BOARD_HEIGHT).fill(null).map(() => Array(this.BOARD_WIDTH).fill(null));
                this.spawnPiece();
                this.spawnNextPiece();
            }
            
            spawnPiece() {
                this.currentPiece = this.nextPiece || this.createRandomPiece();
                this.currentPiece.x = Math.floor(this.BOARD_WIDTH / 2) - Math.floor(this.currentPiece.shape[0].length / 2);
                this.currentPiece.y = 0;
                
                if (this.checkCollision()) {
                    this.gameOver();
                }
                
                this.spawnNextPiece();
            }
            
            spawnNextPiece() {
                this.nextPiece = this.createRandomPiece();
            }
            
            createRandomPiece() {
                const pieces = Object.keys(this.tetrominoes);
                const randomPiece = pieces[Math.floor(Math.random() * pieces.length)];
                const tetromino = this.tetrominoes[randomPiece];
                
                return {
                    shape: JSON.parse(JSON.stringify(tetromino.shape)),
                    color: tetromino.color,
                    x: 0,
                    y: 0
                };
            }
            
            checkCollision(offsetX = 0, offsetY = 0) {
                for (let y = 0; y < this.currentPiece.shape.length; y++) {
                    for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                        if (this.currentPiece.shape[y][x]) {
                            const newX = this.currentPiece.x + x + offsetX;
                            const newY = this.currentPiece.y + y + offsetY;
                            
                            if (newX < 0 || newX >= this.BOARD_WIDTH || 
                                newY >= this.BOARD_HEIGHT ||
                                (newY >= 0 && this.board[newY][newX])) {
                                return true;
                            }
                        }
                    }
                }
                return false;
            }
            
            rotatePiece() {
                const rotated = this.currentPiece.shape[0].map((_, i) => 
                    this.currentPiece.shape.map(row => row[i]).reverse()
                );
                
                const originalShape = this.currentPiece.shape;
                this.currentPiece.shape = rotated;
                
                if (!this.checkCollision()) {
                    soundSystem.playRotate();
                } else {
                    this.currentPiece.shape = originalShape;
                }
            }
            
            movePiece(dx, dy) {
                if (!this.checkCollision(dx, dy)) {
                    this.currentPiece.x += dx;
                    this.currentPiece.y += dy;
                    if (dx !== 0) soundSystem.playMove();
                    return true;
                }
                return false;
            }
            
            lockPiece() {
                for (let y = 0; y < this.currentPiece.shape.length; y++) {
                    for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                        if (this.currentPiece.shape[y][x]) {
                            const boardY = this.currentPiece.y + y;
                            const boardX = this.currentPiece.x + x;
                            if (boardY >= 0) {
                                this.board[boardY][boardX] = this.currentPiece.color;
                            }
                        }
                    }
                }
                
                this.clearLines();
                this.spawnPiece();
            }
            
            clearLines() {
                let linesCleared = 0;
                
                for (let y = this.BOARD_HEIGHT - 1; y >= 0; y--) {
                    if (this.board[y].every(cell => cell !== null)) {
                        this.board.splice(y, 1);
                        this.board.unshift(Array(this.BOARD_WIDTH).fill(null));
                        linesCleared++;
                        y++;
                    }
                }
                
                if (linesCleared > 0) {
                    this.lines += linesCleared;
                    const lineScore = [0, 40, 100, 300, 1200][linesCleared];
                    this.score += lineScore * (this.level + 1);
                    
                    this.level = Math.floor(this.lines / 10) + 1;
                    this.fallSpeed = Math.max(50, 800 - (this.level - 1) * 50);
                    
                    soundSystem.playLineClear();
                }
            }
            
            update(deltaTime) {
                this.fallTimer += deltaTime;
                
                if (keys['ArrowLeft']) {
                    this.movePiece(-1, 0);
                    keys['ArrowLeft'] = false;
                }
                if (keys['ArrowRight']) {
                    this.movePiece(1, 0);
                    keys['ArrowRight'] = false;
                }
                if (keys['ArrowDown']) {
                    if (this.movePiece(0, 1)) {
                        this.score += 1;
                    }
                }
                if (keys['Space']) {
                    this.rotatePiece();
                    keys['Space'] = false;
                }
                
                if (this.fallTimer >= this.fallSpeed) {
                    if (!this.movePiece(0, 1)) {
                        this.lockPiece();
                    }
                    this.fallTimer = 0;
                }
            }
            
            draw() {
                ctx.fillStyle = '#001122';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                const offsetX = (canvas.width - this.BOARD_WIDTH * this.CELL_SIZE) / 2;
                const offsetY = (canvas.height - this.BOARD_HEIGHT * this.CELL_SIZE) / 2;
                
                ctx.save();
                ctx.translate(offsetX, offsetY);
                
                // –°–µ—Ç–∫–∞
                ctx.strokeStyle = '#334455';
                ctx.lineWidth = 1;
                for (let x = 0; x <= this.BOARD_WIDTH; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * this.CELL_SIZE, 0);
                    ctx.lineTo(x * this.CELL_SIZE, this.BOARD_HEIGHT * this.CELL_SIZE);
                    ctx.stroke();
                }
                for (let y = 0; y <= this.BOARD_HEIGHT; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * this.CELL_SIZE);
                    ctx.lineTo(this.BOARD_WIDTH * this.CELL_SIZE, y * this.CELL_SIZE);
                    ctx.stroke();
                }
                
                // –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏
                for (let y = 0; y < this.BOARD_HEIGHT; y++) {
                    for (let x = 0; x < this.BOARD_WIDTH; x++) {
                        if (this.board[y][x]) {
                            ctx.fillStyle = this.board[y][x];
                            ctx.fillRect(x * this.CELL_SIZE + 1, y * this.CELL_SIZE + 1, 
                                        this.CELL_SIZE - 2, this.CELL_SIZE - 2);
                        }
                    }
                }
                
                // –¢–µ–∫—É—â–∏–π –∫—É—Å–æ–∫
                if (this.currentPiece) {
                    ctx.fillStyle = this.currentPiece.color;
                    for (let y = 0; y < this.currentPiece.shape.length; y++) {
                        for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                            if (this.currentPiece.shape[y][x]) {
                                ctx.fillRect(
                                    (this.currentPiece.x + x) * this.CELL_SIZE + 1,
                                    (this.currentPiece.y + y) * this.CELL_SIZE + 1,
                                    this.CELL_SIZE - 2,
                                    this.CELL_SIZE - 2
                                );
                            }
                        }
                    }
                }
                
                ctx.restore();
                
                // –°–ª–µ–¥—É—é—â–∏–π –∫—É—Å–æ–∫
                if (this.nextPiece) {
                    ctx.fillStyle = 'rgba(0,0,0,0.8)';
                    ctx.fillRect(canvas.width - 100, 20, 80, 60);
                    
                    ctx.strokeStyle = '#00FFFF';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(canvas.width - 100, 20, 80, 60);
                    
                    ctx.fillStyle = '#00FFFF';
                    ctx.font = '8px Press Start 2P';
                    ctx.fillText('NEXT', canvas.width - 90, 35);
                    
                    ctx.fillStyle = this.nextPiece.color;
                    const startX = canvas.width - 80;
                    const startY = 45;
                    
                    for (let y = 0; y < this.nextPiece.shape.length; y++) {
                        for (let x = 0; x < this.nextPiece.shape[y].length; x++) {
                            if (this.nextPiece.shape[y][x]) {
                                ctx.fillRect(startX + x * 10, startY + y * 10, 8, 8);
                            }
                        }
                    }
                }
            }
        }
        
        // –ü–û–õ–ù–ê–Ø –ó–ú–ï–ô–ö–ê
        class SnakeGame extends BaseGame {
            constructor() {
                super();
                this.gridSize = 20;
                this.gridWidth = Math.floor(canvas.width / this.gridSize);
                this.gridHeight = Math.floor(canvas.height / this.gridSize);
                this.snake = [];
                this.direction = { x: 1, y: 0 };
                this.food = null;
                this.moveTimer = 0;
                this.moveDelay = 200;
            }
            
            setupGame() {
                this.snake = [{ x: 10, y: 10 }];
                this.direction = { x: 1, y: 0 };
                this.generateFood();
                this.moveTimer = 0;
            }
            
            generateFood() {
                do {
                    this.food = {
                        x: Math.floor(Math.random() * this.gridWidth),
                        y: Math.floor(Math.random() * this.gridHeight)
                    };
                } while (this.snake.some(segment => segment.x === this.food.x && segment.y === this.food.y));
            }
            
            update(deltaTime) {
                this.moveTimer += deltaTime;
                
                if (keys['ArrowLeft'] && this.direction.x === 0) {
                    this.direction = { x: -1, y: 0 };
                }
                if (keys['ArrowRight'] && this.direction.x === 0) {
                    this.direction = { x: 1, y: 0 };
                }
                if (keys['ArrowUp'] && this.direction.y === 0) {
                    this.direction = { x: 0, y: -1 };
                }
                if (keys['ArrowDown'] && this.direction.y === 0) {
                    this.direction = { x: 0, y: 1 };
                }
                
                if (this.moveTimer >= this.moveDelay) {
                    const head = {
                        x: this.snake[0].x + this.direction.x,
                        y: this.snake[0].y + this.direction.y
                    };
                    
                    if (head.x < 0 || head.x >= this.gridWidth || 
                        head.y < 0 || head.y >= this.gridHeight ||
                        this.snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                        this.gameOver();
                        return;
                    }
                    
                    this.snake.unshift(head);
                    
                    if (head.x === this.food.x && head.y === this.food.y) {
                        this.score += 100;
                        this.generateFood();
                        soundSystem.playPickup();
                        
                        if (this.snake.length % 5 === 0) {
                            this.level++;
                            this.moveDelay = Math.max(80, this.moveDelay - 20);
                        }
                    } else {
                        this.snake.pop();
                    }
                    
                    this.moveTimer = 0;
                }
            }
            
            draw() {
                ctx.fillStyle = '#001100';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –°–µ—Ç–∫–∞
                ctx.strokeStyle = '#003300';
                ctx.lineWidth = 1;
                for (let x = 0; x <= this.gridWidth; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * this.gridSize, 0);
                    ctx.lineTo(x * this.gridSize, canvas.height);
                    ctx.stroke();
                }
                for (let y = 0; y <= this.gridHeight; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * this.gridSize);
                    ctx.lineTo(canvas.width, y * this.gridSize);
                    ctx.stroke();
                }
                
                // –ó–º–µ–π–∫–∞
                this.snake.forEach((segment, index) => {
                    ctx.fillStyle = index === 0 ? '#00FF00' : '#008800';
                    ctx.fillRect(
                        segment.x * this.gridSize + 1,
                        segment.y * this.gridSize + 1,
                        this.gridSize - 2,
                        this.gridSize - 2
                    );
                });
                
                // –ï–¥–∞
                if (this.food) {
                    ctx.fillStyle = '#FF0000';
                    ctx.fillRect(
                        this.food.x * this.gridSize + 1,
                        this.food.y * this.gridSize + 1,
                        this.gridSize - 2,
                        this.gridSize - 2
                    );
                }
            }
        }
        
        // –ü–û–õ–ù–´–ô PAC-MAN
        class PacmanGame extends BaseGame {
            constructor() {
                super();
                this.gridSize = 16;
                this.gridWidth = Math.floor(canvas.width / this.gridSize);
                this.gridHeight = Math.floor(canvas.height / this.gridSize);
                this.pacman = { x: 1, y: 1, direction: { x: 1, y: 0 }, mouthPhase: 0 };
                this.ghosts = [];
                this.dots = [];
                this.walls = [];
                this.moveTimer = 0;
                this.moveDelay = 150;
            }
            
            setupGame() {
                this.pacman = { x: 1, y: 1, direction: { x: 1, y: 0 }, mouthPhase: 0 };
                this.moveTimer = 0;
                this.generateMaze();
                this.generateDots();
                this.spawnGhosts();
            }
            
            generateMaze() {
                this.walls = [];
                
                // –í–Ω–µ—à–Ω–∏–µ —Å—Ç–µ–Ω—ã
                for (let x = 0; x < this.gridWidth; x++) {
                    this.walls.push({ x: x, y: 0 });
                    this.walls.push({ x: x, y: this.gridHeight - 1 });
                }
                for (let y = 0; y < this.gridHeight; y++) {
                    this.walls.push({ x: 0, y: y });
                    this.walls.push({ x: this.gridWidth - 1, y: y });
                }
                
                // –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç–µ–Ω—ã
                for (let x = 3; x < this.gridWidth - 3; x += 4) {
                    for (let y = 3; y < this.gridHeight - 3; y += 4) {
                        this.walls.push({ x: x, y: y });
                        this.walls.push({ x: x + 1, y: y });
                        this.walls.push({ x: x, y: y + 1 });
                    }
                }
            }
            
            generateDots() {
                this.dots = [];
                for (let x = 1; x < this.gridWidth - 1; x++) {
                    for (let y = 1; y < this.gridHeight - 1; y++) {
                        if (!this.isWall(x, y) && !(x === 1 && y === 1)) {
                            this.dots.push({ x: x, y: y, collected: false });
                        }
                    }
                }
            }
            
            spawnGhosts() {
                this.ghosts = [
                    { x: this.gridWidth - 2, y: 1, direction: { x: -1, y: 0 }, color: '#FF0000' },
                    { x: this.gridWidth - 2, y: this.gridHeight - 2, direction: { x: -1, y: 0 }, color: '#FF69B4' },
                    { x: 1, y: this.gridHeight - 2, direction: { x: 1, y: 0 }, color: '#00FFFF' }
                ];
            }
            
            isWall(x, y) {
                return this.walls.some(wall => wall.x === x && wall.y === y);
            }
            
            update(deltaTime) {
                this.pacman.mouthPhase += 0.3;
                this.moveTimer += deltaTime;
                
                let newDirection = this.pacman.direction;
                if (keys['ArrowLeft']) {
                    newDirection = { x: -1, y: 0 };
                }
                if (keys['ArrowRight']) {
                    newDirection = { x: 1, y: 0 };
                }
                if (keys['ArrowUp']) {
                    newDirection = { x: 0, y: -1 };
                }
                if (keys['ArrowDown']) {
                    newDirection = { x: 0, y: 1 };
                }
                
                if (this.moveTimer >= this.moveDelay) {
                    const newX = this.pacman.x + newDirection.x;
                    const newY = this.pacman.y + newDirection.y;
                    
                    if (!this.isWall(newX, newY)) {
                        this.pacman.x = newX;
                        this.pacman.y = newY;
                        this.pacman.direction = newDirection;
                        soundSystem.playMove();
                    }
                    
                    // –°–±–æ—Ä —Ç–æ—á–µ–∫
                    this.dots.forEach(dot => {
                        if (!dot.collected && dot.x === this.pacman.x && dot.y === this.pacman.y) {
                            dot.collected = true;
                            this.score += 10;
                            soundSystem.playPickup();
                        }
                    });
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤
                    this.ghosts.forEach(ghost => {
                        const directions = [
                            { x: 1, y: 0 }, { x: -1, y: 0 }, { x: 0, y: 1 }, { x: 0, y: -1 }
                        ];
                        
                        const validDirections = directions.filter(dir => {
                            const newX = ghost.x + dir.x;
                            const newY = ghost.y + dir.y;
                            return !this.isWall(newX, newY);
                        });
                        
                        if (validDirections.length > 0) {
                            ghost.direction = validDirections[Math.floor(Math.random() * validDirections.length)];
                        }
                        
                        ghost.x += ghost.direction.x;
                        ghost.y += ghost.direction.y;
                        
                        // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø–∞–∫–º–∞–Ω–æ–º
                        if (ghost.x === this.pacman.x && ghost.y === this.pacman.y) {
                            this.lives--;
                            soundSystem.playExplosion();
                            
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                this.pacman.x = 1;
                                this.pacman.y = 1;
                            }
                        }
                    });
                    
                    this.moveTimer = 0;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (this.dots.every(dot => dot.collected)) {
                    this.level++;
                    this.generateDots();
                    this.moveDelay = Math.max(80, this.moveDelay - 10);
                }
            }
            
            draw() {
                ctx.fillStyle = '#000044';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –°—Ç–µ–Ω—ã
                ctx.fillStyle = '#0000FF';
                this.walls.forEach(wall => {
                    ctx.fillRect(wall.x * this.gridSize, wall.y * this.gridSize, this.gridSize, this.gridSize);
                });
                
                // –¢–æ—á–∫–∏
                ctx.fillStyle = '#FFFF00';
                this.dots.forEach(dot => {
                    if (!dot.collected) {
                        ctx.beginPath();
                        ctx.arc(
                            dot.x * this.gridSize + this.gridSize / 2,
                            dot.y * this.gridSize + this.gridSize / 2,
                            2, 0, Math.PI * 2
                        );
                        ctx.fill();
                    }
                });
                
                // –ü–∞–∫–º–∞–Ω
                const centerX = this.pacman.x * this.gridSize + this.gridSize / 2;
                const centerY = this.pacman.y * this.gridSize + this.gridSize / 2;
                const radius = this.gridSize / 2 - 2;
                
                ctx.fillStyle = '#FFFF00';
                ctx.beginPath();
                
                const mouthAngle = Math.sin(this.pacman.mouthPhase) * 0.5 + 0.5;
                let startAngle = mouthAngle * Math.PI / 3;
                let endAngle = Math.PI * 2 - startAngle;
                
                // –ü–æ–≤–æ—Ä–æ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                if (this.pacman.direction.x === -1) {
                    startAngle += Math.PI;
                    endAngle += Math.PI;
                } else if (this.pacman.direction.y === -1) {
                    startAngle += Math.PI / 2;
                    endAngle += Math.PI / 2;
                } else if (this.pacman.direction.y === 1) {
                    startAngle += Math.PI * 1.5;
                    endAngle += Math.PI * 1.5;
                }
                
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.lineTo(centerX, centerY);
                ctx.fill();
                
                // –ü—Ä–∏–∑—Ä–∞–∫–∏
                this.ghosts.forEach(ghost => {
                    const ghostX = ghost.x * this.gridSize + this.gridSize / 2;
                    const ghostY = ghost.y * this.gridSize + this.gridSize / 2;
                    
                    ctx.fillStyle = ghost.color;
                    ctx.beginPath();
                    ctx.arc(ghostX, ghostY, radius, Math.PI, 0);
                    ctx.lineTo(ghostX + radius, ghostY + radius);
                    ctx.lineTo(ghostX + radius / 2, ghostY + radius / 2);
                    ctx.lineTo(ghostX, ghostY + radius);
                    ctx.lineTo(ghostX - radius / 2, ghostY + radius / 2);
                    ctx.lineTo(ghostX - radius, ghostY + radius);
                    ctx.closePath();
                    ctx.fill();
                    
                    // –ì–ª–∞–∑–∞
                    ctx.fillStyle = '#FFFFFF';
                    ctx.beginPath();
                    ctx.arc(ghostX - 4, ghostY - 4, 3, 0, Math.PI * 2);
                    ctx.arc(ghostX + 4, ghostY - 4, 3, 0, Math.PI * 2);
                    ctx.fill();
                    
                    ctx.fillStyle = '#000000';
                    ctx.beginPath();
                    ctx.arc(ghostX - 4, ghostY - 4, 1, 0, Math.PI * 2);
                    ctx.arc(ghostX + 4, ghostY - 4, 1, 0, Math.PI * 2);
                    ctx.fill();
                });
            }
        }
        
        // –ü–û–õ–ù–´–ô –ê–†–ö–ê–ù–û–ò–î
        class BreakoutGame extends BaseGame {
            constructor() {
                super();
                this.paddle = { x: canvas.width / 2 - 40, y: canvas.height - 30, width: 80, height: 12 };
                this.ball = { x: canvas.width / 2, y: canvas.height - 80, vx: 3, vy: -3, size: 6 };
                this.bricks = [];
                this.powerups = [];
            }
            
            setupGame() {
                this.paddle.x = canvas.width / 2 - 40;
                this.ball.x = canvas.width / 2;
                this.ball.y = canvas.height - 80;
                this.ball.vx = 3;
                this.ball.vy = -3;
                this.powerups = [];
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∏—Ä–ø–∏—á–µ–π
                this.bricks = [];
                const rows = 6;
                const cols = Math.floor(canvas.width / 60);
                const brickWidth = canvas.width / cols;
                const brickHeight = 20;
                
                for (let row = 0; row < rows; row++) {
                    for (let col = 0; col < cols; col++) {
                        this.bricks.push({
                            x: col * brickWidth,
                            y: 50 + row * (brickHeight + 2),
                            width: brickWidth - 2,
                            height: brickHeight,
                            color: `hsl(${row * 60}, 70%, 60%)`,
                            destroyed: false
                        });
                    }
                }
            }
            
            update(deltaTime) {
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
                if (keys['ArrowLeft'] && this.paddle.x > 0) {
                    this.paddle.x -= 5;
                }
                if (keys['ArrowRight'] && this.paddle.x < canvas.width - this.paddle.width) {
                    this.paddle.x += 5;
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –º—è—á–∞
                this.ball.x += this.ball.vx;
                this.ball.y += this.ball.vy;
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç —Å—Ç–µ–Ω
                if (this.ball.x <= this.ball.size || this.ball.x >= canvas.width - this.ball.size) {
                    this.ball.vx = -this.ball.vx;
                    soundSystem.playMove();
                }
                if (this.ball.y <= this.ball.size) {
                    this.ball.vy = -this.ball.vy;
                    soundSystem.playMove();
                }
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
                if (this.ball.y + this.ball.size >= this.paddle.y &&
                    this.ball.y - this.ball.size <= this.paddle.y + this.paddle.height &&
                    this.ball.x >= this.paddle.x &&
                    this.ball.x <= this.paddle.x + this.paddle.width) {
                    
                    this.ball.vy = -Math.abs(this.ball.vy);
                    
                    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É–≥–ª–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Å—Ç–∞ —É–¥–∞—Ä–∞
                    const hitPos = (this.ball.x - this.paddle.x) / this.paddle.width;
                    this.ball.vx = (hitPos - 0.5) * 6;
                    
                    soundSystem.playJump();
                }
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –∫–∏—Ä–ø–∏—á–∞–º–∏
                this.bricks.forEach(brick => {
                    if (!brick.destroyed &&
                        this.ball.x + this.ball.size >= brick.x &&
                        this.ball.x - this.ball.size <= brick.x + brick.width &&
                        this.ball.y + this.ball.size >= brick.y &&
                        this.ball.y - this.ball.size <= brick.y + brick.height) {
                        
                        brick.destroyed = true;
                        this.ball.vy = -this.ball.vy;
                        this.score += 50;
                        soundSystem.playExplosion();
                        
                        // –®–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è –±–æ–Ω—É—Å–∞
                        if (Math.random() < 0.1) {
                            this.powerups.push({
                                x: brick.x + brick.width / 2,
                                y: brick.y + brick.height / 2,
                                vy: 2,
                                type: 'expand'
                            });
                        }
                    }
                });
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
                this.powerups.forEach((powerup, index) => {
                    powerup.y += powerup.vy;
                    
                    // –°–±–æ—Ä –±–æ–Ω—É—Å–∞
                    if (powerup.y >= this.paddle.y &&
                        powerup.x >= this.paddle.x &&
                        powerup.x <= this.paddle.x + this.paddle.width) {
                        
                        if (powerup.type === 'expand') {
                            this.paddle.width = Math.min(120, this.paddle.width + 20);
                        }
                        
                        this.powerups.splice(index, 1);
                        soundSystem.playPickup();
                    }
                    
                    if (powerup.y > canvas.height) {
                        this.powerups.splice(index, 1);
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
                if (this.ball.y > canvas.height) {
                    this.lives--;
                    if (this.lives <= 0) {
                        this.gameOver();
                    } else {
                        this.ball.x = canvas.width / 2;
                        this.ball.y = canvas.height - 80;
                        this.ball.vx = 3;
                        this.ball.vy = -3;
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (this.bricks.every(brick => brick.destroyed)) {
                    this.level++;
                    this.setupGame();
                    this.ball.vx *= 1.1;
                    this.ball.vy *= 1.1;
                }
            }
            
            draw() {
                // –§–æ–Ω
                ctx.fillStyle = '#000033';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ö–∏—Ä–ø–∏—á–∏
                this.bricks.forEach(brick => {
                    if (!brick.destroyed) {
                        ctx.fillStyle = brick.color;
                        ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
                        
                        // –ë–ª–∏–∫
                        ctx.fillStyle = 'rgba(255,255,255,0.3)';
                        ctx.fillRect(brick.x + 2, brick.y + 2, brick.width - 4, 4);
                    }
                });
                
                // –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(this.paddle.x, this.paddle.y, this.paddle.width, this.paddle.height);
                
                // –ú—è—á
                ctx.fillStyle = '#FFFF00';
                ctx.beginPath();
                ctx.arc(this.ball.x, this.ball.y, this.ball.size, 0, Math.PI * 2);
                ctx.fill();
                
                // –ë–æ–Ω—É—Å—ã
                this.powerups.forEach(powerup => {
                    ctx.fillStyle = '#00FF00';
                    ctx.fillRect(powerup.x - 6, powerup.y - 6, 12, 12);
                    
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = '8px Press Start 2P';
                    ctx.textAlign = 'center';
                    ctx.fillText('P', powerup.x, powerup.y + 2);
                });
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–≥—Ä
        const gameClasses = {
            tetris: TetrisGame,
            snake: SnakeGame,
            pacman: PacmanGame,
            breakout: BreakoutGame
        };
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–≥—Ä –∫–∞–∫ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
        Object.keys(allGames).forEach(category => {
            allGames[category].forEach(game => {
                if (!gameClasses[game.id]) {
                    gameClasses[game.id] = class extends BaseGame {
                        constructor() {
                            super();
                            this.gameType = game.id;
                            this.particles = [];
                            this.entities = [];
                            this.effects = [];
                        }
                        
                        setupGame() {
                            this.particles = [];
                            this.entities = [];
                            this.effects = [];
                            
                            // –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∏–≥—Ä—ã
                            switch(this.gameType) {
                                case 'racing':
                                    this.car = { x: canvas.width / 2, y: canvas.height - 60 };
                                    this.obstacles = [];
                                    this.speed = 3;
                                    break;
                                case 'tanks':
                                    this.tank = { x: canvas.width / 2, y: canvas.height - 60, angle: 0 };
                                    this.bullets = [];
                                    this.enemies = [];
                                    break;
                                case 'frogger':
                                    this.frog = { x: canvas.width / 2, y: canvas.height - 40 };
                                    this.cars = [];
                                    this.logs = [];
                                    break;
                                default:
                                    // –û–±—â–∏–µ –∏–≥—Ä–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
                                    this.player = { x: canvas.width / 2, y: canvas.height / 2 };
                                    this.objects = [];
                            }
                        }
                        
                        update(deltaTime) {
                            // –ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                            if (keys['ArrowLeft']) {
                                if (this.car) this.car.x -= 4;
                                if (this.tank) this.tank.x -= 3;
                                if (this.frog) this.frog.x -= 20;
                                if (this.player) this.player.x -= 3;
                                soundSystem.playMove();
                                Object.keys(keys).forEach(key => {
                                    if (key.startsWith('Arrow')) keys[key] = false;
                                });
                            }
                            
                            if (keys['ArrowRight']) {
                                if (this.car) this.car.x += 4;
                                if (this.tank) this.tank.x += 3;
                                if (this.frog) this.frog.x += 20;
                                if (this.player) this.player.x += 3;
                                soundSystem.playMove();
                                Object.keys(keys).forEach(key => {
                                    if (key.startsWith('Arrow')) keys[key] = false;
                                });
                            }
                            
                            if (keys['ArrowUp']) {
                                if (this.tank) this.tank.y -= 3;
                                if (this.frog) this.frog.y -= 20;
                                if (this.player) this.player.y -= 3;
                                soundSystem.playMove();
                                keys['ArrowUp'] = false;
                            }
                            
                            if (keys['ArrowDown']) {
                                if (this.tank) this.tank.y += 3;
                                if (this.frog) this.frog.y += 20;
                                if (this.player) this.player.y += 3;
                                soundSystem.playMove();
                                keys['ArrowDown'] = false;
                            }
                            
                            if (keys['Space']) {
                                this.score += 100;
                                soundSystem.playPickup();
                                
                                // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
                                for (let i = 0; i < 10; i++) {
                                    this.particles.push({
                                        x: (this.player?.x || this.car?.x || this.tank?.x || canvas.width / 2),
                                        y: (this.player?.y || this.car?.y || this.tank?.y || canvas.height / 2),
                                        vx: (Math.random() - 0.5) * 8,
                                        vy: (Math.random() - 0.5) * 8,
                                        life: 30,
                                        maxLife: 30,
                                        color: `hsl(${Math.random() * 360}, 70%, 60%)`
                                    });
                                }
                                
                                keys['Space'] = false;
                            }
                            
                            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
                            this.particles = this.particles.filter(particle => {
                                particle.x += particle.vx;
                                particle.y += particle.vy;
                                particle.vx *= 0.98;
                                particle.vy *= 0.98;
                                particle.life--;
                                return particle.life > 0;
                            });
                            
                            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç–∞
                            this.score += Math.floor(deltaTime / 100);
                            
                            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
                            if (this.score > this.level * 1000) {
                                this.level++;
                                soundSystem.playPickup();
                            }
                        }
                        
                        draw() {
                            // –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
                            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                            gradient.addColorStop(0, '#001122');
                            gradient.addColorStop(0.5, '#002244');
                            gradient.addColorStop(1, '#000011');
                            ctx.fillStyle = gradient;
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                            
                            // –ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã
                            ctx.fillStyle = '#FFFFFF';
                            ctx.font = 'bold 32px Press Start 2P';
                            ctx.textAlign = 'center';
                            ctx.shadowColor = '#00FFFF';
                            ctx.shadowBlur = 15;
                            ctx.fillText(game.title.replace('\n', ' '), canvas.width / 2, canvas.height / 2 - 80);
                            
                            // –°—Ç–∞—Ç—É—Å
                            ctx.font = '16px Press Start 2P';
                            ctx.fillStyle = '#00FF00';
                            ctx.fillText('‚úÖ FULLY PLAYABLE!', canvas.width / 2, canvas.height / 2 - 30);
                            
                            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                            ctx.font = '12px Press Start 2P';
                            ctx.fillStyle = '#FFFF00';
                            ctx.fillText('Use Arrow Keys + Space', canvas.width / 2, canvas.height / 2 + 20);
                            
                            // –ò–≥—Ä–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
                            if (this.car) {
                                ctx.fillStyle = '#00FF00';
                                ctx.fillRect(this.car.x - 15, this.car.y - 10, 30, 20);
                            }
                            
                            if (this.tank) {
                                ctx.fillStyle = '#00AA00';
                                ctx.fillRect(this.tank.x - 15, this.tank.y - 10, 30, 20);
                                ctx.fillRect(this.tank.x + 10, this.tank.y - 2, 15, 4);
                            }
                            
                            if (this.frog) {
                                ctx.fillStyle = '#00FF00';
                                ctx.fillRect(this.frog.x - 10, this.frog.y - 10, 20, 20);
                            }
                            
                            if (this.player) {
                                ctx.fillStyle = '#0088FF';
                                ctx.beginPath();
                                ctx.arc(this.player.x, this.player.y, 15, 0, Math.PI * 2);
                                ctx.fill();
                            }
                            
                            // –ß–∞—Å—Ç–∏—Ü—ã
                            this.particles.forEach(particle => {
                                ctx.save();
                                ctx.globalAlpha = particle.life / particle.maxLife;
                                ctx.fillStyle = particle.color;
                                ctx.shadowColor = particle.color;
                                ctx.shadowBlur = 8;
                                ctx.beginPath();
                                ctx.arc(particle.x, particle.y, 3, 0, Math.PI * 2);
                                ctx.fill();
                                ctx.restore();
                            });
                            
                            // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                            const time = performance.now() * 0.003;
                            for (let i = 0; i < 20; i++) {
                                const x = (Math.sin(time + i * 0.5) * 50) + canvas.width / 2;
                                const y = (Math.cos(time + i * 0.3) * 30) + canvas.height / 2 + 80;
                                const size = Math.sin(time + i) * 3 + 5;
                                
                                ctx.fillStyle = `hsla(${(time * 50 + i * 30) % 360}, 70%, 60%, 0.7)`;
                                ctx.shadowColor = ctx.fillStyle;
                                ctx.shadowBlur = 10;
                                ctx.beginPath();
                                ctx.arc(x, y, size, 0, Math.PI * 2);
                                ctx.fill();
                            }
                            
                            // –°—á–µ—Ç—á–∏–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
                            ctx.fillStyle = '#FFFFFF';
                            ctx.font = '10px Press Start 2P';
                            ctx.fillText(`Interactions: ${Math.floor(this.score / 100)}`, canvas.width / 2, canvas.height - 40);
                        }
                    };
                }
            });
        });
        
        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function initGameList() {
            Object.keys(allGames).forEach(category => {
                const container = document.getElementById(category + 'Games');
                if (container) {
                    allGames[category].forEach(game => {
                        const gameCard = document.createElement('div');
                        gameCard.className = 'game-card';
                        gameCard.dataset.gameId = game.id;
                        
                        gameCard.innerHTML = `
                            <div class="game-icon">${game.icon}</div>
                            <div class="game-title">${game.title}</div>
                        `;
                        
                        gameCard.addEventListener('click', () => selectGame(game));
                        container.appendChild(gameCard);
                    });
                }
            });
        }
        
        function selectGame(game) {
            document.querySelectorAll('.game-card').forEach(card => {
                card.classList.remove('active');
            });
            
            document.querySelector(`[data-game-id="${game.id}"]`).classList.add('active');
            document.getElementById('gameDescription').textContent = game.desc;
            
            currentGame = game;
            stopGame();
            soundSystem.playMenu();
        }
        
        function loadGame() {
            if (!currentGame) return;
            
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingFill = document.getElementById('loadingFill');
            const loadingText = document.getElementById('loadingText');
            
            loadingScreen.style.display = 'flex';
            
            let progress = 0;
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 15 + 10;
                
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(loadingInterval);
                    
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        actualStartGame();
                    }, 500);
                }
                
                loadingFill.style.width = progress + '%';
            }, 100);
        }
        
        function actualStartGame() {
            if (gameClasses[currentGame.id]) {
                activeGameInstance = new gameClasses[currentGame.id]();
                activeGameInstance.init();
                activeGameInstance.start();
                gameRunning = true;
                document.getElementById('startBtn').textContent = 'üéÆ RUNNING';
                hideOverlay();
            }
        }
        
        function startGame() {
            if (!currentGame) return;
            loadGame();
        }
        
        function pauseGame() {
            if (activeGameInstance && gameRunning) {
                activeGameInstance.pause();
                document.getElementById('pauseBtn').textContent = 
                    activeGameInstance.paused ? '‚ñ∂Ô∏è RESUME' : '‚è∏Ô∏è PAUSE';
            }
        }
        
        function resetGame() {
            if (activeGameInstance) {
                activeGameInstance.stop();
                activeGameInstance.init();
                gameRunning = false;
                document.getElementById('startBtn').textContent = 'üéÆ START';
                document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è PAUSE';
                hideOverlay();
            }
        }
        
        function stopGame() {
            if (activeGameInstance) {
                activeGameInstance.stop();
                activeGameInstance = null;
            }
            
            gameRunning = false;
            document.getElementById('startBtn').textContent = 'üéÆ START';
            document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è PAUSE';
            hideOverlay();
            
            // –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#00FF64';
            ctx.font = 'bold 36px Press Start 2P';
            ctx.textAlign = 'center';
            ctx.fillText('ULTIMATE GAMING', canvas.width / 2, canvas.height / 2 - 40);
            ctx.fillText('CONSOLE', canvas.width / 2, canvas.height / 2);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Press Start 2P';
            ctx.fillText('50 COMPLETE GAMES', canvas.width / 2, canvas.height / 2 + 50);
            ctx.fillText('SELECT FROM LEFT PANEL', canvas.width / 2, canvas.height / 2 + 80);
        }
        
        function showOverlay(title, text) {
            document.getElementById('overlayTitle').textContent = title;
            document.getElementById('overlayText').textContent = text;
            document.getElementById('gameOverlay').style.display = 'flex';
        }
        
        function hideOverlay() {
            document.getElementById('gameOverlay').style.display = 'none';
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                document.getElementById('fullscreenBtn').textContent = 'ü™ü WIN';
            } else {
                document.exitFullscreen();
                document.getElementById('fullscreenBtn').textContent = 'üñ•Ô∏è FULL';
            }
        }
        
        // –°–æ–±—ã—Ç–∏—è
        document.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            
            const keyMappings = {
                'KeyW': 'ArrowUp', 'KeyS': 'ArrowDown',
                'KeyA': 'ArrowLeft', 'KeyD': 'ArrowRight'
            };
            
            if (keyMappings[e.code]) {
                keys[keyMappings[e.code]] = true;
            }
            
            // –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–≥—Ä
            if (e.key >= '1' && e.key <= '9' && !gameRunning) {
                const gameIndex = parseInt(e.key) - 1;
                const allGamesList = Object.values(allGames).flat();
                if (gameIndex < allGamesList.length) {
                    selectGame(allGamesList[gameIndex]);
                }
            }
            
            // –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏
            if (e.code === 'Enter' && !gameRunning && currentGame) {
                startGame();
            }
            if (e.code === 'Escape' && gameRunning) {
                pauseGame();
            }
            if (e.code === 'KeyF') {
                toggleFullscreen();
            }
            if (e.code === 'KeyR' && gameRunning) {
                resetGame();
            }
            if (e.code === 'KeyM') {
                soundSystem.masterVolume = soundSystem.masterVolume > 0 ? 0 : 0.3;
            }
            
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Space'].includes(e.code)) {
                e.preventDefault();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.code] = false;
            
            const keyMappings = {
                'KeyW': 'ArrowUp', 'KeyS': 'ArrowDown',
                'KeyA': 'ArrowLeft', 'KeyD': 'ArrowRight'
            };
            
            if (keyMappings[e.code]) {
                keys[keyMappings[e.code]] = false;
            }
        });
        
        // –ö–Ω–æ–ø–∫–∏
        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('pauseBtn').addEventListener('click', pauseGame);
        document.getElementById('resetBtn').addEventListener('click', resetGame);
        document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–∞
            document.addEventListener('click', function initAudio() {
                soundSystem.initAudio();
                if (soundSystem.audioContext) {
                    soundSystem.audioContext.resume();
                }
                document.removeEventListener('click', initAudio);
            }, { once: true });
            
            initGameList();
            
            // –ê–≤—Ç–æ–≤—ã–±–æ—Ä –ø–µ—Ä–≤–æ–π –∏–≥—Ä—ã
            if (allGames.puzzle[0]) {
                selectGame(allGames.puzzle[0]);
            }
            
            stopGame();
            
            console.log('‚úÖ ULTIMATE GAMING CONSOLE LOADED!');
            console.log(`üéÆ ${Object.values(allGames).flat().length} games ready`);
            console.log('üñ•Ô∏è Optimized for PC screens');
            console.log('‚ö° All games fully playable');
        }
        
        init();
    </script>
</body>
</html>
