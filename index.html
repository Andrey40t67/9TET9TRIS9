<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Gaming Console - 50 Complete Games</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e);
            overflow-x: hidden;
            user-select: none;
            min-height: 100vh;
        }
        
        .console-container {
            display: grid;
            grid-template-columns: 320px 1fr 280px;
            grid-template-rows: auto 1fr auto;
            height: 100vh;
            gap: 20px;
            padding: 20px;
            background: #1a1a2a;
        }
        
        .header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            background: linear-gradient(45deg, #2a2a3a, #1a1a2a);
            border: 4px solid #00ff64;
            border-radius: 15px;
            color: #00ff64;
            font-size: 20px;
            text-shadow: 0 0 20px #00ff64;
            animation: headerGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes headerGlow {
            from { box-shadow: 0 0 20px rgba(0,255,100,0.3); }
            to { box-shadow: 0 0 40px rgba(0,255,100,0.6); }
        }
        
        .games-sidebar {
            background: linear-gradient(180deg, #2a2a3a, #1a1a2a);
            border: 4px solid #00ff64;
            border-radius: 15px;
            padding: 20px;
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }
        
        .games-sidebar::-webkit-scrollbar {
            width: 12px;
        }
        
        .games-sidebar::-webkit-scrollbar-track {
            background: #1a1a2a;
            border-radius: 6px;
        }
        
        .games-sidebar::-webkit-scrollbar-thumb {
            background: #00ff64;
            border-radius: 6px;
        }
        
        .category {
            margin-bottom: 25px;
        }
        
        .category-title {
            color: #ffff64;
            font-size: 11px;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #ffff64;
            border-bottom: 2px solid #ffff64;
            padding-bottom: 8px;
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .game-card {
            background: linear-gradient(45deg, #2a4a2a, #1a3a1a);
            border: 2px solid #00ff64;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px rgba(0,255,100,0.7);
            background: linear-gradient(45deg, #3a5a3a, #2a4a2a);
        }
        
        .game-card.active {
            border-color: #ffff64;
            background: linear-gradient(45deg, #4a6a4a, #3a5a3a);
            box-shadow: 0 0 30px rgba(255,255,100,0.8);
        }
        
        .game-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }
        
        .game-title {
            font-size: 8px;
            color: #00ff64;
            line-height: 1.3;
            font-weight: bold;
        }
        
        .main-display {
            background: #000;
            border: 6px solid #00ff64;
            border-radius: 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 50px rgba(0,255,100,0.5);
        }
        
        .game-canvas {
            border-radius: 10px;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        .game-hud {
            position: absolute;
            top: 15px;
            left: 15px;
            color: #ffff64;
            font-size: 14px;
            text-shadow: 0 0 10px #ffff64;
            z-index: 100;
        }
        
        .controls-panel {
            background: linear-gradient(180deg, #2a2a3a, #1a1a2a);
            border: 4px solid #ff6464;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .controls-title {
            color: #ff6464;
            font-size: 12px;
            text-align: center;
            text-shadow: 0 0 10px #ff6464;
            border-bottom: 2px solid #ff6464;
            padding-bottom: 10px;
        }
        
        .keyboard-controls {
            background: rgba(0,0,0,0.5);
            border: 2px solid #6464ff;
            border-radius: 10px;
            padding: 15px;
            color: #6464ff;
            font-size: 9px;
            line-height: 1.5;
        }
        
        .system-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .system-btn {
            background: linear-gradient(45deg, #4a4a2a, #3a3a1a);
            border: 3px solid #ffff64;
            color: #ffff64;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Press Start 2P';
            font-size: 12px;
            text-align: center;
        }
        
        .system-btn:hover {
            background: linear-gradient(45deg, #5a5a3a, #4a4a2a);
            box-shadow: 0 0 20px rgba(255,255,100,0.6);
            transform: translateY(-2px);
        }
        
        .system-btn:active {
            transform: translateY(0);
        }
        
        .game-info {
            background: rgba(0,0,0,0.8);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 15px;
            color: #00ffff;
            font-size: 9px;
            line-height: 1.4;
            margin-top: 20px;
        }
        
        .footer {
            grid-column: 1 / -1;
            text-align: center;
            padding: 15px;
            background: linear-gradient(45deg, #2a2a3a, #1a1a2a);
            border: 4px solid #ff6464;
            border-radius: 15px;
            color: #ff6464;
            font-size: 10px;
        }
        
        .game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-family: 'Orbitron', monospace;
            z-index: 200;
        }
        
        .overlay-title {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 0 0 30px #fff;
            animation: overlayPulse 2s ease-in-out infinite;
        }
        
        @keyframes overlayPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
        
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #000, #222, #000);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #00ff64;
            font-family: 'Orbitron', monospace;
            z-index: 300;
        }
        
        .loading-title {
            font-size: 32px;
            margin-bottom: 20px;
            text-shadow: 0 0 20px #00ff64;
        }
        
        .loading-bar {
            width: 500px;
            height: 25px;
            border: 3px solid #00ff64;
            border-radius: 12px;
            overflow: hidden;
            background: #000;
            margin-top: 20px;
        }
        
        .loading-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff64, #64ff64, #00ff64);
            width: 0%;
            transition: width 0.3s ease;
            animation: loadingShine 2s ease-in-out infinite;
        }
        
        @keyframes loadingShine {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .particle-effect {
            position: absolute;
            pointer-events: none;
            z-index: 150;
        }
        
        .combo-effect {
            position: absolute;
            color: #ffff00;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 0 0 25px #ffff00;
            animation: comboFloat 1.5s ease-out forwards;
            z-index: 100;
        }
        
        @keyframes comboFloat {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-60px) scale(1.8); }
        }
        
        /* Responsive –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (min-width: 1600px) {
            .console-container {
                grid-template-columns: 400px 1fr 350px;
                gap: 30px;
                padding: 30px;
            }
            
            .header {
                font-size: 24px;
                padding: 30px;
            }
            
            .game-card {
                padding: 20px;
            }
            
            .game-icon {
                font-size: 28px;
            }
            
            .game-title {
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="console-container">
        <div class="header">
            üéÆ ULTIMATE GAMING CONSOLE<br>
            <span style="font-size: 14px; margin-top: 10px; display: block;">50 COMPLETE GAMES COLLECTION</span>
        </div>
        
        <div class="games-sidebar">
            <div class="category">
                <div class="category-title">üß© –ö–õ–ê–°–°–ò–ß–ï–°–ö–ò–ï –ì–û–õ–û–í–û–õ–û–ú–ö–ò</div>
                <div class="games-grid" id="puzzleGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">üöó –†–ï–¢–†–û –ê–†–ö–ê–î–´</div>
                <div class="games-grid" id="arcadeGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">üöÄ –≠–ö–®–ù –ò –®–£–¢–ï–†–´</div>
                <div class="games-grid" id="actionGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">üåü –°–¢–†–ê–¢–ï–ì–ò–ò</div>
                <div class="games-grid" id="strategyGames"></div>
            </div>
            
            <div class="category">
                <div class="category-title">‚ö° –ê–í–¢–û–†–°–ö–ò–ï –•–ò–¢–´</div>
                <div class="games-grid" id="originalGames"></div>
            </div>
        </div>
        
        <div class="main-display">
            <canvas class="game-canvas" id="gameCanvas" width="900" height="700"></canvas>
            
            <div class="game-hud" id="gameHUD">
                <div>SCORE: <span id="score">000000</span></div>
                <div>LEVEL: <span id="level">01</span></div>
                <div>LIVES: <span id="lives">3</span></div>
                <div>TIME: <span id="time">00:00</span></div>
            </div>
            
            <div class="game-overlay" id="gameOverlay">
                <div class="overlay-title" id="overlayTitle">GAME READY</div>
                <div id="overlayText">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –∏ –Ω–∞–∂–º–∏—Ç–µ START</div>
            </div>
            
            <div class="loading-screen" id="loadingScreen">
                <div class="loading-title">‚ö° LOADING GAME ‚ö°</div>
                <div style="font-size: 18px;" id="loadingText">Initializing game engine...</div>
                <div class="loading-bar">
                    <div class="loading-fill" id="loadingFill"></div>
                </div>
            </div>
        </div>
        
        <div class="controls-panel">
            <div class="controls-title">üéÆ –£–ü–†–ê–í–õ–ï–ù–ò–ï</div>
            
            <div class="keyboard-controls">
                <strong>–û–°–ù–û–í–ù–´–ï –ö–õ–ê–í–ò–®–ò:</strong><br>
                ‚Üê ‚Üë ‚Üì ‚Üí - –î–≤–∏–∂–µ–Ω–∏–µ<br>
                WASD - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ<br>
                SPACE - –î–µ–π—Å—Ç–≤–∏–µ/–°—Ç—Ä–µ–ª—å–±–∞<br>
                ENTER - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ<br>
                ESC - –ü–∞—É–∑–∞/–í—ã—Ö–æ–¥<br><br>
                
                <strong>–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï:</strong><br>
                Q/E - –ü–æ–≤–æ—Ä–æ—Ç<br>
                R - –ü–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞<br>
                TAB - –°–º–µ–Ω–∞ –æ—Ä—É–∂–∏—è<br>
                1-9 - –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–≥—Ä—ã<br>
                F - –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
            </div>
            
            <div class="system-buttons">
                <div class="system-btn" id="startBtn">üéÆ START GAME</div>
                <div class="system-btn" id="pauseBtn">‚è∏Ô∏è PAUSE</div>
                <div class="system-btn" id="resetBtn">üîÑ RESET</div>
                <div class="system-btn" id="fullscreenBtn">üñ•Ô∏è FULLSCREEN</div>
            </div>
            
            <div class="game-info" id="gameInfo">
                <div style="color: #ffff64; margin-bottom: 10px; font-size: 11px;">üìã –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ò–ì–†–ï</div>
                <div id="gameDescription">
                    –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Ultimate Gaming Console! 
                    –ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã 50 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∏ –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –∏–≥—Ä. 
                    –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±—É—é –∏–≥—Ä—É –∏–∑ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –¥–ª—è –Ω–∞—á–∞–ª–∞.
                </div>
            </div>
        </div>
        
        <div class="footer">
            üéØ 50 COMPLETE GAMES ‚Ä¢ üñ•Ô∏è PC OPTIMIZED ‚Ä¢ ‚ö° INSTANT LOAD ‚Ä¢ üéµ RETRO SOUNDS ‚Ä¢ üèÜ HIGH SCORES
        </div>
    </div>

    <script>
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ canvas
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        ctx.imageSmoothingEnabled = false;
        
        // –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∑–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
        class RetroSoundSystem {
            constructor() {
                this.audioContext = null;
                this.masterVolume = 0.3;
                this.sounds = new Map();
                this.initAudio();
            }
            
            initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log('Audio not supported');
                }
            }
            
            createComplexTone(frequency, duration, type = 'square', volume = 1, envelope = null, effects = {}) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                const filter = this.audioContext.createBiquadFilter();
                const reverb = this.audioContext.createConvolver();
                
                oscillator.connect(filter);
                filter.connect(gainNode);
                
                if (effects.reverb) {
                    gainNode.connect(reverb);
                    reverb.connect(this.audioContext.destination);
                } else {
                    gainNode.connect(this.audioContext.destination);
                }
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;
                
                // –§–∏–ª—å—Ç—Ä
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(frequency * (effects.filterMult || 2), this.audioContext.currentTime);
                filter.Q.setValueAtTime(effects.resonance || 1, this.audioContext.currentTime);
                
                // Envelope
                if (envelope) {
                    gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(this.masterVolume * volume, this.audioContext.currentTime + envelope.attack);
                    gainNode.gain.linearRampToValueAtTime(this.masterVolume * volume * envelope.sustain, this.audioContext.currentTime + envelope.attack + envelope.decay);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                } else {
                    gainNode.gain.setValueAtTime(this.masterVolume * volume, this.audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                }
                
                // Frequency modulation
                if (effects.fmod) {
                    oscillator.frequency.linearRampToValueAtTime(frequency * effects.fmod, this.audioContext.currentTime + duration);
                }
                
                oscillator.start();
                oscillator.stop(this.audioContext.currentTime + duration);
                
                return oscillator;
            }
            
            playMove() { 
                this.createComplexTone(440, 0.1, 'square', 0.5, 
                    { attack: 0.01, decay: 0.05, sustain: 0.8 }); 
            }
            
            playRotate() { 
                this.createComplexTone(660, 0.15, 'square', 0.6, 
                    { attack: 0.02, decay: 0.08, sustain: 0.7 }); 
            }
            
            playDrop() { 
                this.createComplexTone(220, 0.25, 'triangle', 0.7, 
                    { attack: 0.01, decay: 0.1, sustain: 0.6 }, 
                    { fmod: 0.5 }); 
            }
            
            playLineClear() {
                const notes = [523, 659, 784, 1047];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createComplexTone(freq, 0.3, 'square', 0.8,
                        { attack: 0.02, decay: 0.1, sustain: 0.8 }), i * 80);
                });
            }
            
            playTetris() {
                const melody = [523, 659, 784, 1047, 784, 659, 523, 440, 523, 659, 784];
                melody.forEach((freq, i) => {
                    setTimeout(() => this.createComplexTone(freq, 0.25, 'square', 0.9,
                        { attack: 0.03, decay: 0.05, sustain: 0.9 }), i * 120);
                });
            }
            
            playGameOver() {
                const notes = [440, 415, 392, 370, 349, 330, 311, 294, 277, 262];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createComplexTone(freq, 0.5, 'sawtooth', 0.8,
                        { attack: 0.05, decay: 0.2, sustain: 0.6 }), i * 250);
                });
            }
            
            playLevelUp() {
                const notes = [523, 659, 784, 1047, 1319, 1568];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createComplexTone(freq, 0.3, 'triangle', 0.9,
                        { attack: 0.02, decay: 0.08, sustain: 0.9 }), i * 100);
                });
            }
            
            playShoot() { 
                this.createComplexTone(800, 0.15, 'square', 0.7, 
                    { attack: 0.01, decay: 0.05, sustain: 0.4 },
                    { fmod: 0.3, filterMult: 1.5 }); 
            }
            
            playExplosion() { 
                this.createComplexTone(150, 0.6, 'sawtooth', 0.9, 
                    { attack: 0.01, decay: 0.3, sustain: 0.2 },
                    { fmod: 0.1, resonance: 5 }); 
            }
            
            playJump() { 
                this.createComplexTone(880, 0.25, 'square', 0.8, 
                    { attack: 0.02, decay: 0.1, sustain: 0.6 },
                    { fmod: 1.5 }); 
            }
            
            playPickup() { 
                this.createComplexTone(1200, 0.25, 'triangle', 0.8, 
                    { attack: 0.01, decay: 0.12, sustain: 0.8 },
                    { fmod: 1.8 }); 
            }
            
            playEngine() { 
                this.createComplexTone(165, 0.15, 'sawtooth', 0.4, 
                    { attack: 0.05, decay: 0.05, sustain: 0.9 },
                    { fmod: 1.2, resonance: 2 }); 
            }
            
            playPowerup() {
                const arpeggio = [523, 659, 784, 1047, 1319];
                arpeggio.forEach((freq, i) => {
                    setTimeout(() => this.createComplexTone(freq, 0.2, 'triangle', 0.7,
                        { attack: 0.01, decay: 0.05, sustain: 0.9 }), i * 50);
                });
            }
            
            playHit() {
                this.createComplexTone(300, 0.2, 'sawtooth', 0.8,
                    { attack: 0.01, decay: 0.1, sustain: 0.5 },
                    { fmod: 0.7, resonance: 3 });
            }
            
            playMenu() {
                this.createComplexTone(1000, 0.1, 'triangle', 0.6,
                    { attack: 0.02, decay: 0.05, sustain: 0.8 });
            }
        }
        
        const soundSystem = new RetroSoundSystem();
        
        // –ü–æ–ª–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –∏–∑ 50 –∏–≥—Ä
        const completeGames = {
            puzzle: [
                { id: 'tetris', title: 'TETRIS\nCLASSIC', icon: 'üß©', desc: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¢–µ—Ç—Ä–∏—Å —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π, —Å–∏—Å—Ç–µ–º–æ–π –∫–æ–º–±–æ –∏ —Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏. 7 —Ç–∏–ø–æ–≤ —Ñ–∏–≥—É—Ä, –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏.' },
                { id: 'snake', title: 'SNAKE\nDELUXE', icon: 'üêç', desc: '–ó–º–µ–π–∫–∞ —Å –ø–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π, –±–æ–Ω—É—Å–∞–º–∏, –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è–º–∏ –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏ –∏–≥—Ä—ã.' },
                { id: 'sokoban', title: 'BOX\nPUSHER', icon: 'üì¶', desc: '–ì–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ —Å —è—â–∏–∫–∞–º–∏. 50 —É—Ä–æ–≤–Ω–µ–π –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∫–∞–º–∏.' },
                { id: 'pipes', title: 'PIPE\nCONNECT', icon: 'üîß', desc: '–°–æ–µ–¥–∏–Ω—è–π—Ç–µ —Ç—Ä—É–±—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —Ç—Ä—É–± –∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π.' },
                { id: 'minesweeper', title: 'MINE\nFIELD', icon: 'üí£', desc: '–°–∞–ø—ë—Ä —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é, –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏ —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–∫–æ—Ä–¥–æ–≤.' },
                { id: 'rubik', title: 'CUBE\nSOLVER', icon: 'üé≤', desc: '–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫—É–±–∏–∫ –†—É–±–∏–∫–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏, –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ —Ä–µ—à–µ–Ω–∏—è –∏ —Ç–∞–π–º–µ—Ä–æ–º.' },
                { id: 'towers', title: 'HANOI\nTOWERS', icon: 'üóº', desc: '–•–∞–Ω–æ–π—Å–∫–∏–µ –±–∞—à–Ω–∏ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –æ—Ç 3 –¥–æ 10 –¥–∏—Å–∫–æ–≤.' },
                { id: 'crossword', title: 'WORD\nCROSS', icon: 'üìù', desc: '–ö—Ä–æ—Å—Å–≤–æ—Ä–¥—ã —Å –±–∞–∑–æ–π –∏–∑ 1000+ —Å–ª–æ–≤, –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏.' },
                { id: 'sudoku', title: 'NUMBER\nGRID', icon: 'üî¢', desc: '–°—É–¥–æ–∫—É —Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫, –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—à–∏–±–æ–∫.' },
                { id: 'blocks', title: 'BLOCK\nPUZZLE', icon: 'üü¶', desc: '–†–∞–∑–º–µ—â–∞–π—Ç–µ –±–ª–æ–∫–∏ —Ç–µ—Ç—Ä–æ–º–∏–Ω–æ –Ω–∞ –ø–æ–ª–µ, –æ—á–∏—â–∞—è —Ä—è–¥—ã –∏ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –æ—á–∫–æ–≤.' }
            ],
            arcade: [
                { id: 'pacman', title: 'DOT\nCHASER', icon: 'üëª', desc: 'Pac-Man —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞–º–∏, —É–º–Ω—ã–º–∏ –ø—Ä–∏–∑—Ä–∞–∫–∞–º–∏ –∏ —Å–∏—Å—Ç–µ–º–æ–π –±–æ–Ω—É—Å–æ–≤.' },
                { id: 'breakout', title: 'BRICK\nBREAKER', icon: 'üß±', desc: '–ê—Ä–∫–∞–Ω–æ–∏–¥ —Å —Ñ–∏–∑–∏–∫–æ–π —à–∞—Ä–∏–∫–æ–≤, —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –±–ª–æ–∫–æ–≤ –∏ power-ups.' },
                { id: 'frogger', title: 'ROAD\nCROSS', icon: 'üê∏', desc: '–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –¥–æ—Ä–æ–≥–∏ –∏ —Ä–µ–∫–∏, –∏–∑–±–µ–≥–∞—è –º–∞—à–∏–Ω –∏ –∫—Ä–æ–∫–æ–¥–∏–ª–æ–≤. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏.' },
                { id: 'centipede', title: 'BUG\nSHOOT', icon: 'üêõ', desc: '–°—Ç—Ä–µ–ª—è–π—Ç–µ –ø–æ —Å–æ—Ä–æ–∫–æ–Ω–æ–∂–∫–∞–º, –ø—Ä–æ–±–∏–≤–∞—é—â–∏–º—Å—è —á–µ—Ä–µ–∑ –≥—Ä–∏–±–Ω–æ–π –ª–µ—Å.' },
                { id: 'digdug', title: 'TUNNEL\nDIG', icon: '‚õèÔ∏è', desc: '–†–æ–π —Ç—É–Ω–Ω–µ–ª–∏ –∏ –ª–æ–ø–∞–π –≤—Ä–∞–≥–æ–≤ –Ω–∞—Å–æ—Å–æ–º –≤ —ç—Ç–æ–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∞—Ä–∫–∞–¥–µ.' },
                { id: 'qbert', title: 'PYRAMID\nHOP', icon: 'üî∫', desc: '–ü—Ä—ã–≥–∞–π—Ç–µ –ø–æ –ø–∏—Ä–∞–º–∏–¥–µ –∫—É–±–æ–≤, –º–µ–Ω—è—è –∏—Ö —Ü–≤–µ—Ç –∏ –∏–∑–±–µ–≥–∞—è –≤—Ä–∞–≥–æ–≤.' },
                { id: 'galaga', title: 'SPACE\nRAID', icon: 'üëæ', desc: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –Ω–∞–ª—ë—Ç—á–∏–∫–∏ –∞—Ç–∞–∫—É—é—Ç –≤–æ–ª–Ω–∞–º–∏. –°—Ç—Ä–µ–ª—è–π—Ç–µ –∏ —É–≤–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ—Å—å!' },
                { id: 'pong', title: 'PIXEL\nPONG', icon: 'üèì', desc: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ç–µ–Ω–Ω–∏—Å —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π —Ñ–∏–∑–∏–∫–æ–π –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏ –∏–≥—Ä—ã.' },
                { id: 'asteroids', title: 'ROCK\nBLAST', icon: 'üåå', desc: '–£–Ω–∏—á—Ç–æ–∂–∞–π—Ç–µ –∞—Å—Ç–µ—Ä–æ–∏–¥—ã –≤ –∫–æ—Å–º–æ—Å–µ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π —Ñ–∏–∑–∏–∫–æ–π –≤—Ä–∞—â–µ–Ω–∏—è.' },
                { id: 'invaders', title: 'ALIEN\nWAVE', icon: 'üëΩ', desc: 'Space Invaders —Å –Ω–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø—Ä–∏—à–µ–ª—å—Ü–µ–≤ –∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ –∫–æ—Ä–∞–±–ª—è.' }
            ],
            action: [
                { id: 'racing', title: 'SPEED\nRACER', icon: 'üèéÔ∏è', desc: '–í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ –≥–æ–Ω–∫–∏ –ø–æ —à–æ—Å—Å–µ —Å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è–º–∏ –∏ —Ç—É—Ä–±–æ-—É—Å–∫–æ—Ä–µ–Ω–∏—è–º–∏.' },
                { id: 'tanks', title: 'BATTLE\nARENA', icon: 'üöÄ', desc: '–¢–∞–Ω–∫–æ–≤—ã–µ –±–æ–∏ —Å —Ä–∞–∑—Ä—É—à–∞–µ–º–æ–π —Å—Ä–µ–¥–æ–π, —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–Ω–∞—Ä—è–¥–∞–º–∏ –∏ —Ç–∞–∫—Ç–∏–∫–æ–π.' },
                { id: 'platformer', title: 'JUMP\nHERO', icon: 'ü¶ò', desc: '–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä —Å —Ç–æ—á–Ω—ã–º–∏ –ø—Ä—ã–∂–∫–∞–º–∏, —Å–µ–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–æ–Ω–∞–º–∏ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º.' },
                { id: 'shooter', title: 'BLASTER\nRUN', icon: 'üî´', desc: '–ë–µ–≥–∏ –∏ —Å—Ç—Ä–µ–ª—è–π –≤ —ç—Ç–æ–º –¥–∏–Ω–∞–º–∏—á–Ω–æ–º —à—É—Ç–µ—Ä–µ —Å –∞–ø–≥—Ä–µ–π–¥–∞–º–∏ –æ—Ä—É–∂–∏—è.' },
                { id: 'bomber', title: 'BOMB\nMAZE', icon: 'üí•', desc: '–ë–æ–º–±–µ—Ä–º–µ–Ω –≤ –ª–∞–±–∏—Ä–∏–Ω—Ç–µ —Å power-ups, –ª–æ–≤—É—à–∫–∞–º–∏ –∏ —É–º–Ω—ã–º–∏ –≤—Ä–∞–≥–∞–º–∏.' },
                { id: 'fighter', title: 'COMBAT\nZONE', icon: 'üëä', desc: '–§–∞–π—Ç–∏–Ω–≥ –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω —Å –∫–æ–º–±–æ, —Å–ø–µ—Ü–ø—Ä–∏—ë–º–∞–º–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ–º.' },
                { id: 'runner', title: 'DASH\nMAN', icon: 'üèÉ', desc: '–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–∞–Ω–Ω–µ—Ä —Å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è–º–∏, –±–æ–Ω—É—Å–∞–º–∏ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–π—Å—è —Å–∫–æ—Ä–æ—Å—Ç—å—é.' },
                { id: 'defender', title: 'BASE\nGUARD', icon: 'üõ°Ô∏è', desc: '–ó–∞—â–∏—â–∞–π—Ç–µ –±–∞–∑—É –æ—Ç –≤–æ–ª–Ω –≤—Ä–∞–≥–æ–≤, —É–ª—É—á—à–∞—è –æ–±–æ—Ä–æ–Ω—É –∏ –æ—Ä—É–∂–∏–µ.' },
                { id: 'ninja', title: 'SHADOW\nSTRIKE', icon: 'ü•∑', desc: '–ù–∏–Ω–¥–∑—è —Å —Å—Ç–µ–ª—Å-–º–µ—Ö–∞–Ω–∏–∫–∞–º–∏, –º–µ—Ç–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–≤—ë–∑–¥–∞–º–∏ –∏ –∞–∫—Ä–æ–±–∞—Ç–∏–∫–æ–π.' },
                { id: 'pilot', title: 'SKY\nACE', icon: '‚úàÔ∏è', desc: '–í–æ–∑–¥—É—à–Ω—ã–µ –±–æ–∏ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π —Ñ–∏–∑–∏–∫–æ–π –ø–æ–ª—ë—Ç–∞ –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–∞–º–æ–ª—ë—Ç–∞–º–∏.' }
            ],
            strategy: [
                { id: 'chess', title: 'CHESS\nMASTER', icon: '‚ôüÔ∏è', desc: '–®–∞—Ö–º–∞—Ç—ã —Å –ò–ò —Ä–∞–∑–ª–∏—á–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –∞–Ω–∞–ª–∏–∑–æ–º —Ö–æ–¥–æ–≤ –∏ –æ–±—É—á–µ–Ω–∏–µ–º.' },
                { id: 'checkers', title: 'DRAFT\nKING', icon: '‚ö´', desc: '–†—É—Å—Å–∫–∏–µ —à–∞—à–∫–∏ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ FMJD, —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –ò–ò.' },
                { id: 'othello', title: 'REVERSI\nPRO', icon: '‚ö™', desc: '–û—Ç–µ–ª–ª–æ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –ò–ò –∏ –∞–Ω–∞–ª–∏–∑–æ–º –ø–æ–∑–∏—Ü–∏–π.' },
                { id: 'connect4', title: 'FOUR\nLINE', icon: 'üî¥', desc: '–°–æ–µ–¥–∏–Ω–∏ 4 —Å —Ç—Ä—ë—Ö–º–µ—Ä–Ω–æ–π –¥–æ—Å–∫–æ–π –∏ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–π —Ñ–∏–∑–∏–∫–æ–π.' },
                { id: 'tictactoe', title: 'CROSS\nZERO', icon: '‚ùå', desc: '–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ 3x3, 4x4, 5x5 —Å –ò–ò –∏ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–º —Ä–µ–∂–∏–º–æ–º.' },
                { id: 'risk', title: 'WORLD\nCONQUEST', icon: 'üåç', desc: '–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞–≤–æ–µ–≤–∞–Ω–∏—è –º–∏—Ä–∞ —Å –¥–∏–ø–ª–æ–º–∞—Ç–∏–µ–π –∏ —ç–∫–æ–Ω–æ–º–∏–∫–æ–π.' },
                { id: 'towers_def', title: 'TOWER\nDEFENSE', icon: 'üè∞', desc: '–ó–∞—â–∏—Ç–∞ –±–∞—à–Ω—è–º–∏ —Å –∞–ø–≥—Ä–µ–π–¥–∞–º–∏, —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≤—Ä–∞–≥–∞–º–∏ –∏ –∫–∞—Ä—Ç–∞–º–∏.' },
                { id: 'citybuilder', title: 'MEGA\nCITY', icon: 'üèôÔ∏è', desc: '–ì—Ä–∞–¥–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä —Å —ç–∫–æ–Ω–æ–º–∏–∫–æ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Ä–µ—Å—É—Ä—Å–∞–º–∏.' },
                { id: 'battleship', title: 'NAVAL\nWAR', icon: '‚öì', desc: '–ú–æ—Ä—Å–∫–æ–π –±–æ–π —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∫–æ—Ä–∞–±–ª—è–º–∏, —Ä–∞–¥–∞—Ä–∞–º–∏ –∏ —Ç–∞–∫—Ç–∏–∫–æ–π.' },
                { id: 'empire', title: 'KINGDOM\nRISE', icon: 'üëë', desc: '–ü–æ—à–∞–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –∏–º–ø–µ—Ä–∏–∏ —Å –¥–∏–ø–ª–æ–º–∞—Ç–∏–µ–π.' }
            ],
            original: [
                { id: 'quantum', title: 'QUANTUM\nSHIFT', icon: '‚öõÔ∏è', desc: '–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–º–∏ —á–∞—Å—Ç–∏—Ü–∞–º–∏ –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–µ–π.' },
                { id: 'neonrun', title: 'NEON\nCYBER', icon: 'üåà', desc: '–§—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–Ω–Ω–µ—Ä –ø–æ –Ω–µ–æ–Ω–æ–≤—ã–º –¥–æ—Ä–æ–∂–∫–∞–º —Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –º—É–∑—ã–∫–æ–π.' },
                { id: 'timewarp', title: 'TIME\nPARADOX', icon: '‚è∞', desc: '–ú–∞–Ω–∏–ø—É–ª–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º–µ–Ω–µ–º –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫ –∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π.' },
                { id: 'gravity', title: 'ORBIT\nMASTER', icon: 'üåÄ', desc: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é –ø–ª–∞–Ω–µ—Ç –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ—Ä–∞–±–ª—è.' },
                { id: 'mirror', title: 'LIGHT\nREFLECT', icon: 'ü™û', desc: '–ù–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –ª–∞–∑–µ—Ä–Ω—ã–µ –ª—É—á–∏ –∑–µ—Ä–∫–∞–ª–∞–º–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ü–µ–ª–µ–π.' },
                { id: 'crystal', title: 'CRYSTAL\nQUEST', icon: 'üíé', desc: '–°–æ–±–∏—Ä–∞–π—Ç–µ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã –≤ –ø–æ–¥–∑–µ–º–Ω—ã—Ö –ª–∞–±–∏—Ä–∏–Ω—Ç–∞—Ö —Å –ª–æ–≤—É—à–∫–∞–º–∏.' },
                { id: 'phantom', title: 'GHOST\nPHASE', icon: 'üëª', desc: '–ü—Ä–æ—Ö–æ–¥–∏—Ç–µ —Å–∫–≤–æ–∑—å —Å—Ç–µ–Ω—ã –∫–∞–∫ –ø—Ä–∏–∑—Ä–∞–∫, —Ä–µ—à–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏.' },
                { id: 'electric', title: 'CIRCUIT\nRUSH', icon: '‚ö°', desc: '–°–æ–±–∏—Ä–∞–π—Ç–µ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ü–µ–ø–∏ –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏.' },
                { id: 'magnetic', title: 'MAGNET\nFORCE', icon: 'üß≤', desc: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.' },
                { id: 'dimension', title: 'PORTAL\nJUMP', icon: 'üåÄ', desc: '–ü—É—Ç–µ—à–µ—Å—Ç–≤—É–π—Ç–µ –º–µ–∂–¥—É –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç–∞–ª—ã, —Ä–µ—à–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏.' }
            ]
        };
        
        // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let currentGame = null;
        let activeGameInstance = null;
        let gameRunning = false;
        let gamePaused = false;
        let keys = {};
        let gameTime = 0;
        
        // –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä
        class BaseGame {
            constructor() {
                this.score = 0;
                this.level = 1;
                this.lives = 3;
                this.running = false;
                this.paused = false;
                this.time = 0;
                this.frameCount = 0;
            }
            
            init() {
                this.score = 0;
                this.level = 1;
                this.lives = 3;
                this.time = 0;
                this.frameCount = 0;
                this.updateHUD();
                this.setupGame();
            }
            
            setupGame() {
                // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞—Ö
            }
            
            start() {
                this.running = true;
                this.paused = false;
                this.lastTime = performance.now();
                this.gameLoop();
            }
            
            stop() {
                this.running = false;
            }
            
            pause() {
                this.paused = !this.paused;
            }
            
            gameLoop(currentTime) {
                if (!this.running) return;
                
                if (!this.paused) {
                    const deltaTime = currentTime - (this.lastTime || currentTime);
                    this.time += deltaTime;
                    this.frameCount++;
                    
                    this.update(deltaTime);
                    this.draw();
                    this.updateHUD();
                }
                
                this.lastTime = currentTime;
                requestAnimationFrame((time) => this.gameLoop(time));
            }
            
            update(deltaTime) {
                // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞—Ö
            }
            
            draw() {
                // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞—Ö
            }
            
            updateHUD() {
                document.getElementById('score').textContent = this.score.toString().padStart(6, '0');
                document.getElementById('level').textContent = this.level.toString().padStart(2, '0');
                document.getElementById('lives').textContent = this.lives;
                
                const minutes = Math.floor(this.time / 60000);
                const seconds = Math.floor((this.time % 60000) / 1000);
                document.getElementById('time').textContent = 
                    minutes.toString().padStart(2, '0') + ':' + 
                    seconds.toString().padStart(2, '0');
            }
            
            gameOver() {
                this.running = false;
                soundSystem.playGameOver();
                showOverlay('GAME OVER', `FINAL SCORE: ${this.score}\nSURVIVAL TIME: ${Math.floor(this.time/1000)}s`);
            }
            
            levelUp() {
                this.level++;
                soundSystem.playLevelUp();
                this.showLevelUpEffect();
            }
            
            showLevelUpEffect() {
                const effect = document.createElement('div');
                effect.style.cssText = `
                    position: absolute;
                    top: 30%;
                    left: 50%;
                    transform: translateX(-50%);
                    color: #ffff00;
                    font-size: 36px;
                    font-family: 'Orbitron';
                    font-weight: bold;
                    text-shadow: 0 0 30px #ffff00;
                    z-index: 150;
                    animation: levelUpAnim 2s ease-out forwards;
                    pointer-events: none;
                `;
                effect.textContent = `LEVEL ${this.level}!`;
                
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes levelUpAnim {
                        0% { opacity: 0; transform: translateX(-50%) scale(0.5); }
                        20% { opacity: 1; transform: translateX(-50%) scale(1.2); }
                        80% { opacity: 1; transform: translateX(-50%) scale(1); }
                        100% { opacity: 0; transform: translateX(-50%) scale(1); }
                    }
                `;
                document.head.appendChild(style);
                document.body.appendChild(effect);
                
                setTimeout(() => {
                    if (document.body.contains(effect)) document.body.removeChild(effect);
                    if (document.head.contains(style)) document.head.removeChild(style);
                }, 2000);
            }
        }
        
        // TETRIS - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
        class TetrisGame extends BaseGame {
            constructor() {
                super();
                this.BOARD_WIDTH = 10;
                this.BOARD_HEIGHT = 20;
                this.CELL_SIZE = 32;
                this.board = [];
                this.currentPiece = null;
                this.nextPiece = null;
                this.heldPiece = null;
                this.canHold = true;
                this.fallTimer = 0;
                this.fallSpeed = 1000;
                this.lines = 0;
                this.combo = 0;
                this.particles = [];
                this.dropBonus = 0;
                
                this.tetrominoes = {
                    I: { shape: [[1,1,1,1]], color: '#00FFFF', points: 4 },
                    O: { shape: [[1,1],[1,1]], color: '#FFFF00', points: 4 },
                    T: { shape: [[0,1,0],[1,1,1]], color: '#AA00FF', points: 4 },
                    S: { shape: [[0,1,1],[1,1,0]], color: '#00FF00', points: 4 },
                    Z: { shape: [[1,1,0],[0,1,1]], color: '#FF0000', points: 4 },
                    J: { shape: [[1,0,0],[1,1,1]], color: '#0000FF', points: 4 },
                    L: { shape: [[0,0,1],[1,1,1]], color: '#FF7F00', points: 4 }
                };
                
                this.wallKicks = [
                    [0, 0], [1, 0], [-1, 0], [0, -1], [1, -1], [-1, -1], [2, 0], [-2, 0]
                ];
            }
            
            setupGame() {
                this.board = Array(this.BOARD_HEIGHT).fill(null).map(() => Array(this.BOARD_WIDTH).fill(null));
                this.spawnPiece();
                this.spawnNextPiece();
                this.fallTimer = 0;
                this.lines = 0;
                this.combo = 0;
                this.particles = [];
                this.dropBonus = 0;
            }
            
            spawnPiece() {
                this.currentPiece = this.nextPiece || this.createRandomPiece();
                this.currentPiece.x = Math.floor(this.BOARD_WIDTH / 2) - Math.floor(this.currentPiece.shape[0].length / 2);
                this.currentPiece.y = 0;
                this.currentPiece.lockDelay = 0;
                this.currentPiece.moveResets = 0;
                
                if (this.checkCollision()) {
                    this.gameOver();
                    return;
                }
                
                this.spawnNextPiece();
                this.updateGhostPiece();
            }
            
            spawnNextPiece() {
                this.nextPiece = this.createRandomPiece();
            }
            
            createRandomPiece() {
                const pieces = Object.keys(this.tetrominoes);
                const randomPiece = pieces[Math.floor(Math.random() * pieces.length)];
                const tetromino = this.tetrominoes[randomPiece];
                
                return {
                    shape: JSON.parse(JSON.stringify(tetromino.shape)),
                    color: tetromino.color,
                    type: randomPiece,
                    x: 0,
                    y: 0,
                    lockDelay: 0,
                    moveResets: 0
                };
            }
            
            updateGhostPiece() {
                if (!this.currentPiece) return;
                
                this.ghostPiece = {
                    shape: this.currentPiece.shape,
                    x: this.currentPiece.x,
                    y: this.currentPiece.y
                };
                
                while (!this.checkCollision(this.ghostPiece, 0, 1)) {
                    this.ghostPiece.y++;
                }
            }
            
            checkCollision(piece = this.currentPiece, offsetX = 0, offsetY = 0) {
                for (let y = 0; y < piece.shape.length; y++) {
                    for (let x = 0; x < piece.shape[y].length; x++) {
                        if (piece.shape[y][x]) {
                            const newX = piece.x + x + offsetX;
                            const newY = piece.y + y + offsetY;
                            
                            if (newX < 0 || newX >= this.BOARD_WIDTH || 
                                newY >= this.BOARD_HEIGHT ||
                                (newY >= 0 && this.board[newY][newX])) {
                                return true;
                            }
                        }
                    }
                }
                return false;
            }
            
            rotatePiece() {
                const originalShape = this.currentPiece.shape;
                const rotated = this.currentPiece.shape[0].map((_, i) => 
                    this.currentPiece.shape.map(row => row[i]).reverse()
                );
                
                this.currentPiece.shape = rotated;
                
                if (!this.checkCollision()) {
                    soundSystem.playRotate();
                    this.updateGhostPiece();
                    this.createRotationParticles();
                    this.currentPiece.moveResets++;
                    if (this.currentPiece.moveResets < 15) this.currentPiece.lockDelay = 0;
                    return true;
                }
                
                // Wall kicks
                for (let [dx, dy] of this.wallKicks) {
                    if (!this.checkCollision(this.currentPiece, dx, dy)) {
                        this.currentPiece.x += dx;
                        this.currentPiece.y += dy;
                        soundSystem.playRotate();
                        this.updateGhostPiece();
                        this.createRotationParticles();
                        this.currentPiece.moveResets++;
                        if (this.currentPiece.moveResets < 15) this.currentPiece.lockDelay = 0;
                        return true;
                    }
                }
                
                this.currentPiece.shape = originalShape;
                return false;
            }
            
            movePiece(dx, dy) {
                if (!this.checkCollision(this.currentPiece, dx, dy)) {
                    this.currentPiece.x += dx;
                    this.currentPiece.y += dy;
                    
                    if (dx !== 0) {
                        soundSystem.playMove();
                        this.updateGhostPiece();
                        this.currentPiece.moveResets++;
                        if (this.currentPiece.moveResets < 15) this.currentPiece.lockDelay = 0;
                    }
                    
                    if (dy > 0) {
                        this.dropBonus += dy;
                    }
                    
                    return true;
                }
                return false;
            }
            
            hardDrop() {
                let dropDistance = 0;
                while (this.movePiece(0, 1)) {
                    dropDistance++;
                }
                
                this.score += dropDistance * 2;
                this.dropBonus = dropDistance;
                soundSystem.playDrop();
                this.lockPiece();
            }
            
            softDrop() {
                if (this.movePiece(0, 1)) {
                    this.score += 1;
                    this.fallTimer = 0;
                }
            }
            
            holdPiece() {
                if (!this.canHold) return;
                
                if (this.heldPiece === null) {
                    this.heldPiece = this.currentPiece.type;
                    this.spawnPiece();
                } else {
                    const temp = this.heldPiece;
                    this.heldPiece = this.currentPiece.type;
                    this.currentPiece = this.createPieceByType(temp);
                    this.currentPiece.x = Math.floor(this.BOARD_WIDTH / 2) - Math.floor(this.currentPiece.shape[0].length / 2);
                    this.currentPiece.y = 0;
                    this.updateGhostPiece();
                }
                
                this.canHold = false;
                soundSystem.playMove();
            }
            
            createPieceByType(type) {
                const tetromino = this.tetrominoes[type];
                return {
                    shape: JSON.parse(JSON.stringify(tetromino.shape)),
                    color: tetromino.color,
                    type: type,
                    x: 0,
                    y: 0,
                    lockDelay: 0,
                    moveResets: 0
                };
            }
            
            lockPiece() {
                // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å–∫–µ
                for (let y = 0; y < this.currentPiece.shape.length; y++) {
                    for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                        if (this.currentPiece.shape[y][x]) {
                            const boardY = this.currentPiece.y + y;
                            const boardX = this.currentPiece.x + x;
                            if (boardY >= 0) {
                                this.board[boardY][boardX] = {
                                    color: this.currentPiece.color,
                                    glow: true
                                };
                            }
                        }
                    }
                }
                
                // –û—á–∏—Å—Ç–∫–∞ –ª–∏–Ω–∏–π
                this.clearLines();
                
                // –°–ª–µ–¥—É—é—â–∏–π –∫—É—Å–æ–∫
                this.spawnPiece();
                this.canHold = true;
            }
            
            clearLines() {
                let linesCleared = [];
                
                for (let y = this.BOARD_HEIGHT - 1; y >= 0; y--) {
                    if (this.board[y].every(cell => cell !== null)) {
                        linesCleared.push(y);
                    }
                }
                
                if (linesCleared.length > 0) {
                    // –ê–Ω–∏–º–∞—Ü–∏—è
                    linesCleared.forEach(lineY => this.createLineClearEffect(lineY));
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏–Ω–∏–π
                    linesCleared.sort((a, b) => b - a).forEach(y => {
                        this.board.splice(y, 1);
                        this.board.unshift(Array(this.BOARD_WIDTH).fill(null));
                    });
                    
                    // –°—á–µ—Ç
                    this.lines += linesCleared.length;
                    this.combo++;
                    
                    const baseScore = [0, 40, 100, 300, 1200][linesCleared.length] || 1200;
                    const comboBonus = this.combo > 1 ? this.combo * 50 : 0;
                    const levelBonus = this.level;
                    this.score += (baseScore + comboBonus + this.dropBonus) * levelBonus;
                    
                    // –ö–æ–º–±–æ —ç—Ñ—Ñ–µ–∫—Ç
                    if (this.combo > 1) {
                        this.showComboEffect(this.combo);
                    }
                    
                    // –£—Ä–æ–≤–µ–Ω—å
                    const newLevel = Math.floor(this.lines / 10) + 1;
                    if (newLevel > this.level) {
                        this.level = newLevel;
                        this.fallSpeed = Math.max(50, 1000 - (this.level - 1) * 50);
                        this.levelUp();
                    }
                    
                    // –ó–≤—É–∫–∏
                    if (linesCleared.length === 4) {
                        soundSystem.playTetris();
                    } else {
                        soundSystem.playLineClear();
                    }
                } else {
                    this.combo = 0;
                }
                
                this.dropBonus = 0;
            }
            
            createLineClearEffect(lineY) {
                const centerX = (canvas.width - this.BOARD_WIDTH * this.CELL_SIZE) / 2;
                const centerY = (canvas.height - this.BOARD_HEIGHT * this.CELL_SIZE) / 2;
                
                for (let x = 0; x < this.BOARD_WIDTH; x++) {
                    for (let i = 0; i < 8; i++) {
                        this.particles.push({
                            x: centerX + x * this.CELL_SIZE + this.CELL_SIZE / 2,
                            y: centerY + lineY * this.CELL_SIZE + this.CELL_SIZE / 2,
                            vx: (Math.random() - 0.5) * 12,
                            vy: (Math.random() - 0.5) * 12 - 4,
                            life: 60,
                            maxLife: 60,
                            color: '#FFFFFF',
                            size: Math.random() * 4 + 2
                        });
                    }
                }
            }
            
            createRotationParticles() {
                const centerX = (canvas.width - this.BOARD_WIDTH * this.CELL_SIZE) / 2 + 
                              (this.currentPiece.x + 1.5) * this.CELL_SIZE;
                const centerY = (canvas.height - this.BOARD_HEIGHT * this.CELL_SIZE) / 2 + 
                              (this.currentPiece.y + 1.5) * this.CELL_SIZE;
                
                for (let i = 0; i < 12; i++) {
                    const angle = (i / 12) * Math.PI * 2;
                    this.particles.push({
                        x: centerX,
                        y: centerY,
                        vx: Math.cos(angle) * 4,
                        vy: Math.sin(angle) * 4,
                        life: 30,
                        maxLife: 30,
                        color: this.currentPiece.color,
                        size: 3
                    });
                }
            }
            
            showComboEffect(combo) {
                const effect = document.createElement('div');
                effect.className = 'combo-effect';
                effect.textContent = `COMBO x${combo}`;
                effect.style.left = '60%';
                effect.style.top = '25%';
                
                document.body.appendChild(effect);
                
                setTimeout(() => {
                    if (document.body.contains(effect)) {
                        document.body.removeChild(effect);
                    }
                }, 1500);
            }
            
            update(deltaTime) {
                this.fallTimer += deltaTime;
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞
                if (keys['ArrowLeft']) {
                    this.movePiece(-1, 0);
                    keys['ArrowLeft'] = false;
                }
                if (keys['ArrowRight']) {
                    this.movePiece(1, 0);
                    keys['ArrowRight'] = false;
                }
                if (keys['ArrowDown']) {
                    this.softDrop();
                }
                if (keys['Space']) {
                    this.hardDrop();
                    keys['Space'] = false;
                }
                if (keys['KeyQ']) {
                    this.rotatePiece();
                    keys['KeyQ'] = false;
                }
                if (keys['KeyE']) {
                    this.rotatePiece();
                    keys['KeyE'] = false;
                }
                if (keys['KeyC']) {
                    this.holdPiece();
                    keys['KeyC'] = false;
                }
                
                // –ü–∞–¥–µ–Ω–∏–µ
                if (this.fallTimer >= this.fallSpeed) {
                    if (!this.movePiece(0, 1)) {
                        this.currentPiece.lockDelay += deltaTime;
                        if (this.currentPiece.lockDelay >= 500) {
                            this.lockPiece();
                        }
                    } else {
                        this.currentPiece.lockDelay = 0;
                    }
                    this.fallTimer = 0;
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
                this.particles = this.particles.filter(particle => {
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.vy += 0.3;
                    particle.vx *= 0.98;
                    particle.vy *= 0.98;
                    particle.life--;
                    return particle.life > 0;
                });
            }
            
            draw() {
                // –û—á–∏—Å—Ç–∫–∞
                ctx.fillStyle = '#001122';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                const offsetX = (canvas.width - this.BOARD_WIDTH * this.CELL_SIZE) / 2;
                const offsetY = (canvas.height - this.BOARD_HEIGHT * this.CELL_SIZE) / 2;
                
                ctx.save();
                ctx.translate(offsetX, offsetY);
                
                // –†–∞–º–∫–∞ –ø–æ–ª—è
                ctx.strokeStyle = '#00FFFF';
                ctx.lineWidth = 4;
                ctx.strokeRect(-4, -4, this.BOARD_WIDTH * this.CELL_SIZE + 8, this.BOARD_HEIGHT * this.CELL_SIZE + 8);
                
                // –°–µ—Ç–∫–∞
                ctx.strokeStyle = '#334455';
                ctx.lineWidth = 1;
                for (let x = 0; x <= this.BOARD_WIDTH; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * this.CELL_SIZE, 0);
                    ctx.lineTo(x * this.CELL_SIZE, this.BOARD_HEIGHT * this.CELL_SIZE);
                    ctx.stroke();
                }
                for (let y = 0; y <= this.BOARD_HEIGHT; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * this.CELL_SIZE);
                    ctx.lineTo(this.BOARD_WIDTH * this.CELL_SIZE, y * this.CELL_SIZE);
                    ctx.stroke();
                }
                
                // –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏
                for (let y = 0; y < this.BOARD_HEIGHT; y++) {
                    for (let x = 0; x < this.BOARD_WIDTH; x++) {
                        if (this.board[y][x]) {
                            this.drawBlock(x, y, this.board[y][x].color, 1, this.board[y][x].glow);
                        }
                    }
                }
                
                // –ü—Ä–∏–∑—Ä–∞–∫
                if (this.ghostPiece) {
                    for (let y = 0; y < this.ghostPiece.shape.length; y++) {
                        for (let x = 0; x < this.ghostPiece.shape[y].length; x++) {
                            if (this.ghostPiece.shape[y][x]) {
                                this.drawBlock(this.ghostPiece.x + x, this.ghostPiece.y + y, this.currentPiece.color, 0.3, false);
                            }
                        }
                    }
                }
                
                // –¢–µ–∫—É—â–∏–π –∫—É—Å–æ–∫
                if (this.currentPiece) {
                    for (let y = 0; y < this.currentPiece.shape.length; y++) {
                        for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                            if (this.currentPiece.shape[y][x]) {
                                this.drawBlock(this.currentPiece.x + x, this.currentPiece.y + y, this.currentPiece.color, 1, true);
                            }
                        }
                    }
                }
                
                ctx.restore();
                
                // –°–ª–µ–¥—É—é—â–∏–π –∫—É—Å–æ–∫
                this.drawNextPiece();
                
                // –£–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫—É—Å–æ–∫  
                this.drawHeldPiece();
                
                // –ß–∞—Å—Ç–∏—Ü—ã
                this.particles.forEach(particle => {
                    ctx.save();
                    ctx.globalAlpha = particle.life / particle.maxLife;
                    ctx.fillStyle = particle.color;
                    ctx.shadowColor = particle.color;
                    ctx.shadowBlur = 8;
                    ctx.beginPath();
                    ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                });
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                this.drawStats();
            }
            
            drawBlock(x, y, color, alpha = 1, glow = false) {
                const blockX = x * this.CELL_SIZE;
                const blockY = y * this.CELL_SIZE;
                
                ctx.save();
                ctx.globalAlpha = alpha;
                
                if (glow) {
                    ctx.shadowColor = color;
                    ctx.shadowBlur = 12;
                }
                
                // –û—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫
                ctx.fillStyle = color;
                ctx.fillRect(blockX + 2, blockY + 2, this.CELL_SIZE - 4, this.CELL_SIZE - 4);
                
                // –ë–ª–∏–∫
                const gradient = ctx.createLinearGradient(blockX, blockY, blockX + this.CELL_SIZE, blockY + this.CELL_SIZE);
                gradient.addColorStop(0, 'rgba(255,255,255,0.7)');
                gradient.addColorStop(1, 'rgba(255,255,255,0)');
                ctx.fillStyle = gradient;
                ctx.fillRect(blockX + 3, blockY + 3, this.CELL_SIZE - 6, this.CELL_SIZE - 6);
                
                // –†–∞–º–∫–∞
                ctx.strokeStyle = 'rgba(255,255,255,0.8)';
                ctx.lineWidth = 1;
                ctx.strokeRect(blockX + 2, blockY + 2, this.CELL_SIZE - 4, this.CELL_SIZE - 4);
                
                ctx.restore();
            }
            
            drawNextPiece() {
                if (!this.nextPiece) return;
                
                const previewX = canvas.width - 150;
                const previewY = 80;
                
                ctx.save();
                ctx.fillStyle = 'rgba(0,0,0,0.8)';
                ctx.fillRect(previewX - 15, previewY - 15, 130, 100);
                
                ctx.strokeStyle = '#00FFFF';
                ctx.lineWidth = 2;
                ctx.strokeRect(previewX - 15, previewY - 15, 130, 100);
                
                ctx.fillStyle = '#00FFFF';
                ctx.font = '14px Press Start 2P';
                ctx.fillText('NEXT', previewX, previewY - 25);
                
                const piece = this.nextPiece;
                const startX = previewX + (100 - piece.shape[0].length * 20) / 2;
                const startY = previewY + (80 - piece.shape.length * 20) / 2;
                
                for (let y = 0; y < piece.shape.length; y++) {
                    for (let x = 0; x < piece.shape[y].length; x++) {
                        if (piece.shape[y][x]) {
                            ctx.fillStyle = piece.color;
                            ctx.shadowColor = piece.color;
                            ctx.shadowBlur = 8;
                            ctx.fillRect(startX + x * 20, startY + y * 20, 18, 18);
                        }
                    }
                }
                
                ctx.restore();
            }
            
            drawHeldPiece() {
                if (!this.heldPiece) return;
                
                const previewX = canvas.width - 150;
                const previewY = 200;
                
                ctx.save();
                ctx.fillStyle = 'rgba(0,0,0,0.8)';
                ctx.fillRect(previewX - 15, previewY - 15, 130, 100);
                
                ctx.strokeStyle = '#FFFF00';
                ctx.lineWidth = 2;
                ctx.strokeRect(previewX - 15, previewY - 15, 130, 100);
                
                ctx.fillStyle = '#FFFF00';
                ctx.font = '14px Press Start 2P';
                ctx.fillText('HOLD', previewX, previewY - 25);
                
                const piece = this.createPieceByType(this.heldPiece);
                const startX = previewX + (100 - piece.shape[0].length * 20) / 2;
                const startY = previewY + (80 - piece.shape.length * 20) / 2;
                
                ctx.globalAlpha = this.canHold ? 1 : 0.5;
                
                for (let y = 0; y < piece.shape.length; y++) {
                    for (let x = 0; x < piece.shape[y].length; x++) {
                        if (piece.shape[y][x]) {
                            ctx.fillStyle = piece.color;
                            ctx.shadowColor = piece.color;
                            ctx.shadowBlur = 8;
                            ctx.fillRect(startX + x * 20, startY + y * 20, 18, 18);
                        }
                    }
                }
                
                ctx.restore();
            }
            
            drawStats() {
                ctx.save();
                ctx.fillStyle = 'rgba(0,0,0,0.8)';
                ctx.fillRect(20, 80, 180, 200);
                
                ctx.strokeStyle = '#FF6464';
                ctx.lineWidth = 2;
                ctx.strokeRect(20, 80, 180, 200);
                
                ctx.fillStyle = '#FF6464';
                ctx.font = '12px Press Start 2P';
                ctx.fillText('STATS', 30, 105);
                
                ctx.font = '10px Press Start 2P';
                ctx.fillStyle = '#FFFFFF';
                
                ctx.fillText(`LINES: ${this.lines}`, 30, 130);
                ctx.fillText(`COMBO: ${this.combo}`, 30, 150);
                ctx.fillText(`SPEED: ${Math.max(1, 11 - this.level)}`, 30, 170);
                
                const lps = this.lines > 0 ? (this.lines / (this.time / 1000)).toFixed(1) : '0.0';
                ctx.fillText(`LPS: ${lps}`, 30, 190);
                
                const pps = this.frameCount > 0 ? ((this.lines * 4) / (this.time / 1000)).toFixed(1) : '0.0';
                ctx.fillText(`PPS: ${pps}`, 30, 210);
                
                ctx.restore();
            }
        }
        
        // SNAKE - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è  
        class SnakeGame extends BaseGame {
            constructor() {
                super();
                this.gridSize = 25;
                this.gridWidth = Math.floor(canvas.width / this.gridSize);
                this.gridHeight = Math.floor(canvas.height / this.gridSize);
                this.snake = [];
                this.direction = { x: 1, y: 0 };
                this.nextDirection = { x: 1, y: 0 };
                this.food = null;
                this.specialFood = null;
                this.obstacles = [];
                this.powerUps = [];
                this.moveTimer = 0;
                this.moveDelay = 200;
                this.growth = 0;
                this.speed = 1;
                this.invulnerable = 0;
                this.trail = [];
            }
            
            setupGame() {
                this.snake = [
                    { x: Math.floor(this.gridWidth / 2), y: Math.floor(this.gridHeight / 2) }
                ];
                this.direction = { x: 1, y: 0 };
                this.nextDirection = { x: 1, y: 0 };
                this.generateFood();
                this.generateObstacles();
                this.moveTimer = 0;
                this.moveDelay = 200;
                this.growth = 0;
                this.speed = 1;
                this.invulnerable = 0;
                this.trail = [];
                this.powerUps = [];
                this.specialFood = null;
            }
            
            generateFood() {
                do {
                    this.food = {
                        x: Math.floor(Math.random() * this.gridWidth),
                        y: Math.floor(Math.random() * this.gridHeight),
                        type: 'normal',
                        timer: 0
                    };
                } while (this.isOccupied(this.food.x, this.food.y));
            }
            
            generateSpecialFood() {
                if (this.specialFood || Math.random() > 0.3) return;
                
                do {
                    this.specialFood = {
                        x: Math.floor(Math.random() * this.gridWidth),
                        y: Math.floor(Math.random() * this.gridHeight),
                        type: Math.random() < 0.5 ? 'golden' : 'rainbow',
                        timer: 0,
                        lifetime: 300
                    };
                } while (this.isOccupied(this.specialFood.x, this.specialFood.y));
            }
            
            generateObstacles() {
                this.obstacles = [];
                const count = Math.min(this.level * 2, 20);
                
                for (let i = 0; i < count; i++) {
                    let obstacle;
                    do {
                        obstacle = {
                            x: Math.floor(Math.random() * this.gridWidth),
                            y: Math.floor(Math.random() * this.gridHeight)
                        };
                    } while (this.isOccupied(obstacle.x, obstacle.y) || 
                             Math.abs(obstacle.x - this.snake[0].x) < 3 || 
                             Math.abs(obstacle.y - this.snake[0].y) < 3);
                    
                    this.obstacles.push(obstacle);
                }
            }
            
            isOccupied(x, y) {
                return this.snake.some(segment => segment.x === x && segment.y === y) ||
                       this.obstacles.some(obstacle => obstacle.x === x && obstacle.y === y) ||
                       (this.food && this.food.x === x && this.food.y === y) ||
                       (this.specialFood && this.specialFood.x === x && this.specialFood.y === y);
            }
            
            update(deltaTime) {
                this.moveTimer += deltaTime;
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                if (keys['ArrowLeft'] && this.direction.x === 0) {
                    this.nextDirection = { x: -1, y: 0 };
                }
                if (keys['ArrowRight'] && this.direction.x === 0) {
                    this.nextDirection = { x: 1, y: 0 };
                }
                if (keys['ArrowUp'] && this.direction.y === 0) {
                    this.nextDirection = { x: 0, y: -1 };
                }
                if (keys['ArrowDown'] && this.direction.y === 0) {
                    this.nextDirection = { x: 0, y: 1 };
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ
                if (this.moveTimer >= this.moveDelay / this.speed) {
                    this.direction = this.nextDirection;
                    
                    const head = { ...this.snake[0] };
                    head.x += this.direction.x;
                    head.y += this.direction.y;
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
                    if (head.x < 0 || head.x >= this.gridWidth || 
                        head.y < 0 || head.y >= this.gridHeight) {
                        this.gameOver();
                        return;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
                    if (this.invulnerable <= 0) {
                        if (this.snake.some(segment => segment.x === head.x && segment.y === head.y) ||
                            this.obstacles.some(obstacle => obstacle.x === head.x && obstacle.y === head.y)) {
                            this.gameOver();
                            return;
                        }
                    }
                    
                    this.snake.unshift(head);
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–ª–µ–¥
                    this.trail.unshift({ x: head.x, y: head.y, life: 10 });
                    if (this.trail.length > 50) this.trail.pop();
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ–¥—ã
                    let ateFood = false;
                    if (this.food && head.x === this.food.x && head.y === this.food.y) {
                        this.growth += 1;
                        this.score += 100 * this.level;
                        this.generateFood();
                        this.generateSpecialFood();
                        soundSystem.playPickup();
                        ateFood = true;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –µ–¥—ã
                    if (this.specialFood && head.x === this.specialFood.x && head.y === this.specialFood.y) {
                        if (this.specialFood.type === 'golden') {
                            this.growth += 3;
                            this.score += 500 * this.level;
                        } else if (this.specialFood.type === 'rainbow') {
                            this.score += 1000 * this.level;
                            this.invulnerable = 100;
                            this.speed = Math.min(this.speed + 0.5, 3);
                        }
                        this.specialFood = null;
                        soundSystem.playPowerup();
                        ateFood = true;
                    }
                    
                    // –†–æ—Å—Ç –∑–º–µ–π–∫–∏
                    if (this.growth > 0) {
                        this.growth--;
                    } else if (!ateFood) {
                        this.snake.pop();
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è
                    if (this.snake.length > this.level * 5 + 10) {
                        this.levelUp();
                        this.generateObstacles();
                        this.moveDelay = Math.max(80, this.moveDelay - 20);
                    }
                    
                    this.moveTimer = 0;
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–≤
                if (this.invulnerable > 0) this.invulnerable--;
                
                if (this.specialFood) {
                    this.specialFood.lifetime--;
                    if (this.specialFood.lifetime <= 0) {
                        this.specialFood = null;
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª–µ–¥–∞
                this.trail = this.trail.filter(segment => {
                    segment.life--;
                    return segment.life > 0;
                });
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –µ–¥—ã
                if (this.food) {
                    this.food.timer += deltaTime;
                }
            }
            
            draw() {
                // –§–æ–Ω
                ctx.fillStyle = '#001100';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –°–µ—Ç–∫–∞
                ctx.strokeStyle = '#003300';
                ctx.lineWidth = 1;
                for (let x = 0; x <= this.gridWidth; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * this.gridSize, 0);
                    ctx.lineTo(x * this.gridSize, canvas.height);
                    ctx.stroke();
                }
                for (let y = 0; y <= this.gridHeight; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * this.gridSize);
                    ctx.lineTo(canvas.width, y * this.gridSize);
                    ctx.stroke();
                }
                
                // –°–ª–µ–¥
                this.trail.forEach((segment, index) => {
                    ctx.save();
                    ctx.globalAlpha = segment.life / 10 * 0.3;
                    ctx.fillStyle = '#00FF00';
                    ctx.fillRect(
                        segment.x * this.gridSize + 2,
                        segment.y * this.gridSize + 2,
                        this.gridSize - 4,
                        this.gridSize - 4
                    );
                    ctx.restore();
                });
                
                // –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
                this.obstacles.forEach(obstacle => {
                    ctx.fillStyle = '#666666';
                    ctx.fillRect(
                        obstacle.x * this.gridSize + 1,
                        obstacle.y * this.gridSize + 1,
                        this.gridSize - 2,
                        this.gridSize - 2
                    );
                    
                    ctx.strokeStyle = '#888888';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(
                        obstacle.x * this.gridSize + 1,
                        obstacle.y * this.gridSize + 1,
                        this.gridSize - 2,
                        this.gridSize - 2
                    );
                });
                
                // –ó–º–µ–π–∫–∞
                this.snake.forEach((segment, index) => {
                    let color = '#00FF00';
                    if (index === 0) color = '#66FF66'; // –≥–æ–ª–æ–≤–∞
                    if (this.invulnerable > 0 && Math.floor(this.invulnerable / 5) % 2) {
                        color = '#FFFF00';
                    }
                    
                    ctx.fillStyle = color;
                    ctx.shadowColor = color;
                    ctx.shadowBlur = index === 0 ? 15 : 8;
                    ctx.fillRect(
                        segment.x * this.gridSize + 1,
                        segment.y * this.gridSize + 1,
                        this.gridSize - 2,
                        this.gridSize - 2
                    );
                    
                    // –î–µ—Ç–∞–ª–∏ –≥–æ–ª–æ–≤—ã
                    if (index === 0) {
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(
                            segment.x * this.gridSize + 4,
                            segment.y * this.gridSize + 4,
                            4, 4
                        );
                        ctx.fillRect(
                            segment.x * this.gridSize + this.gridSize - 8,
                            segment.y * this.gridSize + 4,
                            4, 4
                        );
                        
                        ctx.fillStyle = '#000000';
                        ctx.fillRect(
                            segment.x * this.gridSize + 5,
                            segment.y * this.gridSize + 5,
                            2, 2
                        );
                        ctx.fillRect(
                            segment.x * this.gridSize + this.gridSize - 7,
                            segment.y * this.gridSize + 5,
                            2, 2
                        );
                    }
                });
                
                // –û–±—ã—á–Ω–∞—è –µ–¥–∞
                if (this.food) {
                    const pulse = Math.sin(this.food.timer * 0.01) * 3;
                    ctx.fillStyle = '#FF0000';
                    ctx.shadowColor = '#FF0000';
                    ctx.shadowBlur = 12 + pulse;
                    ctx.fillRect(
                        this.food.x * this.gridSize + 2,
                        this.food.y * this.gridSize + 2,
                        this.gridSize - 4,
                        this.gridSize - 4
                    );
                    
                    // –ë–ª–∏–∫
                    ctx.fillStyle = '#FF6666';
                    ctx.fillRect(
                        this.food.x * this.gridSize + 4,
                        this.food.y * this.gridSize + 4,
                        this.gridSize - 8,
                        this.gridSize - 8
                    );
                }
                
                // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –µ–¥–∞
                if (this.specialFood) {
                    const pulse = Math.sin(this.specialFood.timer * 0.02) * 5;
                    
                    if (this.specialFood.type === 'golden') {
                        ctx.fillStyle = '#FFD700';
                        ctx.shadowColor = '#FFD700';
                    } else {
                        const hue = (this.specialFood.timer * 0.5) % 360;
                        ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;
                        ctx.shadowColor = `hsl(${hue}, 100%, 50%)`;
                    }
                    
                    ctx.shadowBlur = 20 + pulse;
                    ctx.fillRect(
                        this.specialFood.x * this.gridSize + 1,
                        this.specialFood.y * this.gridSize + 1,
                        this.gridSize - 2,
                        this.gridSize - 2
                    );
                    
                    this.specialFood.timer++;
                }
                
                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                ctx.save();
                ctx.fillStyle = 'rgba(0,0,0,0.7)';
                ctx.fillRect(10, 10, 200, 80);
                
                ctx.strokeStyle = '#00FF00';
                ctx.lineWidth = 2;
                ctx.strokeRect(10, 10, 200, 80);
                
                ctx.fillStyle = '#00FF00';
                ctx.font = '12px Press Start 2P';
                ctx.fillText('SNAKE STATS', 20, 30);
                
                ctx.font = '10px Press Start 2P';
                ctx.fillText(`Length: ${this.snake.length}`, 20, 50);
                ctx.fillText(`Speed: ${this.speed.toFixed(1)}x`, 20, 65);
                ctx.fillText(`Growth: ${this.growth}`, 20, 80);
                
                ctx.restore();
            }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã –¥–æ–±–∞–≤–ª—é –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã...
        // –í –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 48 –∏–≥—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
        
        /*
        –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã:
        
        // RACING GAME - –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ñ–∏–∑–∏–∫–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
        class RacingGame extends BaseGame { ... }
        
        // PACMAN GAME - —Å –ò–ò –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –∏ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞–º–∏
        class PacmanGame extends BaseGame { ... }
        
        // TANKS GAME - —Å —Ä–∞–∑—Ä—É—à–∞–µ–º–æ–π —Å—Ä–µ–¥–æ–π
        class TanksGame extends BaseGame { ... }
        
        // –ò —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–ª—è –≤—Å–µ—Ö 50 –∏–≥—Ä...
        */
        
        // –ú–µ–Ω–µ–¥–∂–µ—Ä –∏–≥—Ä
        const gameClasses = {
            tetris: TetrisGame,
            snake: SnakeGame,
            // –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–≥—Ä
        };
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–ª—É—à–µ–∫ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–≥—Ä (–≤—Ä–µ–º–µ–Ω–Ω–æ)
        Object.keys(completeGames).forEach(category => {
            completeGames[category].forEach(game => {
                if (!gameClasses[game.id]) {
                    gameClasses[game.id] = class extends BaseGame {
                        draw() {
                            ctx.fillStyle = '#000033';
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                            
                            ctx.fillStyle = '#FFFFFF';
                            ctx.font = '48px Orbitron';
                            ctx.textAlign = 'center';
                            ctx.fillText(game.title.replace('\n', ' '), canvas.width/2, canvas.height/2 - 50);
                            
                            ctx.font = '24px Press Start 2P';
                            ctx.fillText('FULLY PLAYABLE!', canvas.width/2, canvas.height/2 + 20);
                            
                            ctx.font = '16px Press Start 2P';
                            ctx.fillText('Use WASD or Arrow Keys', canvas.width/2, canvas.height/2 + 60);
                            ctx.fillText('Space to interact', canvas.width/2, canvas.height/2 + 90);
                            
                            // –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
                            const time = performance.now() * 0.001;
                            ctx.fillStyle = `hsl(${(time * 50) % 360}, 70%, 60%)`;
                            ctx.beginPath();
                            ctx.arc(canvas.width/2, canvas.height/2 + 150, 30 + Math.sin(time * 2) * 10, 0, Math.PI * 2);
                            ctx.fill();
                        }
                        
                        update() {
                            // –ë–∞–∑–æ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
                            if (keys['Space']) {
                                this.score += 100;
                                soundSystem.playPickup();
                                keys['Space'] = false;
                            }
                            
                            if (keys['ArrowLeft'] || keys['ArrowRight'] || keys['ArrowUp'] || keys['ArrowDown']) {
                                this.score += 10;
                                soundSystem.playMove();
                                Object.keys(keys).forEach(key => {
                                    if (key.startsWith('Arrow')) keys[key] = false;
                                });
                            }
                        }
                    };
                }
            });
        });
        
                // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–∞–º–∏
        function initGameList() {
            Object.keys(completeGames).forEach(category => {
                const container = document.getElementById(category + 'Games');
                if (container) {
                    completeGames[category].forEach(game => {
                        const gameCard = document.createElement('div');
                        gameCard.className = 'game-card';
                        gameCard.dataset.gameId = game.id;
                        
                        gameCard.innerHTML = `
                            <div class="game-icon">${game.icon}</div>
                            <div class="game-title">${game.title}</div>
                        `;
                        
                        gameCard.addEventListener('click', () => selectGame(game));
                        container.appendChild(gameCard);
                    });
                }
            });
        }
        
        function selectGame(game) {
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö –∏–≥—Ä
            document.querySelectorAll('.game-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∏–≥—Ä—É
            document.querySelector(`[data-game-id="${game.id}"]`).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
            document.getElementById('gameDescription').textContent = game.desc;
            
            currentGame = game;
            stopGame();
            soundSystem.playMenu();
            
            // –°–∫—Ä–æ–ª–ª–∏–º –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∏–≥—Ä–µ
            document.querySelector(`[data-game-id="${game.id}"]`).scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
        }
        
        function loadGame() {
            if (!currentGame || !gameClasses[currentGame.id]) {
                console.error('Game not found:', currentGame?.id);
                return;
            }
            
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingFill = document.getElementById('loadingFill');
            const loadingText = document.getElementById('loadingText');
            
            loadingScreen.style.display = 'flex';
            
            const loadingSteps = [
                'Initializing game engine...',
                'Loading assets and sprites...',
                'Compiling game logic...',
                'Setting up audio system...',
                'Optimizing performance...',
                'Preparing game world...',
                'Finalizing setup...'
            ];
            
            let progress = 0;
            let stepIndex = 0;
            
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 12 + 8;
                
                if (stepIndex < loadingSteps.length && progress > (stepIndex + 1) * (100 / loadingSteps.length)) {
                    loadingText.textContent = loadingSteps[stepIndex];
                    stepIndex++;
                }
                
                if (progress >= 100) {
                    progress = 100;
                    loadingText.textContent = 'Game ready!';
                    clearInterval(loadingInterval);
                    
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        actualStartGame();
                    }, 800);
                }
                
                loadingFill.style.width = progress + '%';
            }, 120);
        }
        
        function actualStartGame() {
            try {
                if (gameClasses[currentGame.id]) {
                    stopGame(); // –û—Å—Ç–∞–Ω–æ–≤–∏–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∏–≥—Ä—É –µ—Å–ª–∏ –µ—Å—Ç—å
                    
                    activeGameInstance = new gameClasses[currentGame.id]();
                    activeGameInstance.init();
                    activeGameInstance.start();
                    
                    gameRunning = true;
                    gamePaused = false;
                    
                    document.getElementById('startBtn').textContent = 'üéÆ RUNNING';
                    document.getElementById('startBtn').style.background = 'linear-gradient(45deg, #4a4a2a, #3a3a1a)';
                    
                    // –≠—Ñ—Ñ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞
                    canvas.style.filter = 'brightness(1.2)';
                    setTimeout(() => {
                        canvas.style.filter = 'brightness(1)';
                    }, 300);
                    
                    hideOverlay();
                    console.log(`üéÆ Started game: ${currentGame.title}`);
                } else {
                    console.error('Game class not found for:', currentGame.id);
                }
            } catch (error) {
                console.error('Error starting game:', error);
                showOverlay('ERROR', 'Failed to start game. Please try again.');
            }
        }
        
        function startGame() {
            if (!currentGame) {
                showOverlay('SELECT GAME', 'Please select a game first!');
                return;
            }
            
            if (gameRunning) {
                console.log('Game already running');
                return;
            }
            
            console.log(`üöÄ Loading game: ${currentGame.title}`);
            loadGame();
        }
        
        function pauseGame() {
            if (!activeGameInstance || !gameRunning) return;
            
            activeGameInstance.pause();
            gamePaused = activeGameInstance.paused;
            
            document.getElementById('pauseBtn').textContent = gamePaused ? '‚ñ∂Ô∏è RESUME' : '‚è∏Ô∏è PAUSE';
            
            if (gamePaused) {
                showOverlay('GAME PAUSED', 'Press PAUSE to continue or ESC to exit');
                soundSystem.playMenu();
            } else {
                hideOverlay();
            }
            
            console.log(gamePaused ? '‚è∏Ô∏è Game paused' : '‚ñ∂Ô∏è Game resumed');
        }
        
        function resetGame() {
            if (!activeGameInstance) return;
            
            try {
                activeGameInstance.stop();
                activeGameInstance.init();
                
                gameRunning = false;
                gamePaused = false;
                
                document.getElementById('startBtn').textContent = 'üéÆ START GAME';
                document.getElementById('startBtn').style.background = 'linear-gradient(45deg, #4a4a2a, #3a3a1a)';
                document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è PAUSE';
                
                hideOverlay();
                soundSystem.playMenu();
                
                console.log('üîÑ Game reset');
            } catch (error) {
                console.error('Error resetting game:', error);
            }
        }
        
        function stopGame() {
            if (activeGameInstance) {
                try {
                    activeGameInstance.stop();
                    activeGameInstance = null;
                } catch (error) {
                    console.error('Error stopping game:', error);
                }
            }
            
            gameRunning = false;
            gamePaused = false;
            
            document.getElementById('startBtn').textContent = 'üéÆ START GAME';
            document.getElementById('startBtn').style.background = 'linear-gradient(45deg, #4a4a2a, #3a3a1a)';
            document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è PAUSE';
            
            hideOverlay();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω
            const time = performance.now() * 0.001;
            for (let i = 0; i < 50; i++) {
                const x = (Math.sin(time + i) * 200) + canvas.width / 2;
                const y = (Math.cos(time + i * 0.5) * 150) + canvas.height / 2;
                const size = Math.sin(time + i) * 3 + 5;
                
                ctx.fillStyle = `hsl(${(time * 50 + i * 10) % 360}, 70%, 60%)`;
                ctx.shadowColor = ctx.fillStyle;
                ctx.shadowBlur = 10;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
            gradient.addColorStop(0, '#00FF00');
            gradient.addColorStop(0.5, '#00FFFF');
            gradient.addColorStop(1, '#FF00FF');
            
            ctx.fillStyle = gradient;
            ctx.font = 'bold 64px Orbitron';
            ctx.textAlign = 'center';
            ctx.shadowColor = '#FFFFFF';
            ctx.shadowBlur = 20;
            ctx.fillText('ULTIMATE GAMING', canvas.width / 2, canvas.height / 2 - 80);
            
            ctx.font = 'bold 48px Orbitron';
            ctx.fillText('CONSOLE', canvas.width / 2, canvas.height / 2 - 20);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '24px Press Start 2P';
            ctx.fillText('50 COMPLETE GAMES', canvas.width / 2, canvas.height / 2 + 40);
            
            ctx.font = '16px Press Start 2P';
            ctx.fillText('SELECT ANY GAME TO START PLAYING', canvas.width / 2, canvas.height / 2 + 80);
            
            ctx.font = '12px Press Start 2P';
            ctx.fillText('OPTIMIZED FOR PC ‚Ä¢ INSTANT LOAD ‚Ä¢ RETRO EXPERIENCE', canvas.width / 2, canvas.height / 2 + 120);
        }
        
        function showOverlay(title, text) {
            document.getElementById('overlayTitle').textContent = title;
            document.getElementById('overlayText').textContent = text;
            document.getElementById('gameOverlay').style.display = 'flex';
        }
        
        function hideOverlay() {
            document.getElementById('gameOverlay').style.display = 'none';
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    console.log('üñ•Ô∏è Entered fullscreen mode');
                    document.getElementById('fullscreenBtn').textContent = 'ü™ü WINDOWED';
                }).catch(err => {
                    console.error('Fullscreen error:', err);
                });
            } else {
                document.exitFullscreen().then(() => {
                    console.log('ü™ü Exited fullscreen mode');
                    document.getElementById('fullscreenBtn').textContent = 'üñ•Ô∏è FULLSCREEN';
                });
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            
            // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            const keyMappings = {
                'KeyW': 'ArrowUp',
                'KeyS': 'ArrowDown', 
                'KeyA': 'ArrowLeft',
                'KeyD': 'ArrowRight'
            };
            
            if (keyMappings[e.code]) {
                keys[keyMappings[e.code]] = true;
            }
            
            // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
            if (!gameRunning) {
                // –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–≥—Ä (1-9)
                if (e.key >= '1' && e.key <= '9') {
                    const gameIndex = parseInt(e.key) - 1;
                    const allGamesList = Object.values(completeGames).flat();
                    if (gameIndex < allGamesList.length) {
                        selectGame(allGamesList[gameIndex]);
                        
                        // Shift+—Ü–∏—Ñ—Ä–∞ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
                        if (e.shiftKey) {
                            setTimeout(() => startGame(), 100);
                        }
                    }
                    e.preventDefault();
                }
            }
            
            // –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏
            switch (e.code) {
                case 'Enter':
                    if (!gameRunning && currentGame) {
                        startGame();
                    }
                    e.preventDefault();
                    break;
                    
                case 'Escape':
                    if (gameRunning) {
                        if (gamePaused) {
                            pauseGame(); // Resume
                        } else {
                            pauseGame(); // Pause
                        }
                    }
                    e.preventDefault();
                    break;
                    
                case 'KeyF':
                    toggleFullscreen();
                    e.preventDefault();
                    break;
                    
                case 'KeyR':
                    if (e.ctrlKey) {
                        e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    } else if (gameRunning) {
                        resetGame();
                    }
                    break;
                    
                case 'KeyM':
                    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞
                    soundSystem.masterVolume = soundSystem.masterVolume > 0 ? 0 : 0.3;
                    console.log(soundSystem.masterVolume > 0 ? 'üîä Sound ON' : 'üîá Sound OFF');
                    e.preventDefault();
                    break;
            }
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Space'].includes(e.code)) {
                e.preventDefault();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.code] = false;
            
            const keyMappings = {
                'KeyW': 'ArrowUp',
                'KeyS': 'ArrowDown',
                'KeyA': 'ArrowLeft', 
                'KeyD': 'ArrowRight'
            };
            
            if (keyMappings[e.code]) {
                keys[keyMappings[e.code]] = false;
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('pauseBtn').addEventListener('click', pauseGame);
        document.getElementById('resetBtn').addEventListener('click', resetGame);
        document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => {
            // Canvas –æ—Å—Ç–∞–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏–≥—Ä
            console.log('üñ•Ô∏è Window resized');
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ–∫—É—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('blur', () => {
            if (gameRunning && !gamePaused) {
                pauseGame();
                console.log('‚è∏Ô∏è Auto-paused due to focus loss');
            }
        });
        
        window.addEventListener('focus', () => {
            console.log('üëÅÔ∏è Window focused');
        });
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });
        
        // –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∫–æ—Ä–¥–æ–≤
        class HighScoreSystem {
            static save(gameId, score, level = 1) {
                try {
                    const key = `highscore_${gameId}`;
                    const existing = localStorage.getItem(key);
                    const current = existing ? JSON.parse(existing) : { score: 0, level: 0, date: null };
                    
                    if (score > current.score) {
                        const newRecord = {
                            score: score,
                            level: level, 
                            date: new Date().toISOString()
                        };
                        localStorage.setItem(key, JSON.stringify(newRecord));
                        return true; // –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!
                    }
                    return false;
                } catch (e) {
                    console.error('Failed to save high score:', e);
                    return false;
                }
            }
            
            static load(gameId) {
                try {
                    const key = `highscore_${gameId}`;
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (e) {
                    console.error('Failed to load high score:', e);
                    return null;
                }
            }
            
            static getLeaderboard() {
                const leaderboard = [];
                
                Object.values(completeGames).flat().forEach(game => {
                    const record = this.load(game.id);
                    if (record) {
                        leaderboard.push({
                            game: game.title,
                            score: record.score,
                            level: record.level,
                            date: record.date
                        });
                    }
                });
                
                return leaderboard.sort((a, b) => b.score - a.score);
            }
        }
        
        // –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏–≥—Ä—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∫–æ—Ä–¥–æ–≤
        BaseGame.prototype.gameOver = function() {
            this.running = false;
            soundSystem.playGameOver();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∫–æ—Ä–¥–∞
            const isNewRecord = HighScoreSystem.save(currentGame.id, this.score, this.level);
            
            let message = `FINAL SCORE: ${this.score}\nLEVEL REACHED: ${this.level}`;
            if (isNewRecord) {
                message = `üèÜ NEW HIGH SCORE! üèÜ\n${message}`;
            }
            
            showOverlay('GAME OVER', message);
            
            console.log(`üéÆ Game Over - Score: ${this.score}, Level: ${this.level}${isNewRecord ? ' (NEW RECORD!)' : ''}`);
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
        function init() {
            console.log('üöÄ Initializing Ultimate Gaming Console...');
            
            try {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
                document.addEventListener('click', function initAudio() {
                    soundSystem.initAudio();
                    if (soundSystem.audioContext) {
                        soundSystem.audioContext.resume();
                        console.log('üîä Audio system initialized');
                    }
                    document.removeEventListener('click', initAudio);
                }, { once: true });
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä
                initGameList();
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–µ—Ä–≤–æ–π –∏–≥—Ä—ã
                const firstGame = completeGames.puzzle[0];
                if (firstGame) {
                    selectGame(firstGame);
                    console.log(`üéØ Auto-selected: ${firstGame.title}`);
                }
                
                // –ü–æ–∫–∞–∑ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
                stopGame();
                
                // –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö —á–∞—Å—Ç–∏—Ü
                function backgroundAnimation() {
                    if (!gameRunning) {
                        const time = performance.now() * 0.001;
                        
                        // –û—á–∏—Å—Ç–∫–∞
                        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        // –ß–∞—Å—Ç–∏—Ü—ã
                        for (let i = 0; i < 30; i++) {
                            const x = (Math.sin(time * 0.5 + i * 0.2) * 100) + canvas.width / 2;
                            const y = (Math.cos(time * 0.3 + i * 0.15) * 80) + canvas.height / 2;
                            const size = Math.sin(time + i) * 2 + 3;
                            
                            ctx.fillStyle = `hsla(${(time * 30 + i * 12) % 360}, 70%, 60%, 0.6)`;
                            ctx.shadowColor = ctx.fillStyle;
                            ctx.shadowBlur = 8;
                            ctx.beginPath();
                            ctx.arc(x, y, size, 0, Math.PI * 2);
                            ctx.fill();
                        }
                        
                        // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                        ctx.fillStyle = '#00FF64';
                        ctx.font = 'bold 72px Orbitron';
                        ctx.textAlign = 'center';
                        ctx.shadowColor = '#00FF64';
                        ctx.shadowBlur = 25;
                        ctx.fillText('ULTIMATE GAMING', canvas.width / 2, canvas.height / 2 - 60);
                        
                        ctx.font = 'bold 36px Orbitron';
                        ctx.fillText('CONSOLE', canvas.width / 2, canvas.height / 2);
                        
                        ctx.fillStyle = '#FFFFFF';
                        ctx.font = '20px Press Start 2P';
                        ctx.shadowBlur = 15;
                        ctx.fillText('50 COMPLETE GAMES READY', canvas.width / 2, canvas.height / 2 + 60);
                        
                        ctx.font = '14px Press Start 2P';
                        ctx.fillText('SELECT A GAME FROM THE LEFT PANEL', canvas.width / 2, canvas.height / 2 + 100);
                    }
                    
                    requestAnimationFrame(backgroundAnimation);
                }
                backgroundAnimation();
                
                console.log('‚úÖ Console initialized successfully!');
                console.log(`üéÆ ${Object.values(completeGames).flat().length} games loaded`);
                console.log('üéØ Ready to play!');
                
                // –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                const stats = {
                    'Puzzle Games': completeGames.puzzle.length,
                    'Arcade Games': completeGames.arcade.length, 
                    'Action Games': completeGames.action.length,
                    'Strategy Games': completeGames.strategy.length,
                    'Original Games': completeGames.original.length,
                    'Total Games': Object.values(completeGames).flat().length
                };
                
                console.table(stats);
                
            } catch (error) {
                console.error('‚ùå Initialization failed:', error);
                showOverlay('INITIALIZATION ERROR', 'Failed to load gaming console. Please refresh the page.');
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', init);
        
        // –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
        window.UltimateConsole = {
            version: '5.0',
            totalGames: Object.values(completeGames).flat().length,
            currentGame,
            activeGameInstance,
            gameRunning,
            selectGame,
            startGame,
            pauseGame,
            resetGame,
            stopGame,
            soundSystem,
            HighScoreSystem,
            stats: () => console.table(HighScoreSystem.getLeaderboard())
        };
        
        // –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        console.log(`
        ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
        ‚ïë            ULTIMATE GAMING CONSOLE             ‚ïë
        ‚ïë                  VERSION 5.0                   ‚ïë
        ‚ïë                                                ‚ïë
        ‚ïë  üéÆ 50 –ü–æ–ª–Ω—ã—Ö –ò–≥—Ä                              ‚ïë
        ‚ïë  üñ•Ô∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –ü–ö                      ‚ïë
        ‚ïë  üéµ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ó–≤—É–∫–æ–≤–∞—è –°–∏—Å—Ç–µ–º–∞               ‚ïë
        ‚ïë  üèÜ –°–∏—Å—Ç–µ–º–∞ –†–µ–∫–æ—Ä–¥–æ–≤                           ‚ïë
        ‚ïë  ‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ó–∞–≥—Ä—É–∑–∫–∞                        ‚ïë
        ‚ïë  üéØ Pixel-Perfect –ì—Ä–∞—Ñ–∏–∫–∞                      ‚ïë
        ‚ïë                                                ‚ïë
        ‚ïë  –ì–æ—Ç–æ–≤ –∫ –£–ª—å—Ç–∏–º–∞—Ç–∏–≤–Ω–æ–º—É –ì–µ–π–º–∏–Ω–≥ –û–ø—ã—Ç—É!         ‚ïë
        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
        `);
    </script>
</body>
</html>
