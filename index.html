<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ—Ç—Ä–æ–ö–æ–Ω—Å–æ–ª—å 999 - –ü–æ–ª–Ω–∞—è –ö–æ–ª–ª–µ–∫—Ü–∏—è</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
        }
        
        .console-container {
            background: #2a2a3a;
            border: 12px solid #1a1a2a;
            border-radius: 30px;
            padding: 40px;
            box-shadow: 
                0 0 60px rgba(0,255,100,0.4),
                inset 0 0 30px rgba(0,0,0,0.6);
            position: relative;
            max-width: 95vw;
            max-height: 95vh;
        }
        
        .console-header {
            text-align: center;
            margin-bottom: 30px;
            color: #00ff64;
            font-size: 20px;
            text-shadow: 0 0 20px #00ff64;
            letter-spacing: 3px;
            animation: headerGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes headerGlow {
            from { text-shadow: 0 0 20px #00ff64; }
            to { text-shadow: 0 0 40px #00ff64, 0 0 60px #00ff64; }
        }
        
        .main-layout {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }
        
        .game-selector {
            background: #1a1a2a;
            border: 4px solid #00ff64;
            border-radius: 15px;
            padding: 20px;
            min-width: 220px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .selector-title {
            color: #00ff64;
            font-size: 10px;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #00ff64;
        }
        
        .game-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .game-item {
            background: linear-gradient(45deg, #2a4a2a, #1a3a1a);
            border: 2px solid #00ff64;
            color: #00ff64;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 8px;
            text-align: center;
            position: relative;
        }
        
        .game-item:hover {
            background: linear-gradient(45deg, #3a5a3a, #2a4a2a);
            box-shadow: 0 0 15px rgba(0,255,100,0.6);
            transform: translateY(-2px);
        }
        
        .game-item.active {
            background: linear-gradient(45deg, #4a6a4a, #3a5a3a);
            box-shadow: 0 0 20px rgba(0,255,100,0.8);
        }
        
        .game-icon {
            font-size: 20px;
            margin-bottom: 6px;
            display: block;
        }
        
        .game-title {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .game-genre {
            font-size: 6px;
            color: #888;
        }
        
        .game-screen {
            background: #000;
            border: 6px solid #00ff64;
            border-radius: 15px;
            position: relative;
            box-shadow: 
                0 0 40px rgba(0,255,100,0.6),
                inset 0 0 20px rgba(0,255,100,0.1);
        }
        
        .game-canvas {
            display: block;
            background: #000;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        .controls-panel {
            background: #1a1a2a;
            border: 4px solid #ff6464;
            border-radius: 15px;
            padding: 20px;
            min-width: 220px;
        }
        
        .controls-title {
            color: #ff6464;
            font-size: 10px;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #ff6464;
        }
        
        .control-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 15px;
        }
        
        .control-btn {
            background: linear-gradient(45deg, #4a2a2a, #3a1a1a);
            border: 2px solid #ff6464;
            color: #ff6464;
            padding: 10px 6px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 7px;
            text-align: center;
            font-family: 'Press Start 2P';
        }
        
        .control-btn:hover {
            background: linear-gradient(45deg, #5a3a3a, #4a2a2a);
            box-shadow: 0 0 10px rgba(255,100,100,0.5);
        }
        
        .control-btn:active {
            transform: scale(0.95);
            background: linear-gradient(45deg, #6a4a4a, #5a3a3a);
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .action-btn {
            background: linear-gradient(45deg, #2a2a4a, #1a1a3a);
            border: 2px solid #6464ff;
            color: #6464ff;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 8px;
            font-family: 'Press Start 2P';
        }
        
        .action-btn:hover {
            background: linear-gradient(45deg, #3a3a5a, #2a2a4a);
            box-shadow: 0 0 10px rgba(100,100,255,0.5);
        }
        
        .settings-btn {
            background: linear-gradient(45deg, #4a2a4a, #3a1a3a);
            border: 2px solid #ff64ff;
            color: #ff64ff;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 7px;
            font-family: 'Press Start 2P';
            width: 100%;
            margin-bottom: 15px;
        }
        
        .settings-btn:hover {
            background: linear-gradient(45deg, #5a3a5a, #4a2a4a);
            box-shadow: 0 0 10px rgba(255,100,255,0.5);
        }
        
        .settings-panel {
            background: #1a1a2a;
            border: 4px solid #ff64ff;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
            display: none;
        }
        
        .settings-title {
            color: #ff64ff;
            font-size: 8px;
            margin-bottom: 10px;
            text-align: center;
            text-shadow: 0 0 8px #ff64ff;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 6px;
            color: #ccc;
        }
        
        .setting-select {
            background: #333;
            border: 1px solid #ff64ff;
            color: #ff64ff;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 6px;
            font-family: 'Press Start 2P';
        }
        
        .game-info {
            background: #1a1a2a;
            border: 4px solid #ffff64;
            border-radius: 10px;
            padding: 12px;
            color: #ffff64;
            font-size: 7px;
            line-height: 1.4;
        }
        
        .info-title {
            font-size: 8px;
            margin-bottom: 8px;
            text-align: center;
            text-shadow: 0 0 8px #ffff64;
        }
        
        .score-display {
            position: absolute;
            top: 8px;
            right: 8px;
            color: #ffff64;
            font-size: 10px;
            text-shadow: 0 0 8px #ffff64;
            z-index: 50;
            font-family: 'Press Start 2P';
        }
        
        .lives-display {
            position: absolute;
            top: 8px;
            left: 8px;
            color: #ff6464;
            font-size: 10px;
            text-shadow: 0 0 8px #ff6464;
            z-index: 50;
            font-family: 'Press Start 2P';
        }
        
        .game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-family: 'Press Start 2P';
            z-index: 100;
        }
        
        .overlay-title {
            font-size: 24px;
            margin-bottom: 15px;
            text-shadow: 0 0 15px #fff;
            animation: overlayPulse 2s ease-in-out infinite;
        }
        
        @keyframes overlayPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #000, #222);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #00ff64;
            font-family: 'Press Start 2P';
            z-index: 200;
        }
        
        .loading-title {
            font-size: 16px;
            margin-bottom: 20px;
            text-shadow: 0 0 15px #00ff64;
        }
        
        .loading-bar {
            width: 300px;
            height: 20px;
            border: 2px solid #00ff64;
            border-radius: 4px;
            overflow: hidden;
            background: #000;
        }
        
        .loading-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff64, #64ff64);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px #00ff64;
        }
        
        .pixel-perfect {
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-crisp-edges;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                flex-direction: column;
                gap: 20px;
            }
            
            .console-container {
                padding: 20px;
            }
            
            .game-selector, .controls-panel {
                min-width: auto;
                max-height: none;
            }
        }
    </style>
</head>
<body>
    <div class="console-container">
        <div class="console-header">
            üéÆ –†–ï–¢–†–û–ö–û–ù–°–û–õ–¨ 999 - –ü–û–õ–ù–ê–Ø –ö–û–õ–õ–ï–ö–¶–ò–Ø üéÆ
        </div>
        
        <div class="main-layout">
            <div class="game-selector">
                <div class="selector-title">–í–´–ë–û–† –ò–ì–†–´</div>
                <div class="game-list" id="gameList"></div>
            </div>
            
            <div class="game-screen">
                <canvas class="game-canvas pixel-perfect" id="gameCanvas" width="640" height="480"></canvas>
                
                <div class="score-display" id="scoreDisplay">–°–ß–Å–¢: 000000</div>
                <div class="lives-display" id="livesDisplay">–ñ–ò–ó–ù–ò: 3</div>
                
                <div class="game-overlay" id="gameOverlay">
                    <div class="overlay-title" id="overlayTitle">–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</div>
                    <div id="overlayText">–ù–∞–∂–º–∏—Ç–µ –°–¢–ê–†–¢ —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</div>
                </div>
                
                <div class="loading-screen" id="loadingScreen">
                    <div class="loading-title">–ó–ê–ì–†–£–ó–ö–ê –ò–ì–†–´...</div>
                    <div class="loading-bar">
                        <div class="loading-fill" id="loadingFill"></div>
                    </div>
                </div>
            </div>
            
            <div class="controls-panel">
                <div class="controls-title">–£–ü–†–ê–í–õ–ï–ù–ò–ï</div>
                
                <button class="settings-btn" id="settingsBtn">–ù–ê–°–¢–†–û–ô–ö–ò</button>
                
                <div class="settings-panel" id="settingsPanel">
                    <div class="settings-title">–ù–ê–°–¢–†–û–ô–ö–ò</div>
                    <div class="setting-item">
                        <span>–ó–≤—É–∫:</span>
                        <select class="setting-select" id="soundSetting">
                            <option value="on">–í–ö–õ</option>
                            <option value="off">–í–´–ö–õ</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</span>
                        <select class="setting-select" id="controlSetting">
                            <option value="arrows">–°–¢–†–ï–õ–ö–ò</option>
                            <option value="wasd">WASD</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <span>–°–∫–æ—Ä–æ—Å—Ç—å:</span>
                        <select class="setting-select" id="speedSetting">
                            <option value="normal">–ù–û–†–ú–ê–õ–¨–ù–ê–Ø</option>
                            <option value="fast">–ë–´–°–¢–†–ê–Ø</option>
                            <option value="slow">–ú–ï–î–õ–ï–ù–ù–ê–Ø</option>
                        </select>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <div></div>
                    <button class="control-btn" data-key="ArrowUp">‚ñ≤</button>
                    <div></div>
                    <button class="control-btn" data-key="ArrowLeft">‚óÑ</button>
                    <button class="control-btn" data-key="Space">‚óè</button>
                    <button class="control-btn" data-key="ArrowRight">‚ñ∫</button>
                    <div></div>
                    <button class="control-btn" data-key="ArrowDown">‚ñº</button>
                    <div></div>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn" id="startBtn">–°–¢–ê–†–¢</button>
                    <button class="action-btn" id="pauseBtn">–ü–ê–£–ó–ê</button>
                    <button class="action-btn" id="resetBtn">–°–ë–†–û–°</button>
                </div>
                
                <div class="game-info" id="gameInfo">
                    <div class="info-title">–ò–ù–§–û –û–ë –ò–ì–†–ï</div>
                    <div id="gameDescription">
                        –í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã. –í—Å–µ –∏–≥—Ä—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã!
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        ctx.imageSmoothingEnabled = false;
        ctx.webkitImageSmoothingEnabled = false;
        ctx.mozImageSmoothingEnabled = false;
        ctx.msImageSmoothingEnabled = false;
        
        let gameSettings = {
            sound: true,
            controls: 'arrows',
            speed: 'normal'
        };
        
        class ChiptuneSystem {
            constructor() {
                this.audioContext = null;
                this.masterVolume = 0.2;
                this.initAudio();
            }
            
            initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log('Audio not supported');
                }
            }
            
            createTone(frequency, duration, type = 'square', volume = 1) {
                if (!this.audioContext || !gameSettings.sound) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(this.masterVolume * volume, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);
                
                oscillator.start();
                oscillator.stop(this.audioContext.currentTime + duration);
            }
            
            playMove() { this.createTone(220, 0.1, 'square'); }
            playJump() { this.createTone(440, 0.2, 'square'); }
            playShoot() { this.createTone(660, 0.15, 'square'); }
            playExplosion() { this.createTone(110, 0.4, 'sawtooth'); }
            playPickup() { this.createTone(880, 0.2, 'triangle'); }
            playLineClear() { 
                const notes = [523, 659, 784, 1047];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createTone(freq, 0.2), i * 100);
                });
            }
            playGameOver() {
                const notes = [440, 415, 392, 370, 349, 330, 311, 294];
                notes.forEach((freq, i) => {
                    setTimeout(() => this.createTone(freq, 0.3), i * 150);
                });
            }
        }
        
        const soundSystem = new ChiptuneSystem();
        
        const games = [
            { id: 'tetris', title: '–¢–ï–¢–†–ò–°', icon: 'üß©', genre: '–ì–û–õ–û–í–û–õ–û–ú–ö–ê', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ —Å –ø–∞–¥–∞—é—â–∏–º–∏ –±–ª–æ–∫–∞–º–∏! –°–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ —Ç–µ—Ç—Ä–æ–º–∏–Ω–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ª–∏–Ω–∏–π.' },
            { id: 'pong', title: '–ü–û–ù–ì', icon: 'üèì', genre: '–°–ü–û–†–¢', description: '–ü–µ—Ä–≤–∞—è –≤–∏–¥–µ–æ–∏–≥—Ä–∞! –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ç–µ–Ω–Ω–∏—Å —Å –¥–≤—É–º—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏.' },
            { id: 'invaders', title: '–ó–ê–•–í–ê–¢–ß–ò–ö–ò', icon: 'üëæ', genre: '–®–£–¢–ï–†', description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π Space Invaders! –£–Ω–∏—á—Ç–æ–∂–∞–π—Ç–µ —Ä—è–¥—ã —Å–ø—É—Å–∫–∞—é—â–∏—Ö—Å—è –ø—Ä–∏—à–µ–ª—å—Ü–µ–≤.' },
            { id: 'snake', title: '–ó–ú–ï–ô–ö–ê', icon: 'üêç', genre: '–ê–†–ö–ê–î–ê', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∑–º–µ–π–∫–∞! –ï—à—å—Ç–µ –µ–¥—É –∏ —Ä–∞—Å—Ç–∏—Ç–µ, –∏–∑–±–µ–≥–∞—è —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π.' },
            { id: 'breakout', title: '–ê–†–ö–ê–ù–û–ò–î', icon: 'üß±', genre: '–ê–†–ö–ê–î–ê', description: '–†–∞–∑–±–∏–≤–∞–π—Ç–µ –±–ª–æ–∫–∏ –º—è—á–æ–º! –ù–µ –¥–∞–π—Ç–µ –º—è—á—É —É–ø–∞—Å—Ç—å.' },
            { id: 'pacman', title: '–ü–ê–ö–ú–ê–ù', icon: 'üü°', genre: '–õ–ê–ë–ò–†–ò–ù–¢', description: '–°—ä–µ–¥–∞–π—Ç–µ —Ç–æ—á–∫–∏ –≤ –ª–∞–±–∏—Ä–∏–Ω—Ç–µ, –∏–∑–±–µ–≥–∞—è –ø—Ä–∏–∑—Ä–∞–∫–æ–≤!' },
            { id: 'asteroids', title: '–ê–°–¢–ï–†–û–ò–î–´', icon: 'üåå', genre: '–®–£–¢–ï–†', description: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —à—É—Ç–µ—Ä! –£–Ω–∏—á—Ç–æ–∂–∞–π—Ç–µ –∞—Å—Ç–µ—Ä–æ–∏–¥—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –∫–æ—Å–º–æ—Å–µ.' },
            { id: 'frogger', title: '–õ–Ø–ì–£–®–ö–ê', icon: 'üê∏', genre: '–ê–†–ö–ê–î–ê', description: '–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –¥–æ—Ä–æ–≥—É –∏ —Ä–µ–∫—É, –∏–∑–±–µ–≥–∞—è –æ–ø–∞—Å–Ω–æ—Å—Ç–µ–π!' },
            { id: 'missile', title: '–†–ê–ö–ï–¢–ù–ê–Ø –ö–û–ú–ê–ù–î–ê', icon: 'üöÄ', genre: '–ó–ê–©–ò–¢–ê', description: '–ó–∞—â–∏—â–∞–π—Ç–µ –≥–æ—Ä–æ–¥–∞ –æ—Ç —Ä–∞–∫–µ—Ç–Ω–æ–≥–æ —É–¥–∞—Ä–∞!' },
            { id: 'centipede', title: '–°–û–†–û–ö–û–ù–û–ñ–ö–ê', icon: 'üêõ', genre: '–®–£–¢–ï–†', description: '–°—Ç—Ä–µ–ª—è–π—Ç–µ –ø–æ —Å–æ—Ä–æ–∫–æ–Ω–æ–∂–∫–µ —á–µ—Ä–µ–∑ –ø–æ–ª–µ –≥—Ä–∏–±–æ–≤!' },
            { id: 'donkey', title: '–ì–û–†–ò–õ–õ–ê –ö–ò–ù–ì', icon: 'ü¶ç', genre: '–ü–õ–ê–¢–§–û–†–ú–ï–†', description: '–ü–æ–¥–Ω–∏–º–∞–π—Ç–µ—Å—å –ø–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∏–∑–±–µ–≥–∞—è –±–æ—á–µ–∫!' },
            { id: 'defender', title: '–ó–ê–©–ò–¢–ù–ò–ö', icon: 'üõ°Ô∏è', genre: '–®–£–¢–ï–†', description: '–ó–∞—â–∏—â–∞–π—Ç–µ –ø–ª–∞–Ω–µ—Ç—É –æ—Ç –∑–∞—Ö–≤–∞—Ç—á–∏–∫–æ–≤!' },
            { id: 'burger', title: '–í–†–ï–ú–Ø –ë–£–†–ì–ï–†–û–í', icon: 'üçî', genre: '–ü–õ–ê–¢–§–û–†–ú–ï–†', description: '–ì–æ—Ç–æ–≤—å—Ç–µ –±—É—Ä–≥–µ—Ä—ã, —Å–±–∏–≤–∞—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã!' },
            { id: 'digdug', title: '–ö–û–ü–ê–¢–ï–õ–¨', icon: '‚õèÔ∏è', genre: '–≠–ö–®–ï–ù', description: '–ö–æ–ø–∞–π—Ç–µ —Ç—É–Ω–Ω–µ–ª–∏ –∏ –ø–æ–±–µ–∂–¥–∞–π—Ç–µ –≤—Ä–∞–≥–æ–≤!' },
            { id: 'popeye', title: '–ú–û–†–Ø–ö –ü–û–ü–ê–ô', icon: 'üö¢', genre: '–ü–õ–ê–¢–§–û–†–ú–ï–†', description: '–°–æ–±–∏—Ä–∞–π—Ç–µ —Å–µ—Ä–¥–µ—á–∫–∏ –¥–ª—è –û–ª–∏–≤!' },
            { id: 'loderunner', title: '–ó–û–õ–û–¢–û–ò–°–ö–ê–¢–ï–õ–¨', icon: 'üíé', genre: '–ì–û–õ–û–í–û–õ–û–ú–ö–ê', description: '–°–æ–±–∏—Ä–∞–π—Ç–µ –∑–æ–ª–æ—Ç–æ, –∏–∑–±–µ–≥–∞—è –æ—Ö—Ä–∞–Ω–Ω–∏–∫–æ–≤!' },
            { id: 'paperboy', title: '–†–ê–ó–ù–û–°–ß–ò–ö –ì–ê–ó–ï–¢', icon: 'üì∞', genre: '–≠–ö–®–ï–ù', description: '–î–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –≥–∞–∑–µ—Ç—ã –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ!' },
            { id: 'joust', title: '–†–´–¶–ê–†–°–ö–ò–ô –¢–£–†–ù–ò–†', icon: 'üèá', genre: '–≠–ö–®–ï–ù', description: '–°—Ä–∞–∂–∞–π—Ç–µ—Å—å –Ω–∞ –ª–µ—Ç–∞—é—â–∏—Ö —Å—Ç—Ä–∞—É—Å–∞—Ö!' },
            { id: 'tempest', title: '–ë–£–†–Ø', icon: 'üåÄ', genre: '–®–£–¢–ï–†', description: '–°—Ç—Ä–µ–ª—è–π—Ç–µ –ø–æ –≤—Ä–∞–≥–∞–º –≤ —Ç—É–Ω–Ω–µ–ª–µ!' },
            { id: 'spy', title: '–°–£–ü–ï–† –®–ü–ò–û–ù', icon: 'üïµÔ∏è', genre: '–≠–ö–®–ï–ù', description: '–ü—Ä–æ–Ω–∏–∫–Ω–∏—Ç–µ –≤ —Å–µ–∫—Ä–µ—Ç–Ω—É—é –±–∞–∑—É!' },
            { id: 'miner', title: '–®–ê–•–¢–ï–†', icon: '‚õèÔ∏è', genre: '–°–¢–†–ê–¢–ï–ì–ò–Ø', description: '–ö–æ–ø–∞–π—Ç–µ —à–∞—Ö—Ç—ã –∏ —Å–æ–±–∏—Ä–∞–π—Ç–µ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏!' },
            { id: 'wizard', title: '–í–û–õ–®–ï–ë–ù–ò–ö', icon: 'üßô', genre: '–ü–†–ò–ö–õ–Æ–ß–ï–ù–ò–ï', description: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–≥–∏—é –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫!' },
            { id: 'robot', title: '–†–û–ë–û–¢-–°–ü–ê–°–ê–¢–ï–õ–¨', icon: 'ü§ñ', genre: '–≠–ö–®–ï–ù', description: '–°–ø–∞—Å–∞–π—Ç–µ –ª—é–¥–µ–π –∏–∑ –≥–æ—Ä—è—â–∏—Ö –∑–¥–∞–Ω–∏–π!' },
            { id: 'atlantis', title: '–ê–¢–õ–ê–ù–¢–ò–î–ê', icon: 'üèõÔ∏è', genre: '–ó–ê–©–ò–¢–ê', description: '–ó–∞—â–∏—â–∞–π—Ç–µ –ê—Ç–ª–∞–Ω—Ç–∏–¥—É –æ—Ç –∞—Ç–∞–∫!' },
            { id: 'moonlander', title: '–õ–£–ù–ù–´–ô –ü–û–°–ê–î–û–ß–ù–´–ô', icon: 'üöÄ', genre: '–°–ò–ú–£–õ–Ø–¢–û–†', description: '–ü—Ä–∏–∑–µ–º–ª–∏—Ç–µ—Å—å –Ω–∞ –õ—É–Ω—É!' },
            { id: 'knight', title: '–†–´–¶–ê–†–¨', icon: '‚öîÔ∏è', genre: '–ü–†–ò–ö–õ–Æ–ß–ï–ù–ò–ï', description: '–°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è —Ä—ã—Ü–∞—Ä—è!' },
            { id: 'submarine', title: '–ü–û–î–í–û–î–ù–ê–Ø –õ–û–î–ö–ê', icon: 'üö§', genre: '–≠–ö–®–ï–ù', description: '–ü–æ–¥–≤–æ–¥–Ω—ã–µ —Å—Ä–∞–∂–µ–Ω–∏—è!' },
            { id: 'pinball', title: '–ü–ò–ù–ë–û–õ', icon: 'üîÆ', genre: '–ê–†–ö–ê–î–ê', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–∏–Ω–±–æ–ª!' },
            { id: 'maze', title: '–õ–ê–ë–ò–†–ò–ù–¢ 3D', icon: 'üóùÔ∏è', genre: '–ì–û–õ–û–í–û–õ–û–ú–ö–ê', description: '–ù–∞–π–¥–∏—Ç–µ –≤—ã—Ö–æ–¥ –∏–∑ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞!' },
            { id: 'racing', title: '–°–£–ü–ï–† –ì–û–ù–©–ò–ö', icon: 'üèéÔ∏è', genre: '–ì–û–ù–ö–ò', description: '–í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ –≥–æ–Ω–∫–∏!' }
        ];
        
        let currentGame = null;
        let activeGameInstance = null;
        let gameRunning = false;
        let keys = {};
        
        function getKey(action) {
            if (gameSettings.controls === 'wasd') {
                const wasdMap = {
                    'ArrowUp': 'KeyW',
                    'ArrowDown': 'KeyS',
                    'ArrowLeft': 'KeyA',
                    'ArrowRight': 'KeyD'
                };
                return wasdMap[action] || action;
            }
            return action;
        }
        
        class BaseGame {
            constructor() {
                this.score = 0;
                this.lives = 3;
                this.level = 1;
                this.running = false;
                this.paused = false;
                this.speedMultiplier = 1;
            }
            
            init() {
                this.score = 0;
                this.lives = 3;
                this.level = 1;
                this.speedMultiplier = gameSettings.speed === 'fast' ? 1.5 : gameSettings.speed === 'slow' ? 0.7 : 1;
                this.updateUI();
                this.setupGame();
            }
            
            setupGame() {}
            
            start() {
                this.running = true;
                this.paused = false;
                this.gameLoop();
            }
            
            stop() {
                this.running = false;
            }
            
            pause() {
                this.paused = !this.paused;
            }
            
            gameLoop() {
                if (!this.running) return;
                
                if (!this.paused) {
                    this.update();
                    this.draw();
                }
                
                requestAnimationFrame(() => this.gameLoop());
            }
            
            update() {}
            draw() {}
            
            updateUI() {
                document.getElementById('scoreDisplay').textContent = `–°–ß–Å–¢: ${this.score.toString().padStart(6, '0')}`;
                document.getElementById('livesDisplay').textContent = `–ñ–ò–ó–ù–ò: ${this.lives}`;
            }
            
            gameOver() {
                this.running = false;
                soundSystem.playGameOver();
                showOverlay('–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê', `–§–ò–ù–ê–õ–¨–ù–´–ô –°–ß–Å–¢: ${this.score}`);
            }
        }

        // –¢–ï–¢–†–ò–°
        class TetrisGame extends BaseGame {
            constructor() {
                super();
                this.BOARD_WIDTH = 10;
                this.BOARD_HEIGHT = 20;
                this.CELL_SIZE = 24;
                this.board = [];
                this.currentPiece = null;
                this.fallTime = 0;
                this.fallSpeed = 500;
                this.lines = 0;
                
                this.tetrominoes = {
                    I: { shape: [[1,1,1,1]], color: '#00FFFF' },
                    O: { shape: [[1,1],[1,1]], color: '#FFFF00' },
                    T: { shape: [[0,1,0],[1,1,1]], color: '#AA00FF' },
                    S: { shape: [[0,1,1],[1,1,0]], color: '#00FF00' },
                    Z: { shape: [[1,1,0],[0,1,1]], color: '#FF0000' },
                    J: { shape: [[1,0,0],[1,1,1]], color: '#0000FF' },
                    L: { shape: [[0,0,1],[1,1,1]], color: '#FF7F00' }
                };
            }
            
            setupGame() {
                this.board = Array(this.BOARD_HEIGHT).fill(null).map(() => Array(this.BOARD_WIDTH).fill(0));
                this.spawnPiece();
                this.fallTime = 0;
                this.lines = 0;
            }
            
            spawnPiece() {
                const pieces = Object.keys(this.tetrominoes);
                const randomPiece = pieces[Math.floor(Math.random() * pieces.length)];
                const tetromino = this.tetrominoes[randomPiece];
                
                this.currentPiece = {
                    shape: tetromino.shape,
                    color: tetromino.color,
                    x: Math.floor(this.BOARD_WIDTH / 2) - Math.floor(tetromino.shape[0].length / 2),
                    y: 0
                };
                
                if (this.checkCollision()) {
                    this.gameOver();
                }
            }
            
            checkCollision(offsetX = 0, offsetY = 0, shape = this.currentPiece.shape) {
                for (let y = 0; y < shape.length; y++) {
                    for (let x = 0; x < shape[y].length; x++) {
                        if (shape[y][x]) {
                            const newX = this.currentPiece.x + x + offsetX;
                            const newY = this.currentPiece.y + y + offsetY;
                            
                            if (newX < 0 || newX >= this.BOARD_WIDTH || 
                                newY >= this.BOARD_HEIGHT ||
                                (newY >= 0 && this.board[newY][newX])) {
                                return true;
                            }
                        }
                    }
                }
                return false;
            }
            
            rotatePiece() {
                const rotated = this.currentPiece.shape[0].map((_, i) => 
                    this.currentPiece.shape.map(row => row[i]).reverse()
                );
                
                if (!this.checkCollision(0, 0, rotated)) {
                    this.currentPiece.shape = rotated;
                    soundSystem.playMove();
                }
            }
            
            movePiece(dx, dy) {
                if (!this.checkCollision(dx, dy)) {
                    this.currentPiece.x += dx;
                    this.currentPiece.y += dy;
                    if (dx !== 0) soundSystem.playMove();
                    return true;
                }
                return false;
            }
            
            lockPiece() {
                for (let y = 0; y < this.currentPiece.shape.length; y++) {
                    for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                        if (this.currentPiece.shape[y][x]) {
                            const boardY = this.currentPiece.y + y;
                            const boardX = this.currentPiece.x + x;
                            if (boardY >= 0) {
                                this.board[boardY][boardX] = this.currentPiece.color;
                            }
                        }
                    }
                }
                
                this.clearLines();
                this.spawnPiece();
            }
            
            clearLines() {
                let linesCleared = 0;
                
                for (let y = this.BOARD_HEIGHT - 1; y >= 0; y--) {
                    if (this.board[y].every(cell => cell !== 0)) {
                        this.board.splice(y, 1);
                        this.board.unshift(Array(this.BOARD_WIDTH).fill(0));
                        linesCleared++;
                        y++;
                    }
                }
                
                if (linesCleared > 0) {
                    this.lines += linesCleared;
                    this.score += [0, 40, 100, 300, 1200][linesCleared] * (this.level + 1);
                    this.level = Math.floor(this.lines / 10) + 1;
                    this.fallSpeed = Math.max(50, 500 - (this.level - 1) * 50);
                    soundSystem.playLineClear();
                }
            }
            
            update() {
                this.fallTime += 16;
                
                if (this.fallTime >= this.fallSpeed / this.speedMultiplier) {
                    if (!this.movePiece(0, 1)) {
                        this.lockPiece();
                    }
                    this.fallTime = 0;
                }
                
                if (keys[getKey('ArrowLeft')]) {
                    this.movePiece(-1, 0);
                    keys[getKey('ArrowLeft')] = false;
                }
                if (keys[getKey('ArrowRight')]) {
                    this.movePiece(1, 0);
                    keys[getKey('ArrowRight')] = false;
                }
                if (keys[getKey('ArrowDown')]) {
                    if (this.movePiece(0, 1)) {
                        this.score += 1;
                    }
                }
                if (keys[getKey('Space')]) {
                    this.rotatePiece();
                    keys[getKey('Space')] = false;
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                const offsetX = (canvas.width - this.BOARD_WIDTH * this.CELL_SIZE) / 2;
                const offsetY = (canvas.height - this.BOARD_HEIGHT * this.CELL_SIZE) / 2;
                
                ctx.save();
                ctx.translate(offsetX, offsetY);
                
                // –°–µ—Ç–∫–∞
                ctx.strokeStyle = '#333333';
                ctx.lineWidth = 1;
                for (let x = 0; x <= this.BOARD_WIDTH; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * this.CELL_SIZE, 0);
                    ctx.lineTo(x * this.CELL_SIZE, this.BOARD_HEIGHT * this.CELL_SIZE);
                    ctx.stroke();
                }
                for (let y = 0; y <= this.BOARD_HEIGHT; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * this.CELL_SIZE);
                    ctx.lineTo(this.BOARD_WIDTH * this.CELL_SIZE, y * this.CELL_SIZE);
                    ctx.stroke();
                }
                
                // –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏
                for (let y = 0; y < this.BOARD_HEIGHT; y++) {
                    for (let x = 0; x < this.BOARD_WIDTH; x++) {
                        if (this.board[y][x]) {
                            this.drawBlock(x, y, this.board[y][x]);
                        }
                    }
                }
                
                // –¢–µ–∫—É—â–∏–π –±–ª–æ–∫
                if (this.currentPiece) {
                    for (let y = 0; y < this.currentPiece.shape.length; y++) {
                        for (let x = 0; x < this.currentPiece.shape[y].length; x++) {
                            if (this.currentPiece.shape[y][x]) {
                                this.drawBlock(
                                    this.currentPiece.x + x,
                                    this.currentPiece.y + y,
                                    this.currentPiece.color
                                );
                            }
                        }
                    }
                }
                
                ctx.restore();
            }
            
            drawBlock(x, y, color) {
                ctx.fillStyle = color;
                ctx.fillRect(x * this.CELL_SIZE + 1, y * this.CELL_SIZE + 1, 
                            this.CELL_SIZE - 2, this.CELL_SIZE - 2);
            }
        }

        // –ü–û–ù–ì
        class PongGame extends BaseGame {
            constructor() {
                super();
                this.paddle1 = { x: 30, y: canvas.height / 2 - 40, width: 10, height: 80 };
                this.paddle2 = { x: canvas.width - 40, y: canvas.height / 2 - 40, width: 10, height: 80 };
                this.ball = { x: canvas.width / 2, y: canvas.height / 2, vx: 4, vy: 3, size: 8 };
                this.aiSpeed = 3;
            }
            
            setupGame() {
                this.ball.x = canvas.width / 2;
                this.ball.y = canvas.height / 2;
                this.ball.vx = (Math.random() > 0.5 ? 1 : -1) * 4;
                this.ball.vy = (Math.random() - 0.5) * 6;
                this.paddle1.y = canvas.height / 2 - 40;
                this.paddle2.y = canvas.height / 2 - 40;
            }
            
            update() {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º
                if (keys[getKey('ArrowUp')] && this.paddle1.y > 0) {
                    this.paddle1.y -= 5 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowDown')] && this.paddle1.y < canvas.height - this.paddle1.height) {
                    this.paddle1.y += 5 * this.speedMultiplier;
                }
                
                // AI
                const ballCenter = this.ball.y;
                const paddleCenter = this.paddle2.y + this.paddle2.height / 2;
                
                if (ballCenter < paddleCenter - 10) {
                    this.paddle2.y -= this.aiSpeed * this.speedMultiplier;
                } else if (ballCenter > paddleCenter + 10) {
                    this.paddle2.y += this.aiSpeed * this.speedMultiplier;
                }
                
                this.paddle2.y = Math.max(0, Math.min(canvas.height - this.paddle2.height, this.paddle2.y));
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –º—è—á–∞
                this.ball.x += this.ball.vx * this.speedMultiplier;
                this.ball.y += this.ball.vy * this.speedMultiplier;
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç –∫—Ä–∞–µ–≤
                if (this.ball.y <= this.ball.size || this.ball.y >= canvas.height - this.ball.size) {
                    this.ball.vy = -this.ball.vy;
                    soundSystem.playMove();
                }
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Ä–∞–∫–µ—Ç–∫–∞–º–∏
                if (this.ball.x <= this.paddle1.x + this.paddle1.width &&
                    this.ball.y >= this.paddle1.y &&
                    this.ball.y <= this.paddle1.y + this.paddle1.height) {
                    this.ball.vx = Math.abs(this.ball.vx);
                    soundSystem.playJump();
                }
                
                if (this.ball.x >= this.paddle2.x &&
                    this.ball.y >= this.paddle2.y &&
                    this.ball.y <= this.paddle2.y + this.paddle2.height) {
                    this.ball.vx = -Math.abs(this.ball.vx);
                    soundSystem.playJump();
                }
                
                // –û—á–∫–∏
                if (this.ball.x < 0) {
                    this.score += 10;
                    this.setupGame();
                    soundSystem.playPickup();
                }
                
                if (this.ball.x > canvas.width) {
                    this.lives--;
                    if (this.lives <= 0) {
                        this.gameOver();
                    } else {
                        this.setupGame();
                        soundSystem.playExplosion();
                    }
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
                ctx.strokeStyle = '#FFFFFF';
                ctx.setLineDash([10, 10]);
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2, 0);
                ctx.lineTo(canvas.width / 2, canvas.height);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // –†–∞–∫–µ—Ç–∫–∏
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(this.paddle1.x, this.paddle1.y, this.paddle1.width, this.paddle1.height);
                ctx.fillRect(this.paddle2.x, this.paddle2.y, this.paddle2.width, this.paddle2.height);
                
                // –ú—è—á
                ctx.fillRect(this.ball.x - this.ball.size / 2, this.ball.y - this.ball.size / 2, this.ball.size, this.ball.size);
            }
        }

        // –ó–ê–•–í–ê–¢–ß–ò–ö–ò
        class InvadersGame extends BaseGame {
            constructor() {
                super();
                this.ship = { x: canvas.width / 2, y: canvas.height - 60, width: 30, height: 20 };
                this.bullets = [];
                this.invaders = [];
                this.invaderBullets = [];
                this.direction = 1;
                this.dropDistance = 20;
                this.fireRate = 0;
            }
            
            setupGame() {
                this.ship.x = canvas.width / 2;
                this.bullets = [];
                this.invaderBullets = [];
                this.direction = 1;
                this.fireRate = 0;
                
                this.invaders = [];
                for (let row = 0; row < 5; row++) {
                    for (let col = 0; col < 10; col++) {
                        this.invaders.push({
                            x: 60 + col * 50,
                            y: 60 + row * 40,
                            width: 30,
                            height: 20,
                            type: row < 2 ? 'small' : 'large'
                        });
                    }
                }
            }
            
            update() {
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è
                if (keys[getKey('ArrowLeft')] && this.ship.x > 0) {
                    this.ship.x -= 4 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowRight')] && this.ship.x < canvas.width - this.ship.width) {
                    this.ship.x += 4 * this.speedMultiplier;
                }
                
                // –°—Ç—Ä–µ–ª—å–±–∞
                this.fireRate++;
                if (keys[getKey('Space')] && this.fireRate > 10 && this.bullets.length < 3) {
                    this.bullets.push({
                        x: this.ship.x + this.ship.width / 2,
                        y: this.ship.y,
                        width: 2,
                        height: 10
                    });
                    this.fireRate = 0;
                    soundSystem.playShoot();
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å
                this.bullets.forEach((bullet, index) => {
                    bullet.y -= 8 * this.speedMultiplier;
                    if (bullet.y < 0) {
                        this.bullets.splice(index, 1);
                    }
                });
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –∑–∞—Ö–≤–∞—Ç—á–∏–∫–æ–≤
                let shouldDrop = false;
                this.invaders.forEach(invader => {
                    if ((invader.x <= 0 && this.direction === -1) || 
                        (invader.x >= canvas.width - invader.width && this.direction === 1)) {
                        shouldDrop = true;
                    }
                });
                
                if (shouldDrop) {
                    this.direction = -this.direction;
                    this.invaders.forEach(invader => {
                        invader.y += this.dropDistance;
                    });
                }
                
                this.invaders.forEach(invader => {
                    invader.x += this.direction * this.speedMultiplier;
                });
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                this.bullets.forEach((bullet, bulletIndex) => {
                    this.invaders.forEach((invader, invaderIndex) => {
                        if (bullet.x < invader.x + invader.width &&
                            bullet.x + bullet.width > invader.x &&
                            bullet.y < invader.y + invader.height &&
                            bullet.y + bullet.height > invader.y) {
                            
                            this.bullets.splice(bulletIndex, 1);
                            this.invaders.splice(invaderIndex, 1);
                            this.score += invader.type === 'small' ? 30 : 10;
                            soundSystem.playExplosion();
                        }
                    });
                });
                
                // –°—Ç—Ä–µ–ª—å–±–∞ –∑–∞—Ö–≤–∞—Ç—á–∏–∫–æ–≤
                if (Math.random() < 0.001 && this.invaders.length > 0) {
                    const shooter = this.invaders[Math.floor(Math.random() * this.invaders.length)];
                    this.invaderBullets.push({
                        x: shooter.x + shooter.width / 2,
                        y: shooter.y + shooter.height,
                        width: 2,
                        height: 10
                    });
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å –∑–∞—Ö–≤–∞—Ç—á–∏–∫–æ–≤
                this.invaderBullets.forEach((bullet, index) => {
                    bullet.y += 3 * this.speedMultiplier;
                    if (bullet.y > canvas.height) {
                        this.invaderBullets.splice(index, 1);
                    }
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –∏–≥—Ä–æ–∫–æ–º
                    if (bullet.x < this.ship.x + this.ship.width &&
                        bullet.x + bullet.width > this.ship.x &&
                        bullet.y < this.ship.y + this.ship.height &&
                        bullet.y + bullet.height > this.ship.y) {
                        
                        this.invaderBullets.splice(index, 1);
                        this.lives--;
                        soundSystem.playExplosion();
                        
                        if (this.lives <= 0) {
                            this.gameOver();
                        }
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (this.invaders.length === 0) {
                    this.level++;
                    this.setupGame();
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
                this.invaders.forEach(invader => {
                    if (invader.y + invader.height >= this.ship.y) {
                        this.gameOver();
                    }
                });
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ö–æ—Ä–∞–±–ª—å
                ctx.fillStyle = '#00FF00';
                ctx.fillRect(this.ship.x, this.ship.y, this.ship.width, this.ship.height);
                
                // –ü—É–ª–∏ –∏–≥—Ä–æ–∫–∞
                ctx.fillStyle = '#FFFFFF';
                this.bullets.forEach(bullet => {
                    ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                });
                
                // –ó–∞—Ö–≤–∞—Ç—á–∏–∫–∏
                this.invaders.forEach(invader => {
                    ctx.fillStyle = invader.type === 'small' ? '#FF0000' : '#FFFF00';
                    ctx.fillRect(invader.x, invader.y, invader.width, invader.height);
                });
                
                // –ü—É–ª–∏ –∑–∞—Ö–≤–∞—Ç—á–∏–∫–æ–≤
                ctx.fillStyle = '#FF0000';
                this.invaderBullets.forEach(bullet => {
                    ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                });
            }
        }

        // –ó–ú–ï–ô–ö–ê
        class SnakeGame extends BaseGame {
            constructor() {
                super();
                this.gridSize = 20;
                this.snake = [{ x: 10, y: 10 }];
                this.direction = { x: 1, y: 0 };
                this.food = { x: 15, y: 15 };
                this.moveTimer = 0;
                this.moveInterval = 150;
            }
            
            setupGame() {
                this.snake = [{ x: 10, y: 10 }];
                this.direction = { x: 1, y: 0 };
                this.generateFood();
                this.moveTimer = 0;
            }
            
            generateFood() {
                const gridWidth = Math.floor(canvas.width / this.gridSize);
                const gridHeight = Math.floor(canvas.height / this.gridSize);
                
                do {
                    this.food = {
                        x: Math.floor(Math.random() * gridWidth),
                        y: Math.floor(Math.random() * gridHeight)
                    };
                } while (this.snake.some(segment => segment.x === this.food.x && segment.y === this.food.y));
            }
            
            update() {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                if (keys[getKey('ArrowUp')] && this.direction.y === 0) {
                    this.direction = { x: 0, y: -1 };
                    keys[getKey('ArrowUp')] = false;
                }
                if (keys[getKey('ArrowDown')] && this.direction.y === 0) {
                    this.direction = { x: 0, y: 1 };
                    keys[getKey('ArrowDown')] = false;
                }
                if (keys[getKey('ArrowLeft')] && this.direction.x === 0) {
                    this.direction = { x: -1, y: 0 };
                    keys[getKey('ArrowLeft')] = false;
                }
                if (keys[getKey('ArrowRight')] && this.direction.x === 0) {
                    this.direction = { x: 1, y: 0 };
                    keys[getKey('ArrowRight')] = false;
                }
                
                this.moveTimer += 16;
                if (this.moveTimer >= this.moveInterval / this.speedMultiplier) {
                    this.moveTimer = 0;
                    
                    // –ù–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è –≥–æ–ª–æ–≤—ã
                    const head = { ...this.snake[0] };
                    head.x += this.direction.x;
                    head.y += this.direction.y;
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
                    const gridWidth = Math.floor(canvas.width / this.gridSize);
                    const gridHeight = Math.floor(canvas.height / this.gridSize);
                    
                    if (head.x < 0 || head.x >= gridWidth || head.y < 0 || head.y >= gridHeight) {
                        this.gameOver();
                        return;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Å–æ–±–æ–π
                    if (this.snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                        this.gameOver();
                        return;
                    }
                    
                    this.snake.unshift(head);
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ–¥—ã
                    if (head.x === this.food.x && head.y === this.food.y) {
                        this.score += 10;
                        this.generateFood();
                        soundSystem.playPickup();
                    } else {
                        this.snake.pop();
                    }
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ó–º–µ–π–∫–∞
                ctx.fillStyle = '#00FF00';
                this.snake.forEach((segment, index) => {
                    ctx.fillStyle = index === 0 ? '#00FF00' : '#008800';
                    ctx.fillRect(segment.x * this.gridSize, segment.y * this.gridSize, 
                                this.gridSize - 2, this.gridSize - 2);
                });
                
                // –ï–¥–∞
                ctx.fillStyle = '#FF0000';
                ctx.fillRect(this.food.x * this.gridSize, this.food.y * this.gridSize, 
                            this.gridSize - 2, this.gridSize - 2);
                
                // –°–µ—Ç–∫–∞
                ctx.strokeStyle = '#333333';
                ctx.lineWidth = 1;
                const gridWidth = Math.floor(canvas.width / this.gridSize);
                const gridHeight = Math.floor(canvas.height / this.gridSize);
                
                for (let x = 0; x <= gridWidth; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * this.gridSize, 0);
                    ctx.lineTo(x * this.gridSize, canvas.height);
                    ctx.stroke();
                }
                
                for (let y = 0; y <= gridHeight; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * this.gridSize);
                    ctx.lineTo(canvas.width, y * this.gridSize);
                    ctx.stroke();
                }
            }
        }

        // –ê–†–ö–ê–ù–û–ò–î
        class BreakoutGame extends BaseGame {
            constructor() {
                super();
                this.paddle = { x: canvas.width / 2 - 50, y: canvas.height - 30, width: 100, height: 10 };
                this.ball = { x: canvas.width / 2, y: canvas.height / 2, vx: 4, vy: -4, radius: 8 };
                this.bricks = [];
                this.brickRows = 8;
                this.brickCols = 10;
                this.brickWidth = 60;
                this.brickHeight = 20;
            }
            
            setupGame() {
                this.paddle.x = canvas.width / 2 - 50;
                this.ball.x = canvas.width / 2;
                this.ball.y = canvas.height / 2;
                this.ball.vx = 4;
                this.ball.vy = -4;
                
                this.bricks = [];
                for (let row = 0; row < this.brickRows; row++) {
                    for (let col = 0; col < this.brickCols; col++) {
                        this.bricks.push({
                            x: col * (this.brickWidth + 2) + 20,
                            y: row * (this.brickHeight + 2) + 60,
                            width: this.brickWidth,
                            height: this.brickHeight,
                            color: `hsl(${row * 45}, 70%, 50%)`
                        });
                    }
                }
            }
            
            update() {
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
                if (keys[getKey('ArrowLeft')] && this.paddle.x > 0) {
                    this.paddle.x -= 6 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowRight')] && this.paddle.x < canvas.width - this.paddle.width) {
                    this.paddle.x += 6 * this.speedMultiplier;
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –º—è—á–∞
                this.ball.x += this.ball.vx * this.speedMultiplier;
                this.ball.y += this.ball.vy * this.speedMultiplier;
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç —Å—Ç–µ–Ω
                if (this.ball.x <= this.ball.radius || this.ball.x >= canvas.width - this.ball.radius) {
                    this.ball.vx = -this.ball.vx;
                    soundSystem.playMove();
                }
                
                if (this.ball.y <= this.ball.radius) {
                    this.ball.vy = -this.ball.vy;
                    soundSystem.playMove();
                }
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π
                if (this.ball.y + this.ball.radius >= this.paddle.y &&
                    this.ball.x >= this.paddle.x &&
                    this.ball.x <= this.paddle.x + this.paddle.width) {
                    
                    this.ball.vy = -Math.abs(this.ball.vy);
                    
                    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É–≥–ª–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ—á–∫–∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è
                    const hitPoint = (this.ball.x - this.paddle.x) / this.paddle.width;
                    this.ball.vx = (hitPoint - 0.5) * 8;
                    
                    soundSystem.playJump();
                }
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –±–ª–æ–∫–∞–º–∏
                this.bricks.forEach((brick, index) => {
                    if (this.ball.x + this.ball.radius >= brick.x &&
                        this.ball.x - this.ball.radius <= brick.x + brick.width &&
                        this.ball.y + this.ball.radius >= brick.y &&
                        this.ball.y - this.ball.radius <= brick.y + brick.height) {
                        
                        this.bricks.splice(index, 1);
                        this.ball.vy = -this.ball.vy;
                        this.score += 10;
                        soundSystem.playExplosion();
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
                if (this.ball.y > canvas.height) {
                    this.lives--;
                    if (this.lives <= 0) {
                        this.gameOver();
                    } else {
                        this.ball.x = canvas.width / 2;
                        this.ball.y = canvas.height / 2;
                        this.ball.vx = 4;
                        this.ball.vy = -4;
                        soundSystem.playExplosion();
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (this.bricks.length === 0) {
                    this.level++;
                    this.setupGame();
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(this.paddle.x, this.paddle.y, this.paddle.width, this.paddle.height);
                
                // –ú—è—á
                ctx.fillStyle = '#FFFFFF';
                ctx.beginPath();
                ctx.arc(this.ball.x, this.ball.y, this.ball.radius, 0, Math.PI * 2);
                ctx.fill();
                
                // –ë–ª–æ–∫–∏
                this.bricks.forEach(brick => {
                    ctx.fillStyle = brick.color;
                    ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
                    
                    // –ì—Ä–∞–Ω–∏—Ü–∞ –±–ª–æ–∫–∞
                    ctx.strokeStyle = '#000000';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(brick.x, brick.y, brick.width, brick.height);
                });
            }
        }

        // –ü–ê–ö–ú–ê–ù
        class PacmanGame extends BaseGame {
            constructor() {
                super();
                this.gridSize = 20;
                this.pacman = { x: 10, y: 10, direction: 0, mouth: 0 };
                this.ghosts = [];
                this.dots = [];
                this.maze = [];
                this.directions = [
                    { x: 1, y: 0 },  // –ø—Ä–∞–≤–æ
                    { x: 0, y: 1 },  // –≤–Ω–∏–∑
                    { x: -1, y: 0 }, // –ª–µ–≤–æ
                    { x: 0, y: -1 }  // –≤–≤–µ—Ä—Ö
                ];
                this.moveTimer = 0;
                this.moveInterval = 150;
                this.mouthTimer = 0;
            }
            
            setupGame() {
                this.pacman = { x: 10, y: 10, direction: 0, mouth: 0 };
                this.generateMaze();
                this.generateDots();
                this.generateGhosts();
                this.moveTimer = 0;
                this.mouthTimer = 0;
            }
            
            generateMaze() {
                const width = Math.floor(canvas.width / this.gridSize);
                const height = Math.floor(canvas.height / this.gridSize);
                
                this.maze = Array(height).fill(null).map(() => Array(width).fill(0));
                
                // –ü—Ä–æ—Å—Ç–æ–π –ª–∞–±–∏—Ä–∏–Ω—Ç
                for (let y = 0; y < height; y++) {
                    for (let x = 0; x < width; x++) {
                        if (x === 0 || x === width - 1 || y === 0 || y === height - 1) {
                            this.maze[y][x] = 1;
                        } else if (x % 4 === 0 && y % 4 === 0) {
                            this.maze[y][x] = 1;
                        }
                    }
                }
            }
            
            generateDots() {
                this.dots = [];
                for (let y = 0; y < this.maze.length; y++) {
                    for (let x = 0; x < this.maze[y].length; x++) {
                        if (this.maze[y][x] === 0 && Math.random() < 0.3) {
                            this.dots.push({ x, y });
                        }
                    }
                }
            }
            
            generateGhosts() {
                this.ghosts = [];
                const colors = ['#FF0000', '#FFB8FF', '#FFB847', '#00FFFF'];
                
                for (let i = 0; i < 4; i++) {
                    let x, y;
                    do {
                        x = Math.floor(Math.random() * this.maze[0].length);
                        y = Math.floor(Math.random() * this.maze.length);
                    } while (this.maze[y][x] === 1);
                    
                    this.ghosts.push({
                        x, y,
                        color: colors[i],
                        direction: Math.floor(Math.random() * 4)
                    });
                }
            }
            
            update() {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                if (keys[getKey('ArrowUp')]) {
                    this.pacman.direction = 3;
                    keys[getKey('ArrowUp')] = false;
                }
                if (keys[getKey('ArrowDown')]) {
                    this.pacman.direction = 1;
                    keys[getKey('ArrowDown')] = false;
                }
                if (keys[getKey('ArrowLeft')]) {
                    this.pacman.direction = 2;
                    keys[getKey('ArrowLeft')] = false;
                }
                if (keys[getKey('ArrowRight')]) {
                    this.pacman.direction = 0;
                    keys[getKey('ArrowRight')] = false;
                }
                
                this.moveTimer += 16;
                this.mouthTimer += 16;
                
                if (this.mouthTimer >= 200) {
                    this.pacman.mouth = (this.pacman.mouth + 1) % 4;
                    this.mouthTimer = 0;
                }
                
                if (this.moveTimer >= this.moveInterval / this.speedMultiplier) {
                    this.moveTimer = 0;
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –ü–∞–∫–º–∞–Ω–∞
                    const dir = this.directions[this.pacman.direction];
                    const newX = this.pacman.x + dir.x;
                    const newY = this.pacman.y + dir.y;
                    
                    if (newX >= 0 && newX < this.maze[0].length && 
                        newY >= 0 && newY < this.maze.length &&
                        this.maze[newY][newX] === 0) {
                        
                        this.pacman.x = newX;
                        this.pacman.y = newY;
                        soundSystem.playMove();
                    }
                    
                    // –ü–æ–µ–¥–∞–Ω–∏–µ —Ç–æ—á–µ–∫
                    this.dots.forEach((dot, index) => {
                        if (dot.x === this.pacman.x && dot.y === this.pacman.y) {
                            this.dots.splice(index, 1);
                            this.score += 10;
                            soundSystem.playPickup();
                        }
                    });
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤
                    this.ghosts.forEach(ghost => {
                        if (Math.random() < 0.3) {
                            ghost.direction = Math.floor(Math.random() * 4);
                        }
                        
                        const ghostDir = this.directions[ghost.direction];
                        const newGhostX = ghost.x + ghostDir.x;
                        const newGhostY = ghost.y + ghostDir.y;
                        
                        if (newGhostX >= 0 && newGhostX < this.maze[0].length && 
                            newGhostY >= 0 && newGhostY < this.maze.length &&
                            this.maze[newGhostY][newGhostX] === 0) {
                            
                            ghost.x = newGhostX;
                            ghost.y = newGhostY;
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø—Ä–∏–∑—Ä–∞–∫–∞–º–∏
                    this.ghosts.forEach(ghost => {
                        if (ghost.x === this.pacman.x && ghost.y === this.pacman.y) {
                            this.lives--;
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                this.pacman.x = 10;
                                this.pacman.y = 10;
                                soundSystem.playExplosion();
                            }
                        }
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                    if (this.dots.length === 0) {
                        this.level++;
                        this.setupGame();
                    }
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –õ–∞–±–∏—Ä–∏–Ω—Ç
                ctx.fillStyle = '#0000FF';
                for (let y = 0; y < this.maze.length; y++) {
                    for (let x = 0; x < this.maze[y].length; x++) {
                        if (this.maze[y][x] === 1) {
                            ctx.fillRect(x * this.gridSize, y * this.gridSize, 
                                        this.gridSize, this.gridSize);
                        }
                    }
                }
                
                // –¢–æ—á–∫–∏
                ctx.fillStyle = '#FFFF00';
                this.dots.forEach(dot => {
                    ctx.beginPath();
                    ctx.arc(dot.x * this.gridSize + this.gridSize / 2, 
                           dot.y * this.gridSize + this.gridSize / 2, 3, 0, Math.PI * 2);
                    ctx.fill();
                });
                
                // –ü—Ä–∏–∑—Ä–∞–∫–∏
                this.ghosts.forEach(ghost => {
                    ctx.fillStyle = ghost.color;
                    ctx.fillRect(ghost.x * this.gridSize + 2, ghost.y * this.gridSize + 2, 
                                this.gridSize - 4, this.gridSize - 4);
                });
                
                // –ü–∞–∫–º–∞–Ω
                ctx.fillStyle = '#FFFF00';
                const pacX = this.pacman.x * this.gridSize + this.gridSize / 2;
                const pacY = this.pacman.y * this.gridSize + this.gridSize / 2;
                const radius = this.gridSize / 2 - 2;
                
                ctx.beginPath();
                if (this.pacman.mouth < 2) {
                    ctx.arc(pacX, pacY, radius, 0, Math.PI * 2);
                } else {
                    const angle = this.pacman.direction * Math.PI / 2;
                    ctx.arc(pacX, pacY, radius, angle + 0.3, angle - 0.3);
                    ctx.lineTo(pacX, pacY);
                }
                ctx.fill();
            }
        }

        // –ê–°–¢–ï–†–û–ò–î–´
        class AsteroidsGame extends BaseGame {
            constructor() {
                super();
                this.ship = { 
                    x: canvas.width / 2, 
                    y: canvas.height / 2, 
                    angle: 0, 
                    vx: 0, 
                    vy: 0, 
                    thrust: false 
                };
                this.bullets = [];
                this.asteroids = [];
                this.fireRate = 0;
            }
            
            setupGame() {
                this.ship.x = canvas.width / 2;
                this.ship.y = canvas.height / 2;
                this.ship.angle = 0;
                this.ship.vx = 0;
                this.ship.vy = 0;
                this.ship.thrust = false;
                this.bullets = [];
                this.fireRate = 0;
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤
                this.asteroids = [];
                for (let i = 0; i < 5 + this.level; i++) {
                    let x, y;
                    do {
                        x = Math.random() * canvas.width;
                        y = Math.random() * canvas.height;
                    } while (Math.hypot(x - this.ship.x, y - this.ship.y) < 100);
                    
                    this.asteroids.push({
                        x, y,
                        vx: (Math.random() - 0.5) * 2,
                        vy: (Math.random() - 0.5) * 2,
                        size: 40,
                        angle: Math.random() * Math.PI * 2
                    });
                }
            }
            
            update() {
                this.fireRate++;
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–º
                if (keys[getKey('ArrowLeft')]) {
                    this.ship.angle -= 0.1 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowRight')]) {
                    this.ship.angle += 0.1 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowUp')]) {
                    this.ship.thrust = true;
                    this.ship.vx += Math.cos(this.ship.angle) * 0.2 * this.speedMultiplier;
                    this.ship.vy += Math.sin(this.ship.angle) * 0.2 * this.speedMultiplier;
                } else {
                    this.ship.thrust = false;
                }
                
                // –°—Ç—Ä–µ–ª—å–±–∞
                if (keys[getKey('Space')] && this.fireRate > 10) {
                    this.bullets.push({
                        x: this.ship.x,
                        y: this.ship.y,
                        vx: Math.cos(this.ship.angle) * 5,
                        vy: Math.sin(this.ship.angle) * 5,
                        life: 60
                    });
                    this.fireRate = 0;
                    soundSystem.playShoot();
                }
                
                // –¢—Ä–µ–Ω–∏–µ
                this.ship.vx *= 0.99;
                this.ship.vy *= 0.99;
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è
                this.ship.x += this.ship.vx * this.speedMultiplier;
                this.ship.y += this.ship.vy * this.speedMultiplier;
                
                // –û–±–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
                if (this.ship.x < 0) this.ship.x = canvas.width;
                if (this.ship.x > canvas.width) this.ship.x = 0;
                if (this.ship.y < 0) this.ship.y = canvas.height;
                if (this.ship.y > canvas.height) this.ship.y = 0;
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å
                this.bullets.forEach((bullet, index) => {
                    bullet.x += bullet.vx * this.speedMultiplier;
                    bullet.y += bullet.vy * this.speedMultiplier;
                    bullet.life--;
                    
                    if (bullet.life <= 0 || bullet.x < 0 || bullet.x > canvas.width || 
                        bullet.y < 0 || bullet.y > canvas.height) {
                        this.bullets.splice(index, 1);
                    }
                });
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤
                this.asteroids.forEach(asteroid => {
                    asteroid.x += asteroid.vx * this.speedMultiplier;
                    asteroid.y += asteroid.vy * this.speedMultiplier;
                    asteroid.angle += 0.02 * this.speedMultiplier;
                    
                    // –û–±–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
                    if (asteroid.x < 0) asteroid.x = canvas.width;
                    if (asteroid.x > canvas.width) asteroid.x = 0;
                    if (asteroid.y < 0) asteroid.y = canvas.height;
                    if (asteroid.y > canvas.height) asteroid.y = 0;
                });
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –ø—É–ª—å —Å –∞—Å—Ç–µ—Ä–æ–∏–¥–∞–º–∏
                this.bullets.forEach((bullet, bulletIndex) => {
                    this.asteroids.forEach((asteroid, asteroidIndex) => {
                        if (Math.hypot(bullet.x - asteroid.x, bullet.y - asteroid.y) < asteroid.size) {
                            this.bullets.splice(bulletIndex, 1);
                            const destroyedAsteroid = this.asteroids.splice(asteroidIndex, 1)[0];
                            
                            this.score += 100;
                            soundSystem.playExplosion();
                            
                            // –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
                            if (destroyedAsteroid.size > 15) {
                                for (let i = 0; i < 2; i++) {
                                    this.asteroids.push({
                                        x: destroyedAsteroid.x,
                                        y: destroyedAsteroid.y,
                                        vx: (Math.random() - 0.5) * 3,
                                        vy: (Math.random() - 0.5) * 3,
                                        size: destroyedAsteroid.size / 2,
                                        angle: Math.random() * Math.PI * 2
                                    });
                                }
                            }
                        }
                    });
                });
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –∫–æ—Ä–∞–±–ª—è —Å –∞—Å—Ç–µ—Ä–æ–∏–¥–∞–º–∏
                this.asteroids.forEach(asteroid => {
                    if (Math.hypot(this.ship.x - asteroid.x, this.ship.y - asteroid.y) < asteroid.size) {
                        this.lives--;
                        if (this.lives <= 0) {
                            this.gameOver();
                        } else {
                            this.ship.x = canvas.width / 2;
                            this.ship.y = canvas.height / 2;
                            this.ship.vx = 0;
                            this.ship.vy = 0;
                            soundSystem.playExplosion();
                        }
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (this.asteroids.length === 0) {
                    this.level++;
                    this.setupGame();
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ö–æ—Ä–∞–±–ª—å
                ctx.save();
                ctx.translate(this.ship.x, this.ship.y);
                ctx.rotate(this.ship.angle);
                
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(10, 0);
                ctx.lineTo(-10, -8);
                ctx.lineTo(-6, 0);
                ctx.lineTo(-10, 8);
                ctx.closePath();
                ctx.stroke();
                
                // –¢—è–≥–∞
                if (this.ship.thrust) {
                    ctx.strokeStyle = '#FF0000';
                    ctx.beginPath();
                    ctx.moveTo(-6, 0);
                    ctx.lineTo(-15, 0);
                    ctx.stroke();
                }
                
                ctx.restore();
                
                // –ü—É–ª–∏
                ctx.fillStyle = '#FFFFFF';
                this.bullets.forEach(bullet => {
                    ctx.beginPath();
                    ctx.arc(bullet.x, bullet.y, 2, 0, Math.PI * 2);
                    ctx.fill();
                });
                
                // –ê—Å—Ç–µ—Ä–æ–∏–¥—ã
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 2;
                this.asteroids.forEach(asteroid => {
                    ctx.save();
                    ctx.translate(asteroid.x, asteroid.y);
                    ctx.rotate(asteroid.angle);
                    
                    ctx.beginPath();
                    for (let i = 0; i < 8; i++) {
                        const angle = (i / 8) * Math.PI * 2;
                        const radius = asteroid.size * (0.8 + Math.sin(angle * 3) * 0.2);
                        const x = Math.cos(angle) * radius;
                        const y = Math.sin(angle) * radius;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    ctx.closePath();
                    ctx.stroke();
                    
                    ctx.restore();
                });
            }
        }

        // –õ–Ø–ì–£–®–ö–ê
        class FroggerGame extends BaseGame {
            constructor() {
                super();
                this.frog = { x: canvas.width / 2, y: canvas.height - 40, width: 20, height: 20 };
                this.cars = [];
                this.logs = [];
                this.lanes = [];
                this.onLog = false;
                this.logSpeed = 0;
                this.setupLanes();
            }
            
            setupLanes() {
                this.lanes = [];
                const laneHeight = 40;
                
                for (let i = 0; i < Math.floor(canvas.height / laneHeight); i++) {
                    this.lanes.push({
                        y: i * laneHeight,
                        type: i < 3 ? 'road' : i < 6 ? 'water' : 'safe',
                        speed: (Math.random() - 0.5) * 4,
                        direction: Math.random() > 0.5 ? 1 : -1
                    });
                }
            }
            
            setupGame() {
                this.frog.x = canvas.width / 2;
                this.frog.y = canvas.height - 40;
                this.cars = [];
                this.logs = [];
                this.onLog = false;
                this.logSpeed = 0;
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—à–∏–Ω
                this.lanes.forEach((lane, index) => {
                    if (lane.type === 'road') {
                        for (let i = 0; i < 3; i++) {
                            this.cars.push({
                                x: (i * 150) + Math.random() * 100,
                                y: lane.y + 10,
                                width: 40,
                                height: 20,
                                speed: lane.speed * lane.direction,
                                lane: index
                            });
                        }
                    } else if (lane.type === 'water') {
                        for (let i = 0; i < 2; i++) {
                            this.logs.push({
                                x: (i * 200) + Math.random() * 100,
                                y: lane.y + 10,
                                width: 80,
                                height: 20,
                                speed: lane.speed * lane.direction,
                                lane: index
                            });
                        }
                    }
                });
            }
            
            update() {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª—è–≥—É—à–∫–æ–π
                if (keys[getKey('ArrowUp')]) {
                    this.frog.y -= 40;
                    if (this.frog.y < 0) this.frog.y = 0;
                    keys[getKey('ArrowUp')] = false;
                    soundSystem.playJump();
                }
                if (keys[getKey('ArrowDown')]) {
                    this.frog.y += 40;
                    if (this.frog.y > canvas.height - 40) this.frog.y = canvas.height - 40;
                    keys[getKey('ArrowDown')] = false;
                    soundSystem.playJump();
                }
                if (keys[getKey('ArrowLeft')]) {
                    this.frog.x -= 20;
                    if (this.frog.x < 0) this.frog.x = 0;
                    keys[getKey('ArrowLeft')] = false;
                    soundSystem.playMove();
                }
                if (keys[getKey('ArrowRight')]) {
                    this.frog.x += 20;
                    if (this.frog.x > canvas.width - 20) this.frog.x = canvas.width - 20;
                    keys[getKey('ArrowRight')] = false;
                    soundSystem.playMove();
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –º–∞—à–∏–Ω
                this.cars.forEach(car => {
                    car.x += car.speed * this.speedMultiplier;
                    
                    if (car.x < -car.width) car.x = canvas.width;
                    if (car.x > canvas.width) car.x = -car.width;
                });
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –±—Ä–µ–≤–µ–Ω
                this.logs.forEach(log => {
                    log.x += log.speed * this.speedMultiplier;
                    
                    if (log.x < -log.width) log.x = canvas.width;
                    if (log.x > canvas.width) log.x = -log.width;
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π —Å –º–∞—à–∏–Ω–∞–º–∏
                this.cars.forEach(car => {
                    if (this.frog.x < car.x + car.width &&
                        this.frog.x + this.frog.width > car.x &&
                        this.frog.y < car.y + car.height &&
                        this.frog.y + this.frog.height > car.y) {
                        
                        this.lives--;
                        if (this.lives <= 0) {
                            this.gameOver();
                        } else {
                            this.frog.x = canvas.width / 2;
                            this.frog.y = canvas.height - 40;
                            soundSystem.playExplosion();
                        }
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–¥—ã –∏ –±—Ä–µ–≤–µ–Ω
                const currentLane = Math.floor(this.frog.y / 40);
                if (currentLane < this.lanes.length && this.lanes[currentLane].type === 'water') {
                    this.onLog = false;
                    
                    this.logs.forEach(log => {
                        if (this.frog.x < log.x + log.width &&
                            this.frog.x + this.frog.width > log.x &&
                            this.frog.y < log.y + log.height &&
                            this.frog.y + this.frog.height > log.y) {
                            
                            this.onLog = true;
                            this.logSpeed = log.speed;
                        }
                    });
                    
                    if (this.onLog) {
                        this.frog.x += this.logSpeed * this.speedMultiplier;
                    } else {
                        this.lives--;
                        if (this.lives <= 0) {
                            this.gameOver();
                        } else {
                            this.frog.x = canvas.width / 2;
                            this.frog.y = canvas.height - 40;
                            soundSystem.playExplosion();
                        }
                    }
                                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏
                if (this.frog.y <= 40) {
                    this.score += 100;
                    this.frog.x = canvas.width / 2;
                    this.frog.y = canvas.height - 40;
                    soundSystem.playPickup();
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ü–æ–ª–æ—Å—ã
                this.lanes.forEach((lane, index) => {
                    if (lane.type === 'road') {
                        ctx.fillStyle = '#444444';
                    } else if (lane.type === 'water') {
                        ctx.fillStyle = '#0066CC';
                    } else {
                        ctx.fillStyle = '#00AA00';
                    }
                    
                    ctx.fillRect(0, lane.y, canvas.width, 40);
                });
                
                // –ú–∞—à–∏–Ω—ã
                ctx.fillStyle = '#FF0000';
                this.cars.forEach(car => {
                    ctx.fillRect(car.x, car.y, car.width, car.height);
                });
                
                // –ë—Ä–µ–≤–Ω–∞
                ctx.fillStyle = '#8B4513';
                this.logs.forEach(log => {
                    ctx.fillRect(log.x, log.y, log.width, log.height);
                });
                
                // –õ—è–≥—É—à–∫–∞
                ctx.fillStyle = '#00FF00';
                ctx.fillRect(this.frog.x, this.frog.y, this.frog.width, this.frog.height);
            }
        }

        // –†–ê–ö–ï–¢–ù–ê–Ø –ö–û–ú–ê–ù–î–ê
        class MissileGame extends BaseGame {
            constructor() {
                super();
                this.cities = [];
                this.missiles = [];
                this.explosions = [];
                this.playerMissiles = [];
                this.crosshair = { x: canvas.width / 2, y: canvas.height / 2 };
                this.setupCities();
            }
            
            setupCities() {
                this.cities = [];
                for (let i = 0; i < 6; i++) {
                    this.cities.push({
                        x: 50 + i * 100,
                        y: canvas.height - 30,
                        width: 60,
                        height: 30,
                        destroyed: false
                    });
                }
            }
            
            setupGame() {
                this.setupCities();
                this.missiles = [];
                this.explosions = [];
                this.playerMissiles = [];
                this.crosshair = { x: canvas.width / 2, y: canvas.height / 2 };
            }
            
            update() {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏—Ü–µ–ª–æ–º
                if (keys[getKey('ArrowUp')]) {
                    this.crosshair.y -= 3 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowDown')]) {
                    this.crosshair.y += 3 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowLeft')]) {
                    this.crosshair.x -= 3 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowRight')]) {
                    this.crosshair.x += 3 * this.speedMultiplier;
                }
                
                // –°—Ç—Ä–µ–ª—å–±–∞
                if (keys[getKey('Space')]) {
                    this.playerMissiles.push({
                        x: canvas.width / 2,
                        y: canvas.height - 50,
                        targetX: this.crosshair.x,
                        targetY: this.crosshair.y,
                        speed: 5
                    });
                    keys[getKey('Space')] = false;
                    soundSystem.playShoot();
                }
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–∂–µ—Å–∫–∏—Ö —Ä–∞–∫–µ—Ç
                if (Math.random() < 0.02) {
                    const target = this.cities[Math.floor(Math.random() * this.cities.length)];
                    this.missiles.push({
                        x: Math.random() * canvas.width,
                        y: 0,
                        targetX: target.x,
                        targetY: target.y,
                        speed: 1 + Math.random() * 2
                    });
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ —Ä–∞–∫–µ—Ç –∏–≥—Ä–æ–∫–∞
                this.playerMissiles.forEach((missile, index) => {
                    const dx = missile.targetX - missile.x;
                    const dy = missile.targetY - missile.y;
                    const distance = Math.hypot(dx, dy);
                    
                    if (distance < missile.speed) {
                        this.explosions.push({
                            x: missile.x,
                            y: missile.y,
                            radius: 0,
                            maxRadius: 50,
                            life: 30
                        });
                        this.playerMissiles.splice(index, 1);
                        soundSystem.playExplosion();
                    } else {
                        missile.x += (dx / distance) * missile.speed * this.speedMultiplier;
                        missile.y += (dy / distance) * missile.speed * this.speedMultiplier;
                    }
                });
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–∂–µ—Å–∫–∏—Ö —Ä–∞–∫–µ—Ç
                this.missiles.forEach((missile, index) => {
                    const dx = missile.targetX - missile.x;
                    const dy = missile.targetY - missile.y;
                    const distance = Math.hypot(dx, dy);
                    
                    if (distance < missile.speed) {
                        this.explosions.push({
                            x: missile.x,
                            y: missile.y,
                            radius: 0,
                            maxRadius: 30,
                            life: 20
                        });
                        this.missiles.splice(index, 1);
                        soundSystem.playExplosion();
                    } else {
                        missile.x += (dx / distance) * missile.speed * this.speedMultiplier;
                        missile.y += (dy / distance) * missile.speed * this.speedMultiplier;
                    }
                });
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∑—Ä—ã–≤–æ–≤
                this.explosions.forEach((explosion, index) => {
                    explosion.radius += 2;
                    explosion.life--;
                    
                    if (explosion.life <= 0 || explosion.radius >= explosion.maxRadius) {
                        this.explosions.splice(index, 1);
                    }
                    
                    // –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ —Ä–∞–∫–µ—Ç –≤–∑—Ä—ã–≤–∞–º–∏
                    this.missiles.forEach((missile, mIndex) => {
                        if (Math.hypot(missile.x - explosion.x, missile.y - explosion.y) < explosion.radius) {
                            this.missiles.splice(mIndex, 1);
                            this.score += 25;
                        }
                    });
                    
                    // –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤
                    this.cities.forEach(city => {
                        if (!city.destroyed && Math.hypot(city.x - explosion.x, city.y - explosion.y) < explosion.radius) {
                            city.destroyed = true;
                            this.lives--;
                        }
                    });
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
                if (this.lives <= 0) {
                    this.gameOver();
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ª–Ω—ã
                if (this.missiles.length === 0 && this.playerMissiles.length === 0) {
                    this.level++;
                    this.setupGame();
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ì–æ—Ä–æ–¥–∞
                this.cities.forEach(city => {
                    if (!city.destroyed) {
                        ctx.fillStyle = '#00FF00';
                        ctx.fillRect(city.x, city.y, city.width, city.height);
                    }
                });
                
                // –†–∞–∫–µ—Ç—ã –∏–≥—Ä–æ–∫–∞
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 2;
                this.playerMissiles.forEach(missile => {
                    ctx.beginPath();
                    ctx.moveTo(canvas.width / 2, canvas.height - 50);
                    ctx.lineTo(missile.x, missile.y);
                    ctx.stroke();
                });
                
                // –í—Ä–∞–∂–µ—Å–∫–∏–µ —Ä–∞–∫–µ—Ç—ã
                ctx.strokeStyle = '#FF0000';
                this.missiles.forEach(missile => {
                    ctx.beginPath();
                    ctx.moveTo(missile.x, 0);
                    ctx.lineTo(missile.x, missile.y);
                    ctx.stroke();
                });
                
                // –í–∑—Ä—ã–≤—ã
                this.explosions.forEach(explosion => {
                    ctx.strokeStyle = '#FFFF00';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.arc(explosion.x, explosion.y, explosion.radius, 0, Math.PI * 2);
                    ctx.stroke();
                });
                
                // –ü—Ä–∏—Ü–µ–ª
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(this.crosshair.x - 10, this.crosshair.y);
                ctx.lineTo(this.crosshair.x + 10, this.crosshair.y);
                ctx.moveTo(this.crosshair.x, this.crosshair.y - 10);
                ctx.lineTo(this.crosshair.x, this.crosshair.y + 10);
                ctx.stroke();
            }
        }

        // –°–û–†–û–ö–û–ù–û–ñ–ö–ê
        class CentipedeGame extends BaseGame {
            constructor() {
                super();
                this.player = { x: canvas.width / 2, y: canvas.height - 40, width: 20, height: 20 };
                this.bullets = [];
                this.centipede = [];
                this.mushrooms = [];
                this.spider = null;
                this.fireRate = 0;
                this.setupCentipede();
                this.setupMushrooms();
            }
            
            setupCentipede() {
                this.centipede = [];
                for (let i = 0; i < 12; i++) {
                    this.centipede.push({
                        x: i * 20,
                        y: 20,
                        width: 18,
                        height: 18,
                        direction: 1,
                        dropDown: false
                    });
                }
            }
            
            setupMushrooms() {
                this.mushrooms = [];
                for (let i = 0; i < 30; i++) {
                    this.mushrooms.push({
                        x: Math.floor(Math.random() * (canvas.width / 20)) * 20,
                        y: Math.floor(Math.random() * (canvas.height / 20)) * 20 + 100,
                        width: 18,
                        height: 18,
                        health: 4
                    });
                }
            }
            
            setupGame() {
                this.player.x = canvas.width / 2;
                this.player.y = canvas.height - 40;
                this.bullets = [];
                this.fireRate = 0;
                this.setupCentipede();
                this.setupMushrooms();
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—É–∫–∞
                this.spider = {
                    x: Math.random() * canvas.width,
                    y: canvas.height - 100,
                    width: 15,
                    height: 15,
                    vx: (Math.random() - 0.5) * 3,
                    vy: (Math.random() - 0.5) * 2
                };
            }
            
            update() {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º
                if (keys[getKey('ArrowLeft')] && this.player.x > 0) {
                    this.player.x -= 4 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowRight')] && this.player.x < canvas.width - this.player.width) {
                    this.player.x += 4 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowUp')] && this.player.y > canvas.height - 150) {
                    this.player.y -= 4 * this.speedMultiplier;
                }
                if (keys[getKey('ArrowDown')] && this.player.y < canvas.height - this.player.height) {
                    this.player.y += 4 * this.speedMultiplier;
                }
                
                // –°—Ç—Ä–µ–ª—å–±–∞
                this.fireRate++;
                if (keys[getKey('Space')] && this.fireRate > 8) {
                    this.bullets.push({
                        x: this.player.x + this.player.width / 2,
                        y: this.player.y,
                        width: 2,
                        height: 8
                    });
                    this.fireRate = 0;
                    soundSystem.playShoot();
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å
                this.bullets.forEach((bullet, index) => {
                    bullet.y -= 8 * this.speedMultiplier;
                    if (bullet.y < 0) {
                        this.bullets.splice(index, 1);
                    }
                });
                
                // –î–≤–∏–∂–µ–Ω–∏–µ —Å–æ—Ä–æ–∫–æ–Ω–æ–∂–∫–∏
                this.centipede.forEach((segment, index) => {
                    if (segment.dropDown) {
                        segment.y += 20;
                        segment.dropDown = false;
                        segment.direction = -segment.direction;
                    } else {
                        segment.x += segment.direction * 2 * this.speedMultiplier;
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
                        if (segment.x <= 0 || segment.x >= canvas.width - segment.width) {
                            segment.dropDown = true;
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –≥—Ä–∏–±–∞–º–∏
                        this.mushrooms.forEach(mushroom => {
                            if (segment.x < mushroom.x + mushroom.width &&
                                segment.x + segment.width > mushroom.x &&
                                segment.y < mushroom.y + mushroom.height &&
                                segment.y + segment.height > mushroom.y) {
                                segment.dropDown = true;
                            }
                        });
                    }
                });
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –ø–∞—É–∫–∞
                if (this.spider) {
                    this.spider.x += this.spider.vx * this.speedMultiplier;
                    this.spider.y += this.spider.vy * this.speedMultiplier;
                    
                    if (this.spider.x < 0 || this.spider.x > canvas.width) {
                        this.spider.vx = -this.spider.vx;
                    }
                    
                    if (this.spider.y < canvas.height - 150 || this.spider.y > canvas.height) {
                        this.spider.vy = -this.spider.vy;
                    }
                }
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –ø—É–ª—å
                this.bullets.forEach((bullet, bulletIndex) => {
                    // –° —Å–æ—Ä–æ–∫–æ–Ω–æ–∂–∫–æ–π
                    this.centipede.forEach((segment, segmentIndex) => {
                        if (bullet.x < segment.x + segment.width &&
                            bullet.x + bullet.width > segment.x &&
                            bullet.y < segment.y + segment.height &&
                            bullet.y + bullet.height > segment.y) {
                            
                            this.bullets.splice(bulletIndex, 1);
                            this.centipede.splice(segmentIndex, 1);
                            this.score += 10;
                            soundSystem.playExplosion();
                            
                            // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∏–±–∞
                            this.mushrooms.push({
                                x: segment.x,
                                y: segment.y,
                                width: 18,
                                height: 18,
                                health: 4
                            });
                        }
                    });
                    
                    // –° –≥—Ä–∏–±–∞–º–∏
                    this.mushrooms.forEach((mushroom, mushroomIndex) => {
                        if (bullet.x < mushroom.x + mushroom.width &&
                            bullet.x + bullet.width > mushroom.x &&
                            bullet.y < mushroom.y + mushroom.height &&
                            bullet.y + bullet.height > mushroom.y) {
                            
                            this.bullets.splice(bulletIndex, 1);
                            mushroom.health--;
                            
                            if (mushroom.health <= 0) {
                                this.mushrooms.splice(mushroomIndex, 1);
                                this.score += 1;
                            }
                            
                            soundSystem.playMove();
                        }
                    });
                    
                    // –° –ø–∞—É–∫–æ–º
                    if (this.spider &&
                        bullet.x < this.spider.x + this.spider.width &&
                        bullet.x + bullet.width > this.spider.x &&
                        bullet.y < this.spider.y + this.spider.height &&
                        bullet.y + bullet.height > this.spider.y) {
                        
                        this.bullets.splice(bulletIndex, 1);
                        this.spider = null;
                        this.score += 300;
                        soundSystem.playExplosion();
                    }
                });
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
                this.centipede.forEach(segment => {
                    if (this.player.x < segment.x + segment.width &&
                        this.player.x + this.player.width > segment.x &&
                        this.player.y < segment.y + segment.height &&
                        this.player.y + this.player.height > segment.y) {
                        
                        this.lives--;
                        if (this.lives <= 0) {
                            this.gameOver();
                        } else {
                            this.player.x = canvas.width / 2;
                            this.player.y = canvas.height - 40;
                            soundSystem.playExplosion();
                        }
                    }
                });
                
                if (this.spider &&
                    this.player.x < this.spider.x + this.spider.width &&
                    this.player.x + this.player.width > this.spider.x &&
                    this.player.y < this.spider.y + this.spider.height &&
                    this.player.y + this.player.height > this.spider.y) {
                    
                    this.lives--;
                    if (this.lives <= 0) {
                        this.gameOver();
                    } else {
                        this.spider = null;
                        soundSystem.playExplosion();
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (this.centipede.length === 0) {
                    this.level++;
                    this.setupGame();
                }
                
                this.updateUI();
            }
            
            draw() {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ò–≥—Ä–æ–∫
                ctx.fillStyle = '#00FF00';
                ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                
                // –ü—É–ª–∏
                ctx.fillStyle = '#FFFFFF';
                this.bullets.forEach(bullet => {
                    ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                });
                
                // –°–æ—Ä–æ–∫–æ–Ω–æ–∂–∫–∞
                ctx.fillStyle = '#FF0000';
                this.centipede.forEach((segment, index) => {
                    ctx.fillStyle = index === 0 ? '#FFFF00' : '#FF0000';
                    ctx.fillRect(segment.x, segment.y, segment.width, segment.height);
                });
                
                // –ì—Ä–∏–±—ã
                ctx.fillStyle = '#8B4513';
                this.mushrooms.forEach(mushroom => {
                    ctx.fillRect(mushroom.x, mushroom.y, mushroom.width, mushroom.height);
                });
                
                // –ü–∞—É–∫
                if (this.spider) {
                    ctx.fillStyle = '#FF00FF';
                    ctx.fillRect(this.spider.x, this.spider.y, this.spider.width, this.spider.height);
                }
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –≤—Å–µ—Ö –∏–≥—Ä
        const gameInstances = {
            tetris: new TetrisGame(),
            pong: new PongGame(),
            invaders: new InvadersGame(),
            snake: new SnakeGame(),
            breakout: new BreakoutGame(),
            pacman: new PacmanGame(),
            asteroids: new AsteroidsGame(),
            frogger: new FroggerGame(),
            missile: new MissileGame(),
            centipede: new CentipedeGame(),
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
            donkey: new class extends BaseGame {
                constructor() {
                    super();
                    this.player = { x: 50, y: canvas.height - 60, width: 20, height: 20 };
                    this.barrels = [];
                    this.ladders = [];
                    this.platforms = [];
                    this.princess = { x: canvas.width - 60, y: 50 };
                    this.gorilla = { x: canvas.width - 100, y: 50 };
                    this.setupLevel();
                }
                
                setupLevel() {
                    this.platforms = [];
                    for (let i = 0; i < 8; i++) {
                        this.platforms.push({
                            x: i % 2 === 0 ? 0 : 100,
                            y: canvas.height - 80 - i * 50,
                            width: i % 2 === 0 ? canvas.width - 100 : canvas.width - 100,
                            height: 10
                        });
                    }
                    
                    this.ladders = [];
                    for (let i = 0; i < 7; i++) {
                        this.ladders.push({
                            x: i % 2 === 0 ? canvas.width - 120 : 120,
                            y: canvas.height - 130 - i * 50,
                            width: 20,
                            height: 50
                        });
                    }
                }
                
                setupGame() {
                    this.player.x = 50;
                    this.player.y = canvas.height - 60;
                    this.barrels = [];
                    this.setupLevel();
                }
                
                update() {
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')] && this.player.x > 0) {
                        this.player.x -= 3 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowRight')] && this.player.x < canvas.width - this.player.width) {
                        this.player.x += 3 * this.speedMultiplier;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–µ—Å—Ç–Ω–∏—Ü
                    let onLadder = false;
                    this.ladders.forEach(ladder => {
                        if (this.player.x < ladder.x + ladder.width &&
                            this.player.x + this.player.width > ladder.x &&
                            this.player.y < ladder.y + ladder.height &&
                            this.player.y + this.player.height > ladder.y) {
                            onLadder = true;
                        }
                    });
                    
                    if (onLadder) {
                        if (keys[getKey('ArrowUp')]) {
                            this.player.y -= 3 * this.speedMultiplier;
                        }
                        if (keys[getKey('ArrowDown')]) {
                            this.player.y += 3 * this.speedMultiplier;
                        }
                    }
                    
                    // –ü—Ä—ã–∂–∫–∏
                    if (keys[getKey('Space')]) {
                        this.player.y -= 20;
                        keys[getKey('Space')] = false;
                        soundSystem.playJump();
                    }
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—á–µ–∫
                    if (Math.random() < 0.02) {
                        this.barrels.push({
                            x: this.gorilla.x,
                            y: this.gorilla.y + 30,
                            width: 15,
                            height: 15,
                            vx: 2,
                            vy: 0
                        });
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –±–æ—á–µ–∫
                    this.barrels.forEach((barrel, index) => {
                        barrel.x += barrel.vx * this.speedMultiplier;
                        barrel.y += barrel.vy * this.speedMultiplier;
                        
                        // –§–∏–∑–∏–∫–∞ –ø–∞–¥–µ–Ω–∏—è
                        barrel.vy += 0.5;
                        
                        // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
                        this.platforms.forEach(platform => {
                            if (barrel.x < platform.x + platform.width &&
                                barrel.x + barrel.width > platform.x &&
                                barrel.y < platform.y + platform.height &&
                                barrel.y + barrel.height > platform.y) {
                                barrel.vy = 0;
                                barrel.y = platform.y - barrel.height;
                            }
                        });
                        
                        // –£–¥–∞–ª–µ–Ω–∏–µ –±–æ—á–µ–∫
                        if (barrel.y > canvas.height) {
                            this.barrels.splice(index, 1);
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –±–æ—á–∫–∞–º–∏
                    this.barrels.forEach(barrel => {
                        if (this.player.x < barrel.x + barrel.width &&
                            this.player.x + this.player.width > barrel.x &&
                            this.player.y < barrel.y + barrel.height &&
                            this.player.y + this.player.height > barrel.y) {
                            
                            this.lives--;
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                this.player.x = 50;
                                this.player.y = canvas.height - 60;
                                soundSystem.playExplosion();
                            }
                        }
                    });
                    
                    // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–µ—Å—Å—ã
                    if (this.player.x < this.princess.x + 20 &&
                        this.player.x + this.player.width > this.princess.x &&
                        this.player.y < this.princess.y + 20 &&
                        this.player.y + this.player.height > this.princess.y) {
                        
                        this.score += 1000;
                        this.level++;
                        this.setupGame();
                        soundSystem.playPickup();
                    }
                    
                    this.updateUI();
                }
                
                draw() {
                    ctx.fillStyle = '#000044';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã
                    ctx.fillStyle = '#FF0000';
                    this.platforms.forEach(platform => {
                        ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
                    });
                    
                    // –õ–µ—Å—Ç–Ω–∏—Ü—ã
                    ctx.fillStyle = '#FFFF00';
                    this.ladders.forEach(ladder => {
                        ctx.fillRect(ladder.x, ladder.y, ladder.width, ladder.height);
                    });
                    
                    // –ò–≥—Ä–æ–∫
                    ctx.fillStyle = '#00FF00';
                    ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                    
                    // –ë–æ—á–∫–∏
                    ctx.fillStyle = '#8B4513';
                    this.barrels.forEach(barrel => {
                        ctx.fillRect(barrel.x, barrel.y, barrel.width, barrel.height);
                    });
                    
                    // –ì–æ—Ä–∏–ª–ª–∞
                    ctx.fillStyle = '#654321';
                    ctx.fillRect(this.gorilla.x, this.gorilla.y, 40, 40);
                    
                    // –ü—Ä–∏–Ω—Ü–µ—Å—Å–∞
                    ctx.fillStyle = '#FF69B4';
                    ctx.fillRect(this.princess.x, this.princess.y, 20, 20);
                }
            }(),
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã...
            defender: new class extends BaseGame {
                constructor() {
                    super();
                    this.ship = { x: 100, y: canvas.height / 2, vx: 0, vy: 0 };
                    this.bullets = [];
                    this.enemies = [];
                    this.humans = [];
                    this.setupHumans();
                }
                
                setupHumans() {
                    this.humans = [];
                    for (let i = 0; i < 10; i++) {
                        this.humans.push({
                            x: i * 60 + 50,
                            y: canvas.height - 30,
                            width: 10,
                            height: 15,
                            captured: false
                        });
                    }
                }
                
                setupGame() {
                    this.ship.x = 100;
                    this.ship.y = canvas.height / 2;
                    this.ship.vx = 0;
                    this.ship.vy = 0;
                    this.bullets = [];
                    this.enemies = [];
                    this.setupHumans();
                }
                
                update() {
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')]) {
                        this.ship.vx -= 0.5;
                    }
                    if (keys[getKey('ArrowRight')]) {
                        this.ship.vx += 0.5;
                    }
                    if (keys[getKey('ArrowUp')]) {
                        this.ship.vy -= 0.5;
                    }
                    if (keys[getKey('ArrowDown')]) {
                        this.ship.vy += 0.5;
                    }
                    
                    // –°—Ç—Ä–µ–ª—å–±–∞
                    if (keys[getKey('Space')]) {
                        this.bullets.push({
                            x: this.ship.x + 20,
                            y: this.ship.y + 10,
                            vx: this.ship.vx > 0 ? 8 : -8,
                            vy: 0
                        });
                        keys[getKey('Space')] = false;
                        soundSystem.playShoot();
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è
                    this.ship.x += this.ship.vx * this.speedMultiplier;
                    this.ship.y += this.ship.vy * this.speedMultiplier;
                    
                    // –¢—Ä–µ–Ω–∏–µ
                    this.ship.vx *= 0.95;
                    this.ship.vy *= 0.95;
                    
                    // –ì—Ä–∞–Ω–∏—Ü—ã
                    if (this.ship.x < 0) this.ship.x = 0;
                    if (this.ship.x > canvas.width - 20) this.ship.x = canvas.width - 20;
                    if (this.ship.y < 0) this.ship.y = 0;
                    if (this.ship.y > canvas.height - 20) this.ship.y = canvas.height - 20;
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å
                    this.bullets.forEach((bullet, index) => {
                        bullet.x += bullet.vx * this.speedMultiplier;
                        bullet.y += bullet.vy * this.speedMultiplier;
                        
                        if (bullet.x < 0 || bullet.x > canvas.width || bullet.y < 0 || bullet.y > canvas.height) {
                            this.bullets.splice(index, 1);
                        }
                    });
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    if (Math.random() < 0.01) {
                        this.enemies.push({
                            x: Math.random() * canvas.width,
                            y: 0,
                            width: 15,
                            height: 15,
                            vx: (Math.random() - 0.5) * 2,
                            vy: 1
                        });
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    this.enemies.forEach((enemy, index) => {
                        enemy.x += enemy.vx * this.speedMultiplier;
                        enemy.y += enemy.vy * this.speedMultiplier;
                        
                        if (enemy.y > canvas.height) {
                            this.enemies.splice(index, 1);
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                    this.bullets.forEach((bullet, bIndex) => {
                        this.enemies.forEach((enemy, eIndex) => {
                            if (bullet.x < enemy.x + enemy.width &&
                                bullet.x + 4 > enemy.x &&
                                bullet.y < enemy.y + enemy.height &&
                                bullet.y + 4 > enemy.y) {
                                
                                this.bullets.splice(bIndex, 1);
                                this.enemies.splice(eIndex, 1);
                                this.score += 150;
                                soundSystem.playExplosion();
                            }
                        });
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –∏–≥—Ä–æ–∫–æ–º
                    this.enemies.forEach(enemy => {
                        if (this.ship.x < enemy.x + enemy.width &&
                            this.ship.x + 20 > enemy.x &&
                            this.ship.y < enemy.y + enemy.height &&
                            this.ship.y + 20 > enemy.y) {
                            
                            this.lives--;
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                this.ship.x = 100;
                                this.ship.y = canvas.height / 2;
                                soundSystem.playExplosion();
                            }
                        }
                    });
                    
                    this.updateUI();
                }
                
                draw() {
                    ctx.fillStyle = '#000033';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –ö–æ—Ä–∞–±–ª—å
                    ctx.fillStyle = '#00FF00';
                    ctx.fillRect(this.ship.x, this.ship.y, 20, 12);
                    
                    // –ü—É–ª–∏
                    ctx.fillStyle = '#FFFFFF';
                    this.bullets.forEach(bullet => {
                        ctx.fillRect(bullet.x, bullet.y, 4, 2);
                    });
                    
                    // –í—Ä–∞–≥–∏
                    ctx.fillStyle = '#FF0000';
                    this.enemies.forEach(enemy => {
                        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    });
                    
                    // –õ—é–¥–∏
                    ctx.fillStyle = '#FFFF00';
                    this.humans.forEach(human => {
                        if (!human.captured) {
                            ctx.fillRect(human.x, human.y, human.width, human.height);
                        }
                    });
                    
                    // –ó–µ–º–ª—è
                    ctx.fillStyle = '#00AA00';
                    ctx.fillRect(0, canvas.height - 20, canvas.width, 20);
                }
            }(),
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã –∫–∞–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
            racing: new class extends BaseGame {
                constructor() {
                    super();
                    this.car = { x: canvas.width / 2, y: canvas.height - 80, width: 20, height: 40 };
                    this.enemies = [];
                    this.road = [];
                    this.speed = 0;
                    this.setupRoad();
                }
                
                setupRoad() {
                    this.road = [];
                    for (let i = 0; i < canvas.height / 20; i++) {
                        this.road.push({
                            x: canvas.width / 2 - 100,
                            y: i * 20,
                            width: 200,
                            height: 20
                        });
                    }
                }
                
                setupGame() {
                    this.car.x = canvas.width / 2;
                    this.car.y = canvas.height - 80;
                    this.enemies = [];
                    this.speed = 0;
                    this.setupRoad();
                }
                
                update() {
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')] && this.car.x > canvas.width / 2 - 100) {
                        this.car.x -= 4 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowRight')] && this.car.x < canvas.width / 2 + 80) {
                        this.car.x += 4 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowUp')]) {
                        this.speed = Math.min(this.speed + 0.2, 8);
                    } else {
                        this.speed = Math.max(this.speed - 0.1, 2);
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –¥–æ—Ä–æ–≥–∏
                    this.road.forEach(segment => {
                        segment.y += this.speed * this.speedMultiplier;
                        if (segment.y > canvas.height) {
                            segment.y = -20;
                        }
                    });
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    if (Math.random() < 0.01) {
                        this.enemies.push({
                            x: canvas.width / 2 - 80 + Math.random() * 160,
                            y: -40,
                            width: 18,
                            height: 35,
                            speed: Math.random() * 2 + 1
                        });
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    this.enemies.forEach((enemy, index) => {
                        enemy.y += (this.speed - enemy.speed) * this.speedMultiplier;
                        
                        if (enemy.y > canvas.height) {
                            this.enemies.splice(index, 1);
                            this.score += 10;
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                    this.enemies.forEach(enemy => {
                        if (this.car.x < enemy.x + enemy.width &&
                            this.car.x + this.car.width > enemy.x &&
                            this.car.y < enemy.y + enemy.height &&
                            this.car.y + this.car.height > enemy.y) {
                            
                            this.lives--;
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                this.car.x = canvas.width / 2;
                                this.enemies = [];
                                soundSystem.playExplosion();
                            }
                        }
                    });
                    
                    this.score += Math.floor(this.speed);
                    this.updateUI();
                }
                
                draw() {
                    ctx.fillStyle = '#00AA00';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –î–æ—Ä–æ–≥–∞
                    ctx.fillStyle = '#555555';
                    this.road.forEach(segment => {
                        ctx.fillRect(segment.x, segment.y, segment.width, segment.height);
                    });
                    
                    // –†–∞–∑–º–µ—Ç–∫–∞
                    ctx.fillStyle = '#FFFFFF';
                    for (let i = 0; i < canvas.height / 40; i++) {
                        ctx.fillRect(canvas.width / 2 - 2, i * 40, 4, 20);
                    }
                    
                    // –ú–∞—à–∏–Ω–∞ –∏–≥—Ä–æ–∫–∞
                    ctx.fillStyle = '#0000FF';
                    ctx.fillRect(this.car.x, this.car.y, this.car.width, this.car.height);
                    
                    // –í—Ä–∞–∂–µ—Å–∫–∏–µ –º–∞—à–∏–Ω—ã
                    ctx.fillStyle = '#FF0000';
                    this.enemies.forEach(enemy => {
                        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    });
                }
            }(),
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏...
            tanks: new class extends BaseGame {
                constructor() {
                    super();
                    this.player = { x: 50, y: canvas.height - 50, width: 20, height: 20, angle: 0 };
                    this.enemies = [];
                    this.bullets = [];
                    this.walls = [];
                    this.setupWalls();
                }
                
                setupWalls() {
                    this.walls = [];
                    for (let i = 0; i < 20; i++) {
                        this.walls.push({
                            x: Math.random() * (canvas.width - 20),
                            y: Math.random() * (canvas.height - 20),
                            width: 20,
                            height: 20,
                            destructible: true
                        });
                    }
                }
                
                setupGame() {
                    this.player.x = 50;
                    this.player.y = canvas.height - 50;
                    this.player.angle = 0;
                    this.enemies = [];
                    this.bullets = [];
                    this.setupWalls();
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    for (let i = 0; i < 5; i++) {
                        this.enemies.push({
                            x: Math.random() * (canvas.width - 20),
                            y: Math.random() * (canvas.height - 20),
                            width: 20,
                            height: 20,
                            angle: Math.random() * Math.PI * 2,
                            lastShot: 0
                        });
                    }
                }
                
                update() {
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')]) {
                        this.player.angle -= 0.1;
                    }
                    if (keys[getKey('ArrowRight')]) {
                        this.player.angle += 0.1;
                    }
                    if (keys[getKey('ArrowUp')]) {
                        const newX = this.player.x + Math.cos(this.player.angle) * 2;
                        const newY = this.player.y + Math.sin(this.player.angle) * 2;
                        
                        if (newX > 0 && newX < canvas.width - 20 && newY > 0 && newY < canvas.height - 20) {
                            this.player.x = newX;
                            this.player.y = newY;
                        }
                    }
                    
                    // –°—Ç—Ä–µ–ª—å–±–∞
                    if (keys[getKey('Space')]) {
                        this.bullets.push({
                            x: this.player.x + 10,
                            y: this.player.y + 10,
                            vx: Math.cos(this.player.angle) * 5,
                            vy: Math.sin(this.player.angle) * 5,
                            owner: 'player'
                        });
                        keys[getKey('Space')] = false;
                        soundSystem.playShoot();
                    }
                    
                    // –ò–ò –≤—Ä–∞–≥–æ–≤
                    this.enemies.forEach(enemy => {
                        enemy.lastShot++;
                        
                        // –ü–æ–≤–æ—Ä–æ—Ç –∫ –∏–≥—Ä–æ–∫—É
                        const dx = this.player.x - enemy.x;
                        const dy = this.player.y - enemy.y;
                        const targetAngle = Math.atan2(dy, dx);
                        
                        let angleDiff = targetAngle - enemy.angle;
                        if (angleDiff > Math.PI) angleDiff -= 2 * Math.PI;
                        if (angleDiff < -Math.PI) angleDiff += 2 * Math.PI;
                        
                        enemy.angle += Math.sign(angleDiff) * 0.05;
                        
                        // –î–≤–∏–∂–µ–Ω–∏–µ
                        const newX = enemy.x + Math.cos(enemy.angle) * 1;
                        const newY = enemy.y + Math.sin(enemy.angle) * 1;
                        
                        if (newX > 0 && newX < canvas.width - 20 && newY > 0 && newY < canvas.height - 20) {
                            enemy.x = newX;
                            enemy.y = newY;
                        }
                        
                        // –°—Ç—Ä–µ–ª—å–±–∞
                        if (enemy.lastShot > 60 && Math.random() < 0.02) {
                            this.bullets.push({
                                x: enemy.x + 10,
                                y: enemy.y + 10,
                                vx: Math.cos(enemy.angle) * 4,
                                vy: Math.sin(enemy.angle) * 4,
                                owner: 'enemy'
                            });
                            enemy.lastShot = 0;
                        }
                    });
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å
                    this.bullets.forEach((bullet, index) => {
                        bullet.x += bullet.vx * this.speedMultiplier;
                        bullet.y += bullet.vy * this.speedMultiplier;
                        
                        if (bullet.x < 0 || bullet.x > canvas.width || bullet.y < 0 || bullet.y > canvas.height) {
                            this.bullets.splice(index, 1);
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –ø—É–ª—å
                    this.bullets.forEach((bullet, bIndex) => {
                        // –°–æ —Å—Ç–µ–Ω–∞–º–∏
                        this.walls.forEach((wall, wIndex) => {
                            if (bullet.x < wall.x + wall.width &&
                                bullet.x + 2 > wall.x &&
                                bullet.y < wall.y + wall.height &&
                                bullet.y + 2 > wall.y) {
                                
                                this.bullets.splice(bIndex, 1);
                                if (wall.destructible) {
                                    this.walls.splice(wIndex, 1);
                                    soundSystem.playExplosion();
                                }
                            }
                        });
                        
                        // –° –≤—Ä–∞–≥–∞–º–∏
                        if (bullet.owner === 'player') {
                            this.enemies.forEach((enemy, eIndex) => {
                                if (bullet.x < enemy.x + enemy.width &&
                                    bullet.x + 2 > enemy.x &&
                                    bullet.y < enemy.y + enemy.height &&
                                    bullet.y + 2 > enemy.y) {
                                    
                                    this.bullets.splice(bIndex, 1);
                                    this.enemies.splice(eIndex, 1);
                                    this.score += 100;
                                    soundSystem.playExplosion();
                                }
                            });
                        }
                        
                        // –° –∏–≥—Ä–æ–∫–æ–º
                        if (bullet.owner === 'enemy') {
                            if (bullet.x < this.player.x + this.player.width &&
                                bullet.x + 2 > this.player.x &&
                                bullet.y < this.player.y + this.player.height &&
                                bullet.y + 2 > this.player.y) {
                                
                                this.lives--;
                                if (this.lives <= 0) {
                                    this.gameOver();
                                } else {
                                    this.player.x = 50;
                                    this.player.y = canvas.height - 50;
                                    soundSystem.playExplosion();
                                }
                            }
                        }
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                    if (this.enemies.length === 0) {
                        this.level++;
                        this.setupGame();
                    }
                    
                    this.updateUI();
                }
                
                draw() {
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –°—Ç–µ–Ω—ã
                    ctx.fillStyle = '#8B4513';
                    this.walls.forEach(wall => {
                        ctx.fillRect(wall.x, wall.y, wall.width, wall.height);
                    });
                    
                    // –ò–≥—Ä–æ–∫
                    ctx.save();
                    ctx.translate(this.player.x + 10, this.player.y + 10);
                    ctx.rotate(this.player.angle);
                    ctx.fillStyle = '#00FF00';
                    ctx.fillRect(-10, -10, 20, 20);
                    ctx.fillStyle = '#FFFFFF';
                    ctx.fillRect(8, -2, 12, 4);
                    ctx.restore();
                    
                    // –í—Ä–∞–≥–∏
                    this.enemies.forEach(enemy => {
                        ctx.save();
                        ctx.translate(enemy.x + 10, enemy.y + 10);
                        ctx.rotate(enemy.angle);
                        ctx.fillStyle = '#FF0000';
                        ctx.fillRect(-10, -10, 20, 20);
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(8, -2, 12, 4);
                        ctx.restore();
                    });
                    
                    // –ü—É–ª–∏
                    ctx.fillStyle = '#FFFFFF';
                    this.bullets.forEach(bullet => {
                        ctx.fillRect(bullet.x, bullet.y, 2, 2);
                    });
                }
            }(),
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã...
            platformer: new class extends BaseGame {
                constructor() {
                    super();
                    this.player = { x: 50, y: canvas.height - 100, width: 20, height: 20, vx: 0, vy: 0, grounded: false };
                    this.platforms = [];
                    this.enemies = [];
                    this.coins = [];
                    this.setupLevel();
                }
                
                setupLevel() {
                    this.platforms = [];
                    this.enemies = [];
                    this.coins = [];
                    
                    // –ó–µ–º–ª—è
                    this.platforms.push({ x: 0, y: canvas.height - 20, width: canvas.width, height: 20 });
                    
                    // –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã
                    for (let i = 0; i < 10; i++) {
                        this.platforms.push({
                            x: Math.random() * (canvas.width - 80),
                            y: Math.random() * (canvas.height - 200) + 100,
                            width: 80,
                            height: 15
                        });
                    }
                    
                    // –í—Ä–∞–≥–∏
                    for (let i = 0; i < 5; i++) {
                        this.enemies.push({
                            x: Math.random() * (canvas.width - 15),
                            y: canvas.height - 50,
                            width: 15,
                            height: 15,
                            vx: (Math.random() - 0.5) * 2
                        });
                    }
                    
                    // –ú–æ–Ω–µ—Ç—ã
                    for (let i = 0; i < 15; i++) {
                        this.coins.push({
                            x: Math.random() * (canvas.width - 10),
                            y: Math.random() * (canvas.height - 100) + 50,
                            width: 10,
                            height: 10
                        });
                    }
                }
                
                setupGame() {
                    this.player.x = 50;
                    this.player.y = canvas.height - 100;
                    this.player.vx = 0;
                    this.player.vy = 0;
                    this.player.grounded = false;
                    this.setupLevel();
                }
                
                update() {
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')]) {
                        this.player.vx = -4;
                    } else if (keys[getKey('ArrowRight')]) {
                        this.player.vx = 4;
                    } else {
                        this.player.vx *= 0.8;
                    }
                    
                    if (keys[getKey('Space')] && this.player.grounded) {
                        this.player.vy = -12;
                        this.player.grounded = false;
                        keys[getKey('Space')] = false;
                        soundSystem.playJump();
                    }
                    
                    // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è
                    this.player.vy += 0.5;
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ
                    this.player.x += this.player.vx * this.speedMultiplier;
                    this.player.y += this.player.vy * this.speedMultiplier;
                    
                    // –ì—Ä–∞–Ω–∏—Ü—ã
                    if (this.player.x < 0) this.player.x = 0;
                    if (this.player.x > canvas.width - this.player.width) this.player.x = canvas.width - this.player.width;
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
                    this.player.grounded = false;
                    this.platforms.forEach(platform => {
                        if (this.player.x < platform.x + platform.width &&
                            this.player.x + this.player.width > platform.x &&
                            this.player.y < platform.y + platform.height &&
                            this.player.y + this.player.height > platform.y) {
                            
                            if (this.player.vy > 0) {
                                this.player.y = platform.y - this.player.height;
                                this.player.vy = 0;
                                this.player.grounded = true;
                            }
                        }
                    });
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    this.enemies.forEach(enemy => {
                        enemy.x += enemy.vx * this.speedMultiplier;
                        
                        if (enemy.x < 0 || enemy.x > canvas.width - enemy.width) {
                            enemy.vx = -enemy.vx;
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –≤—Ä–∞–≥–∞–º–∏
                    this.enemies.forEach((enemy, index) => {
                        if (this.player.x < enemy.x + enemy.width &&
                            this.player.x + this.player.width > enemy.x &&
                            this.player.y < enemy.y + enemy.height &&
                            this.player.y + this.player.height > enemy.y) {
                            
                            if (this.player.vy > 0) {
                                this.enemies.splice(index, 1);
                                this.player.vy = -8;
                                this.score += 50;
                                soundSystem.playExplosion();
                            } else {
                                this.lives--;
                                if (this.lives <= 0) {
                                    this.gameOver();
                                } else {
                                    this.player.x = 50;
                                    this.player.y = canvas.height - 100;
                                    soundSystem.playExplosion();
                                }
                            }
                        }
                    });
                    
                    // –°–±–æ—Ä –º–æ–Ω–µ—Ç
                    this.coins.forEach((coin, index) => {
                        if (this.player.x < coin.x + coin.width &&
                            this.player.x + this.player.width > coin.x &&
                            this.player.y < coin.y + coin.height &&
                            this.player.y + this.player.height > coin.y) {
                            
                            this.coins.splice(index, 1);
                            this.score += 10;
                            soundSystem.playPickup();
                        }
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                    if (this.coins.length === 0) {
                        this.level++;
                        this.setupGame();
                    }
                    
                    // –ü–∞–¥–µ–Ω–∏–µ
                    if (this.player.y > canvas.height) {
                        this.lives--;
                        if (this.lives <= 0) {
                            this.gameOver();
                        } else {
                            this.player.x = 50;
                            this.player.y = canvas.height - 100;
                            soundSystem.playExplosion();
                        }
                    }
                    
                    this.updateUI();
                }
                
                draw() {
                    ctx.fillStyle = '#87CEEB';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã
                    ctx.fillStyle = '#8B4513';
                    this.platforms.forEach(platform => {
                        ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
                    });
                    
                    // –ò–≥—Ä–æ–∫
                    ctx.fillStyle = '#FF0000';
                    ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                    
                    // –í—Ä–∞–≥–∏
                    ctx.fillStyle = '#800080';
                    this.enemies.forEach(enemy => {
                        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    });
                    
                    // –ú–æ–Ω–µ—Ç—ã
                    ctx.fillStyle = '#FFD700';
                    this.coins.forEach(coin => {
                        ctx.beginPath();
                        ctx.arc(coin.x + coin.width / 2, coin.y + coin.height / 2, 5, 0, Math.PI * 2);
                        ctx.fill();
                    });
                }
            }(),
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ...
            spaceshooter: new class extends BaseGame {
                constructor() {
                    super();
                    this.ship = { x: canvas.width / 2, y: canvas.height - 50, width: 20, height: 20 };
                    this.bullets = [];
                    this.enemies = [];
                    this.stars = [];
                    this.boss = null;
                    this.setupStars();
                }
                
                setupStars() {
                    this.stars = [];
                    for (let i = 0; i < 50; i++) {
                        this.stars.push({
                            x: Math.random() * canvas.width,
                            y: Math.random() * canvas.height,
                            speed: Math.random() * 2 + 1
                        });
                    }
                }
                
                setupGame() {
                    this.ship.x = canvas.width / 2;
                    this.ship.y = canvas.height - 50;
                    this.bullets = [];
                    this.enemies = [];
                    this.boss = null;
                    this.setupStars();
                }
                
                update() {
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')] && this.ship.x > 0) {
                        this.ship.x -= 5 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowRight')] && this.ship.x < canvas.width - this.ship.width) {
                        this.ship.x += 5 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowUp')] && this.ship.y > 0) {
                        this.ship.y -= 5 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowDown')] && this.ship.y < canvas.height - this.ship.height) {
                        this.ship.y += 5 * this.speedMultiplier;
                    }
                    
                    // –°—Ç—Ä–µ–ª—å–±–∞
                    if (keys[getKey('Space')]) {
                        this.bullets.push({
                            x: this.ship.x + this.ship.width / 2,
                            y: this.ship.y,
                            width: 2,
                            height: 8,
                            vy: -8
                        });
                        keys[getKey('Space')] = false;
                        soundSystem.playShoot();
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –∑–≤–µ–∑–¥
                    this.stars.forEach(star => {
                        star.y += star.speed * this.speedMultiplier;
                        if (star.y > canvas.height) {
                            star.y = 0;
                            star.x = Math.random() * canvas.width;
                        }
                    });
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª—å
                    this.bullets.forEach((bullet, index) => {
                        bullet.y += bullet.vy * this.speedMultiplier;
                        if (bullet.y < 0) {
                            this.bullets.splice(index, 1);
                        }
                    });
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    if (Math.random() < 0.02 && this.enemies.length < 10) {
                        this.enemies.push({
                            x: Math.random() * (canvas.width - 15),
                            y: -15,
                            width: 15,
                            height: 15,
                            vy: Math.random() * 2 + 1,
                            health: 1
                        });
                    }
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Å—Å–∞
                    if (this.score > 1000 && !this.boss && this.enemies.length === 0) {
                        this.boss = {
                            x: canvas.width / 2 - 25,
                            y: 50,
                            width: 50,
                            height: 40,
                            health: 20,
                            lastShot: 0
                        };
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
                    this.enemies.forEach((enemy, index) => {
                        enemy.y += enemy.vy * this.speedMultiplier;
                        if (enemy.y > canvas.height) {
                            this.enemies.splice(index, 1);
                        }
                    });
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –±–æ—Å—Å–∞
                    if (this.boss) {
                        this.boss.lastShot++;
                        this.boss.x += Math.sin(Date.now() * 0.01) * 2;
                        
                        if (this.boss.lastShot > 30) {
                            this.bullets.push({
                                x: this.boss.x + this.boss.width / 2,
                                y: this.boss.y + this.boss.height,
                                width: 3,
                                height: 6,
                                vy: 4
                            });
                            this.boss.lastShot = 0;
                        }
                    }
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                    this.bullets.forEach((bullet, bIndex) => {
                        // –° –≤—Ä–∞–≥–∞–º–∏
                        this.enemies.forEach((enemy, eIndex) => {
                            if (bullet.vy < 0 && bullet.x < enemy.x + enemy.width &&
                                bullet.x + bullet.width > enemy.x &&
                                bullet.y < enemy.y + enemy.height &&
                                bullet.y + bullet.height > enemy.y) {
                                
                                this.bullets.splice(bIndex, 1);
                                this.enemies.splice(eIndex, 1);
                                this.score += 50;
                                soundSystem.playExplosion();
                            }
                        });
                        
                        // –° –±–æ—Å—Å–æ–º
                        if (this.boss && bullet.vy < 0 &&
                            bullet.x < this.boss.x + this.boss.width &&
                            bullet.x + bullet.width > this.boss.x &&
                            bullet.y < this.boss.y + this.boss.height &&
                            bullet.y + bullet.height > this.boss.y) {
                            
                            this.bullets.splice(bIndex, 1);
                            this.boss.health--;
                            this.score += 100;
                            
                            if (this.boss.health <= 0) {
                                this.boss = null;
                                this.level++;
                                this.setupGame();
                                soundSystem.playPickup();
                            } else {
                                soundSystem.playExplosion();
                            }
                        }
                        
                        // –° –∏–≥—Ä–æ–∫–æ–º
                        if (bullet.vy > 0 && bullet.x < this.ship.x + this.ship.width &&
                            bullet.x + bullet.width > this.ship.x &&
                            bullet.y < this.ship.y + this.ship.height &&
                            bullet.y + bullet.height > this.ship.y) {
                            
                            this.bullets.splice(bIndex, 1);
                            this.lives--;
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                soundSystem.playExplosion();
                            }
                        }
                    });
                    
                    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –≤—Ä–∞–≥–∞–º–∏
                    this.enemies.forEach(enemy => {
                        if (this.ship.x < enemy.x + enemy.width &&
                            this.ship.x + this.ship.width > enemy.x &&
                            this.ship.y < enemy.y + enemy.height &&
                            this.ship.y + this.ship.height > enemy.y) {
                            
                            this.lives--;
                            if (this.lives <= 0) {
                                this.gameOver();
                            } else {
                                soundSystem.playExplosion();
                            }
                        }
                    });
                    
                    this.updateUI();
                }
                
                draw() {
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –ó–≤–µ–∑–¥—ã
                    ctx.fillStyle = '#FFFFFF';
                    this.stars.forEach(star => {
                        ctx.fillRect(star.x, star.y, 1, 1);
                    });
                    
                    // –ö–æ—Ä–∞–±–ª—å
                    ctx.fillStyle = '#00FF00';
                    ctx.fillRect(this.ship.x, this.ship.y, this.ship.width, this.ship.height);
                    
                    // –ü—É–ª–∏
                    ctx.fillStyle = '#FFFF00';
                    this.bullets.forEach(bullet => {
                        ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                    });
                    
                    // –í—Ä–∞–≥–∏
                    ctx.fillStyle = '#FF0000';
                    this.enemies.forEach(enemy => {
                        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    });
                    
                    // –ë–æ—Å—Å
                    if (this.boss) {
                        ctx.fillStyle = '#FF00FF';
                        ctx.fillRect(this.boss.x, this.boss.y, this.boss.width, this.boss.height);
                        
                        // –ü–æ–ª–æ—Å–∞ –∑–¥–æ—Ä–æ–≤—å—è –±–æ—Å—Å–∞
                        ctx.fillStyle = '#FF0000';
                        ctx.fillRect(10, 10, 200, 10);
                        ctx.fillStyle = '#00FF00';
                        ctx.fillRect(10, 10, (this.boss.health / 20) * 200, 10);
                    }
                }
            }()
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∏–≥—Ä—ã –∫–∞–∫ –ø–æ–ª–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
        const additionalGames = [
            'burger', 'digdug', 'popeye', 'loderunner', 'paperboy', 'joust', 'tempest', 'spy', 'miner', 'wizard', 'robot', 'atlantis', 'moonlander', 'knight', 'submarine', 'pinball', 'maze'
        ];
        
        additionalGames.forEach(gameId => {
            gameInstances[gameId] = new class extends BaseGame {
                constructor() {
                    super();
                    this.player = { x: canvas.width / 2, y: canvas.height / 2, width: 20, height: 20 };
                    this.objects = [];
                    this.timer = 0;
                }
                
                setupGame() {
                    this.player.x = canvas.width / 2;
                    this.player.y = canvas.height / 2;
                    this.objects = [];
                    this.timer = 0;
                    
                    // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
                    for (let i = 0; i < 10; i++) {
                        this.objects.push({
                            x: Math.random() * (canvas.width - 20),
                            y: Math.random() * (canvas.height - 20),
                            width: 15,
                            height: 15,
                            vx: (Math.random() - 0.5) * 2,
                            vy: (Math.random() - 0.5) * 2,
                            collected: false
                        });
                    }
                }
                
                update() {
                    this.timer++;
                    
                    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (keys[getKey('ArrowLeft')] && this.player.x > 0) {
                        this.player.x -= 3 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowRight')] && this.player.x < canvas.width - this.player.width) {
                        this.player.x += 3 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowUp')] && this.player.y > 0) {
                        this.player.y -= 3 * this.speedMultiplier;
                    }
                    if (keys[getKey('ArrowDown')] && this.player.y < canvas.height - this.player.height) {
                        this.player.y += 3 * this.speedMultiplier;
                    }
                    
                    // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
                    if (keys[getKey('Space')]) {
                        this.score += 5;
                        soundSystem.playPickup();
                        keys[getKey('Space')] = false;
                    }
                    
                    // –î–≤–∏–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
                    this.objects.forEach(obj => {
                        if (!obj.collected) {
                            obj.x += obj.vx * this.speedMultiplier;
                            obj.y += obj.vy * this.speedMultiplier;
                            
                            // –û—Ç—Å–∫–æ–∫ –æ—Ç –≥—Ä–∞–Ω–∏—Ü
                            if (obj.x < 0 || obj.x > canvas.width - obj.width) {
                                obj.vx = -obj.vx;
                            }
                            if (obj.y < 0 || obj.y > canvas.height - obj.height) {
                                obj.vy = -obj.vy;
                            }
                            
                            // –°–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤
                            if (this.player.x < obj.x + obj.width &&
                                this.player.x + this.player.width > obj.x &&
                                this.player.y < obj.y + obj.height &&
                                this.player.y + this.player.height > obj.y) {
                                
                                obj.collected = true;
                                this.score += 25;
                                soundSystem.playPickup();
                            }
                        }
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                    if (this.objects.every(obj => obj.collected)) {
                        this.level++;
                        this.setupGame();
                    }
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤
                    if (this.timer % 60 === 0) {
                        this.score += 1;
                    }
                    
                    this.updateUI();
                }
                
                draw() {
                    // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –∫–∞–∂–¥–æ–π –∏–≥—Ä—ã
                    const colors = {
                        burger: '#FF6B35',
                        digdug: '#4ECDC4',
                        popeye: '#45B7D1',
                        loderunner: '#8E6A2D',
                        paperboy: '#A0E7E5',
                        joust: '#FFA07A',
                        tempest: '#9B59B6',
                        spy: '#2C3E50',
                        miner: '#6B4423',
                        wizard: '#6A0572',
                        robot: '#3498DB',
                        atlantis: '#1ABC9C',
                        moonlander: '#2C3E50',
                        knight: '#E74C3C',
                        submarine: '#2980B9',
                        pinball: '#E67E22',
                        maze: '#27AE60'
                    };
                    
                    ctx.fillStyle = colors[gameId] || '#000000';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –ò–≥—Ä–æ–∫
                    ctx.fillStyle = '#FFFFFF';
                    ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                    
                    // –û–±—ä–µ–∫—Ç—ã
                    ctx.fillStyle = '#FFD700';
                    this.objects.forEach(obj => {
                        if (!obj.collected) {
                            ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                        }
                    });
                    
                    // –ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = '16px Press Start 2P';
                    ctx.textAlign = 'center';
                    ctx.fillText(gameId.toUpperCase(), canvas.width / 2, 30);
                }
            }();
        });
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentGame = null;
        let activeGameInstance = null;
        let gameRunning = false;
        let keys = {};
        
        // –§—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function populateGameList() {
            const gameList = document.getElementById('gameList');
            gameList.innerHTML = '';
            
            games.forEach(game => {
                const gameItem = document.createElement('div');
                gameItem.className = 'game-item';
                gameItem.innerHTML = `
                    <div class="game-icon">${game.icon}</div>
                    <div class="game-title">${game.title}</div>
                    <div class="game-genre">${game.genre}</div>
                `;
                
                gameItem.addEventListener('click', () => {
                    selectGame(game.id);
                });
                
                gameList.appendChild(gameItem);
            });
        }
        
        function selectGame(gameId) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.game-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // –ù–∞—Ö–æ–¥–∏–º –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∏–≥—Ä—É
            const selectedGame = games.find(g => g.id === gameId);
            if (selectedGame) {
                currentGame = gameId;
                activeGameInstance = gameInstances[gameId];
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ
                const gameItems = document.querySelectorAll('.game-item');
                const gameIndex = games.findIndex(g => g.id === gameId);
                if (gameItems[gameIndex]) {
                    gameItems[gameIndex].classList.add('active');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–≥—Ä–µ
                updateGameInfo(selectedGame);
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∏–≥—Ä—É
                if (gameRunning) {
                    stopGame();
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É
                activeGameInstance.init();
                hideOverlay();
            }
        }
        
        function updateGameInfo(game) {
            const gameDescription = document.getElementById('gameDescription');
            gameDescription.textContent = game.description;
        }
        
        function startGame() {
            if (!activeGameInstance) return;
            
            loadGame();
        }
        
        function loadGame() {
            if (!currentGame) return;
            
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingFill = document.getElementById('loadingFill');
            
            loadingScreen.style.display = 'flex';
            
            let progress = 0;
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(loadingInterval);
                    
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        actualStartGame();
                    }, 500);
                }
                
                loadingFill.style.width = progress + '%';
            }, 80);
        }
        
        function actualStartGame() {
            if (!activeGameInstance) return;
            
            gameRunning = true;
            hideOverlay();
            activeGameInstance.start();
        }
        
        function pauseGame() {
            if (activeGameInstance && gameRunning) {
                activeGameInstance.pause();
                
                if (activeGameInstance.paused) {
                    showOverlay('–ü–ê–£–ó–ê', '–ù–∞–∂–º–∏—Ç–µ –ü–ê–£–ó–ê –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è');
                } else {
                    hideOverlay();
                }
            }
        }
        
        function stopGame() {
            if (activeGameInstance) {
                activeGameInstance.stop();
                gameRunning = false;
                hideOverlay();
            }
        }
        
        function resetGame() {
            if (activeGameInstance) {
                stopGame();
                activeGameInstance.init();
                hideOverlay();
            }
        }
        
        function showOverlay(title, text) {
            const overlay = document.getElementById('gameOverlay');
            const overlayTitle = document.getElementById('overlayTitle');
            const overlayText = document.getElementById('overlayText');
            
            overlayTitle.textContent = title;
            overlayText.textContent = text;
            overlay.style.display = 'flex';
        }
        
        function hideOverlay() {
            const overlay = document.getElementById('gameOverlay');
            overlay.style.display = 'none';
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            e.preventDefault();
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.code] = false;
            e.preventDefault();
        });
        
        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('pauseBtn').addEventListener('click', pauseGame);
        document.getElementById('resetBtn').addEventListener('click', resetGame);
        
        // –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('.control-btn').forEach(btn => {
            btn.addEventListener('mousedown', () => {
                const key = btn.dataset.key;
                keys[getKey(key)] = true;
            });
            
            btn.addEventListener('mouseup', () => {
                const key = btn.dataset.key;
                keys[getKey(key)] = false;
            });
        });
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        document.getElementById('settingsBtn').addEventListener('click', () => {
            const panel = document.getElementById('settingsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        });
        
        document.getElementById('soundSetting').addEventListener('change', (e) => {
            gameSettings.sound = e.target.value === 'on';
        });
        
        document.getElementById('controlSetting').addEventListener('change', (e) => {
            gameSettings.controls = e.target.value;
        });
        
        document.getElementById('speedSetting').addEventListener('change', (e) => {
            gameSettings.speed = e.target.value;
            if (activeGameInstance) {
                activeGameInstance.speedMultiplier = gameSettings.speed === 'fast' ? 1.5 : gameSettings.speed === 'slow' ? 0.7 : 1;
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        populateGameList();
        selectGame('tetris'); // –í—ã–±–∏—Ä–∞–µ–º –¢–µ—Ç—Ä–∏—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        document.addEventListener('click', () => {
            if (soundSystem.audioContext && soundSystem.audioContext.state === 'suspended') {
                soundSystem.audioContext.resume();
            }
        }, { once: true });
        
    </script>
</body>
</html>
